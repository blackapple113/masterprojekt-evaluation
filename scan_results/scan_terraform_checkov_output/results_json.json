[{"check_type": "terraform", "results": {"passed_checks": [{"check_id": "CKV_ALI_22", "bc_check_id": "BC_ALI_LOGGING_1", "check_name": "Ensure Transparent Data Encryption is Enabled on instance", "check_result": {"result": "PASSED", "evaluated_keys": ["tde_status"]}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSTransparentDataEncryptionEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-logging-policies/ensure-alibaba-cloud-transparent-data-encryption-is-enabled-on-instance.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_1", "bc_check_id": "BC_ALI_GENERAL_5", "check_name": "Alibaba Cloud OSS bucket accessible to public", "check_result": {"result": "PASSED", "evaluated_keys": ["acl"]}, "code_block": [[11, "resource \"alicloud_oss_bucket\" \"trail\" {\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [15, "    git_file             = \"terraform/alicloud/trail.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"9ce7077b-8195-4e71-aec6-ed1f769555dc\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/alicloud/trail.tf", "file_abs_path": "/terraform/terraform/alicloud/trail.tf", "repo_file_path": "/terraform/alicloud/trail.tf", "file_line_range": [11, 23], "resource": "alicloud_oss_bucket.trail", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketPublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-is-not-accessible-to-public.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/trail.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_211", "bc_check_id": "BC_AWS_GENERAL_118", "check_name": "Ensure RDS uses a modern CaCert", "check_result": {"result": "PASSED", "evaluated_keys": ["ca_cert_identifier"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSCACertIsRecent", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-aws-rds-uses-a-modern-cacert.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_ipv4", "cidr_ipv6"]}, "code_block": [[117, "resource \"aws_security_group\" \"default\" {\n"], [118, "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"], [119, "  vpc_id = aws_vpc.web_vpc.id\n"], [120, "\n"], [121, "  tags = merge({\n"], [122, "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"], [123, "    Environment = local.resource_prefix.value\n"], [124, "    }, {\n"], [125, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [126, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [127, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [128, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [129, "    git_modifiers        = \"nimrodkor\"\n"], [130, "    git_org              = \"bridgecrewio\"\n"], [131, "    git_repo             = \"terragoat\"\n"], [132, "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"], [133, "  })\n"], [134, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [117, 134], "resource": "aws_security_group.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_ipv4", "cidr_ipv6"]}, "code_block": [[117, "resource \"aws_security_group\" \"default\" {\n"], [118, "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"], [119, "  vpc_id = aws_vpc.web_vpc.id\n"], [120, "\n"], [121, "  tags = merge({\n"], [122, "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"], [123, "    Environment = local.resource_prefix.value\n"], [124, "    }, {\n"], [125, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [126, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [127, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [128, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [129, "    git_modifiers        = \"nimrodkor\"\n"], [130, "    git_org              = \"bridgecrewio\"\n"], [131, "    git_repo             = \"terragoat\"\n"], [132, "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"], [133, "  })\n"], [134, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [117, 134], "resource": "aws_security_group.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_ipv4", "cidr_ipv6"]}, "code_block": [[117, "resource \"aws_security_group\" \"default\" {\n"], [118, "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"], [119, "  vpc_id = aws_vpc.web_vpc.id\n"], [120, "\n"], [121, "  tags = merge({\n"], [122, "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"], [123, "    Environment = local.resource_prefix.value\n"], [124, "    }, {\n"], [125, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [126, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [127, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [128, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [129, "    git_modifiers        = \"nimrodkor\"\n"], [130, "    git_org              = \"bridgecrewio\"\n"], [131, "    git_repo             = \"terragoat\"\n"], [132, "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"], [133, "  })\n"], [134, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [117, 134], "resource": "aws_security_group.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_ipv4", "cidr_ipv6"]}, "code_block": [[117, "resource \"aws_security_group\" \"default\" {\n"], [118, "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"], [119, "  vpc_id = aws_vpc.web_vpc.id\n"], [120, "\n"], [121, "  tags = merge({\n"], [122, "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"], [123, "    Environment = local.resource_prefix.value\n"], [124, "    }, {\n"], [125, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [126, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [127, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [128, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [129, "    git_modifiers        = \"nimrodkor\"\n"], [130, "    git_org              = \"bridgecrewio\"\n"], [131, "    git_repo             = \"terragoat\"\n"], [132, "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"], [133, "  })\n"], [134, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [117, 134], "resource": "aws_security_group.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-1-port-security.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_blocks", "ipv6_cidr_blocks"]}, "code_block": [[136, "resource \"aws_security_group_rule\" \"ingress\" {\n"], [137, "  type              = \"ingress\"\n"], [138, "  from_port         = \"3306\"\n"], [139, "  to_port           = \"3306\"\n"], [140, "  protocol          = \"tcp\"\n"], [141, "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"], [142, "  security_group_id = aws_security_group.default.id\n"], [143, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [136, 143], "resource": "aws_security_group_rule.ingress", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cidr_blocks": [{"type": "resource", "name": "aws_vpc.web_vpc", "path": "/terraform/terraform/aws/ec2.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_blocks", "ipv6_cidr_blocks"]}, "code_block": [[136, "resource \"aws_security_group_rule\" \"ingress\" {\n"], [137, "  type              = \"ingress\"\n"], [138, "  from_port         = \"3306\"\n"], [139, "  to_port           = \"3306\"\n"], [140, "  protocol          = \"tcp\"\n"], [141, "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"], [142, "  security_group_id = aws_security_group.default.id\n"], [143, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [136, 143], "resource": "aws_security_group_rule.ingress", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cidr_blocks": [{"type": "resource", "name": "aws_vpc.web_vpc", "path": "/terraform/terraform/aws/ec2.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_blocks", "ipv6_cidr_blocks"]}, "code_block": [[136, "resource \"aws_security_group_rule\" \"ingress\" {\n"], [137, "  type              = \"ingress\"\n"], [138, "  from_port         = \"3306\"\n"], [139, "  to_port           = \"3306\"\n"], [140, "  protocol          = \"tcp\"\n"], [141, "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"], [142, "  security_group_id = aws_security_group.default.id\n"], [143, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [136, 143], "resource": "aws_security_group_rule.ingress", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cidr_blocks": [{"type": "resource", "name": "aws_vpc.web_vpc", "path": "/terraform/terraform/aws/ec2.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "PASSED", "evaluated_keys": ["from_port", "to_port", "cidr_blocks", "ipv6_cidr_blocks"]}, "code_block": [[136, "resource \"aws_security_group_rule\" \"ingress\" {\n"], [137, "  type              = \"ingress\"\n"], [138, "  from_port         = \"3306\"\n"], [139, "  to_port           = \"3306\"\n"], [140, "  protocol          = \"tcp\"\n"], [141, "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"], [142, "  security_group_id = aws_security_group.default.id\n"], [143, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [136, 143], "resource": "aws_security_group_rule.ingress", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-1-port-security.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cidr_blocks": [{"type": "resource", "name": "aws_vpc.web_vpc", "path": "/terraform/terraform/aws/ec2.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[171, "resource \"aws_iam_role\" \"ec2role\" {\n"], [172, "  name = \"${local.resource_prefix.value}-role\"\n"], [173, "  path = \"/\"\n"], [174, "\n"], [175, "  assume_role_policy = <<EOF\n"], [176, "{\n"], [177, "    \"Version\": \"2012-10-17\",\n"], [178, "    \"Statement\": [\n"], [179, "        {\n"], [180, "            \"Action\": \"sts:AssumeRole\",\n"], [181, "            \"Principal\": {\n"], [182, "               \"Service\": \"ec2.amazonaws.com\"\n"], [183, "            },\n"], [184, "            \"Effect\": \"Allow\",\n"], [185, "            \"Sid\": \"\"\n"], [186, "        }\n"], [187, "    ]\n"], [188, "}\n"], [189, "EOF\n"], [190, "\n"], [191, "  tags = merge({\n"], [192, "    Name        = \"${local.resource_prefix.value}-role\"\n"], [193, "    Environment = local.resource_prefix.value\n"], [194, "    }, {\n"], [195, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [196, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [197, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [198, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [199, "    git_modifiers        = \"nimrodkor\"\n"], [200, "    git_org              = \"bridgecrewio\"\n"], [201, "    git_repo             = \"terragoat\"\n"], [202, "    yor_trace            = \"d4b631c1-c1d0-4986-affb-fb8b94a6a7a5\"\n"], [203, "  })\n"], [204, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [171, 204], "resource": "aws_iam_role.ec2role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-role", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "d4b631c1-c1d0-4986-affb-fb8b94a6a7a5"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ec2role", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[171, "resource \"aws_iam_role\" \"ec2role\" {\n"], [172, "  name = \"${local.resource_prefix.value}-role\"\n"], [173, "  path = \"/\"\n"], [174, "\n"], [175, "  assume_role_policy = <<EOF\n"], [176, "{\n"], [177, "    \"Version\": \"2012-10-17\",\n"], [178, "    \"Statement\": [\n"], [179, "        {\n"], [180, "            \"Action\": \"sts:AssumeRole\",\n"], [181, "            \"Principal\": {\n"], [182, "               \"Service\": \"ec2.amazonaws.com\"\n"], [183, "            },\n"], [184, "            \"Effect\": \"Allow\",\n"], [185, "            \"Sid\": \"\"\n"], [186, "        }\n"], [187, "    ]\n"], [188, "}\n"], [189, "EOF\n"], [190, "\n"], [191, "  tags = merge({\n"], [192, "    Name        = \"${local.resource_prefix.value}-role\"\n"], [193, "    Environment = local.resource_prefix.value\n"], [194, "    }, {\n"], [195, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [196, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [197, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [198, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [199, "    git_modifiers        = \"nimrodkor\"\n"], [200, "    git_org              = \"bridgecrewio\"\n"], [201, "    git_repo             = \"terragoat\"\n"], [202, "    yor_trace            = \"d4b631c1-c1d0-4986-affb-fb8b94a6a7a5\"\n"], [203, "  })\n"], [204, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [171, 204], "resource": "aws_iam_role.ec2role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-role", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "d4b631c1-c1d0-4986-affb-fb8b94a6a7a5"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ec2role", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": null, "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[171, "resource \"aws_iam_role\" \"ec2role\" {\n"], [172, "  name = \"${local.resource_prefix.value}-role\"\n"], [173, "  path = \"/\"\n"], [174, "\n"], [175, "  assume_role_policy = <<EOF\n"], [176, "{\n"], [177, "    \"Version\": \"2012-10-17\",\n"], [178, "    \"Statement\": [\n"], [179, "        {\n"], [180, "            \"Action\": \"sts:AssumeRole\",\n"], [181, "            \"Principal\": {\n"], [182, "               \"Service\": \"ec2.amazonaws.com\"\n"], [183, "            },\n"], [184, "            \"Effect\": \"Allow\",\n"], [185, "            \"Sid\": \"\"\n"], [186, "        }\n"], [187, "    ]\n"], [188, "}\n"], [189, "EOF\n"], [190, "\n"], [191, "  tags = merge({\n"], [192, "    Name        = \"${local.resource_prefix.value}-role\"\n"], [193, "    Environment = local.resource_prefix.value\n"], [194, "    }, {\n"], [195, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [196, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [197, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [198, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [199, "    git_modifiers        = \"nimrodkor\"\n"], [200, "    git_org              = \"bridgecrewio\"\n"], [201, "    git_repo             = \"terragoat\"\n"], [202, "    yor_trace            = \"d4b631c1-c1d0-4986-affb-fb8b94a6a7a5\"\n"], [203, "  })\n"], [204, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [171, 204], "resource": "aws_iam_role.ec2role", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-role", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "d4b631c1-c1d0-4986-affb-fb8b94a6a7a5"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.ec2role", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/iam-48.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_286", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["associate_public_ip_address"]}, "code_block": [[243, "resource \"aws_instance\" \"db_app\" {\n"], [244, "  # ec2 have plain text secrets in user data\n"], [245, "  ami                  = data.aws_ami.amazon-linux-2.id\n"], [246, "  instance_type        = \"t2.nano\"\n"], [247, "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"], [248, "\n"], [249, "  vpc_security_group_ids = [\n"], [250, "  \"${aws_security_group.web-node.id}\"]\n"], [251, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [252, "  user_data = <<EOF\n"], [253, "#! /bin/bash\n"], [254, "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"], [255, "sudo yum -y update\n"], [256, "sudo yum -y install httpd php php-mysqlnd\n"], [257, "sudo systemctl enable httpd \n"], [258, "sudo systemctl start httpd\n"], [259, "\n"], [260, "sudo mkdir /var/www/inc\n"], [261, "cat << EnD > /tmp/dbinfo.inc\n"], [262, "<?php\n"], [263, "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"], [264, "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"], [265, "define('DB_PASSWORD', '${var.password}');\n"], [266, "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"], [267, "?>\n"], [268, "EnD\n"], [269, "sudo mv /tmp/dbinfo.inc /var/www/inc \n"], [270, "sudo chown root:root /var/www/inc/dbinfo.inc\n"], [271, "\n"], [272, "cat << EnD > /tmp/index.php\n"], [273, "<?php include \"../inc/dbinfo.inc\"; ?>\n"], [274, "<html>\n"], [275, "<body>\n"], [276, "<h1>Sample page</h1>\n"], [277, "<?php\n"], [278, "\n"], [279, "  /* Connect to MySQL and select the database. */\n"], [280, "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"], [281, "\n"], [282, "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"], [283, "\n"], [284, "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"], [285, "\n"], [286, "  /* Ensure that the EMPLOYEES table exists. */\n"], [287, "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"], [288, "\n"], [289, "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"], [290, "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"], [291, "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"], [292, "\n"], [293, "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"], [294, "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"], [295, "  }\n"], [296, "?>\n"], [297, "\n"], [298, "<!-- Input form -->\n"], [299, "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"], [300, "  <table border=\"0\">\n"], [301, "    <tr>\n"], [302, "      <td>NAME</td>\n"], [303, "      <td>ADDRESS</td>\n"], [304, "    </tr>\n"], [305, "    <tr>\n"], [306, "      <td>\n"], [307, "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"], [308, "      </td>\n"], [309, "      <td>\n"], [310, "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"], [311, "      </td>\n"], [312, "      <td>\n"], [313, "        <input type=\"submit\" value=\"Add Data\" />\n"], [314, "      </td>\n"], [315, "    </tr>\n"], [316, "  </table>\n"], [317, "</form>\n"], [318, "\n"], [319, "<!-- Display table data. -->\n"], [320, "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"], [321, "  <tr>\n"], [322, "    <td>ID</td>\n"], [323, "    <td>NAME</td>\n"], [324, "    <td>ADDRESS</td>\n"], [325, "  </tr>\n"], [326, "\n"], [327, "<?php\n"], [328, "\n"], [329, "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"], [330, "\n"], [331, "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"], [332, "  echo \"<tr>\";\n"], [333, "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"], [334, "       \"<td>\",\\$query_data[1], \"</td>\",\n"], [335, "       \"<td>\",\\$query_data[2], \"</td>\";\n"], [336, "  echo \"</tr>\";\n"], [337, "}\n"], [338, "?>\n"], [339, "\n"], [340, "</table>\n"], [341, "\n"], [342, "<!-- Clean up. -->\n"], [343, "<?php\n"], [344, "\n"], [345, "  mysqli_free_result(\\$result);\n"], [346, "  mysqli_close(\\$connection);\n"], [347, "\n"], [348, "?>\n"], [349, "\n"], [350, "</body>\n"], [351, "</html>\n"], [352, "\n"], [353, "\n"], [354, "<?php\n"], [355, "\n"], [356, "/* Add an employee to the table. */\n"], [357, "function AddEmployee(\\$connection, \\$name, \\$address) {\n"], [358, "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"], [359, "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"], [360, "\n"], [361, "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"], [362, "\n"], [363, "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"], [364, "}\n"], [365, "\n"], [366, "/* Check whether the table exists and, if not, create it. */\n"], [367, "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"], [368, "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"], [369, "  {\n"], [370, "     \\$query = \"CREATE TABLE EMPLOYEES (\n"], [371, "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"], [372, "         NAME VARCHAR(45),\n"], [373, "         ADDRESS VARCHAR(90)\n"], [374, "       )\";\n"], [375, "\n"], [376, "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"], [377, "  }\n"], [378, "}\n"], [379, "\n"], [380, "/* Check for the existence of a table. */\n"], [381, "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"], [382, "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"], [383, "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"], [384, "\n"], [385, "  \\$checktable = mysqli_query(\\$connection,\n"], [386, "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"], [387, "\n"], [388, "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"], [389, "\n"], [390, "  return false;\n"], [391, "}\n"], [392, "?>               \n"], [393, "EnD\n"], [394, "\n"], [395, "sudo mv /tmp/index.php /var/www/html\n"], [396, "sudo chown root:root /var/www/html/index.php\n"], [397, "\n"], [398, "\n"], [399, "\n"], [400, "EOF\n"], [401, "  tags = merge({\n"], [402, "    Name = \"${local.resource_prefix.value}-dbapp\"\n"], [403, "    }, {\n"], [404, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [405, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [406, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [407, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [408, "    git_modifiers        = \"nimrodkor\"\n"], [409, "    git_org              = \"bridgecrewio\"\n"], [410, "    git_repo             = \"terragoat\"\n"], [411, "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"], [412, "  })\n"], [413, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [243, 413], "resource": "aws_instance.db_app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/public-policies/public-12.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user_data": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "iam_instance_profile": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ec2profile", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "PASSED", "evaluated_keys": ["user_data"]}, "code_block": [[243, "resource \"aws_instance\" \"db_app\" {\n"], [244, "  # ec2 have plain text secrets in user data\n"], [245, "  ami                  = data.aws_ami.amazon-linux-2.id\n"], [246, "  instance_type        = \"t2.nano\"\n"], [247, "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"], [248, "\n"], [249, "  vpc_security_group_ids = [\n"], [250, "  \"${aws_security_group.web-node.id}\"]\n"], [251, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [252, "  user_data = <<EOF\n"], [253, "#! /bin/bash\n"], [254, "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"], [255, "sudo yum -y update\n"], [256, "sudo yum -y install httpd php php-mysqlnd\n"], [257, "sudo systemctl enable httpd \n"], [258, "sudo systemctl start httpd\n"], [259, "\n"], [260, "sudo mkdir /var/www/inc\n"], [261, "cat << EnD > /tmp/dbinfo.inc\n"], [262, "<?php\n"], [263, "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"], [264, "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"], [265, "define('DB_PASSWORD', '${var.password}');\n"], [266, "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"], [267, "?>\n"], [268, "EnD\n"], [269, "sudo mv /tmp/dbinfo.inc /var/www/inc \n"], [270, "sudo chown root:root /var/www/inc/dbinfo.inc\n"], [271, "\n"], [272, "cat << EnD > /tmp/index.php\n"], [273, "<?php include \"../inc/dbinfo.inc\"; ?>\n"], [274, "<html>\n"], [275, "<body>\n"], [276, "<h1>Sample page</h1>\n"], [277, "<?php\n"], [278, "\n"], [279, "  /* Connect to MySQL and select the database. */\n"], [280, "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"], [281, "\n"], [282, "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"], [283, "\n"], [284, "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"], [285, "\n"], [286, "  /* Ensure that the EMPLOYEES table exists. */\n"], [287, "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"], [288, "\n"], [289, "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"], [290, "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"], [291, "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"], [292, "\n"], [293, "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"], [294, "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"], [295, "  }\n"], [296, "?>\n"], [297, "\n"], [298, "<!-- Input form -->\n"], [299, "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"], [300, "  <table border=\"0\">\n"], [301, "    <tr>\n"], [302, "      <td>NAME</td>\n"], [303, "      <td>ADDRESS</td>\n"], [304, "    </tr>\n"], [305, "    <tr>\n"], [306, "      <td>\n"], [307, "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"], [308, "      </td>\n"], [309, "      <td>\n"], [310, "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"], [311, "      </td>\n"], [312, "      <td>\n"], [313, "        <input type=\"submit\" value=\"Add Data\" />\n"], [314, "      </td>\n"], [315, "    </tr>\n"], [316, "  </table>\n"], [317, "</form>\n"], [318, "\n"], [319, "<!-- Display table data. -->\n"], [320, "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"], [321, "  <tr>\n"], [322, "    <td>ID</td>\n"], [323, "    <td>NAME</td>\n"], [324, "    <td>ADDRESS</td>\n"], [325, "  </tr>\n"], [326, "\n"], [327, "<?php\n"], [328, "\n"], [329, "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"], [330, "\n"], [331, "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"], [332, "  echo \"<tr>\";\n"], [333, "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"], [334, "       \"<td>\",\\$query_data[1], \"</td>\",\n"], [335, "       \"<td>\",\\$query_data[2], \"</td>\";\n"], [336, "  echo \"</tr>\";\n"], [337, "}\n"], [338, "?>\n"], [339, "\n"], [340, "</table>\n"], [341, "\n"], [342, "<!-- Clean up. -->\n"], [343, "<?php\n"], [344, "\n"], [345, "  mysqli_free_result(\\$result);\n"], [346, "  mysqli_close(\\$connection);\n"], [347, "\n"], [348, "?>\n"], [349, "\n"], [350, "</body>\n"], [351, "</html>\n"], [352, "\n"], [353, "\n"], [354, "<?php\n"], [355, "\n"], [356, "/* Add an employee to the table. */\n"], [357, "function AddEmployee(\\$connection, \\$name, \\$address) {\n"], [358, "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"], [359, "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"], [360, "\n"], [361, "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"], [362, "\n"], [363, "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"], [364, "}\n"], [365, "\n"], [366, "/* Check whether the table exists and, if not, create it. */\n"], [367, "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"], [368, "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"], [369, "  {\n"], [370, "     \\$query = \"CREATE TABLE EMPLOYEES (\n"], [371, "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"], [372, "         NAME VARCHAR(45),\n"], [373, "         ADDRESS VARCHAR(90)\n"], [374, "       )\";\n"], [375, "\n"], [376, "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"], [377, "  }\n"], [378, "}\n"], [379, "\n"], [380, "/* Check for the existence of a table. */\n"], [381, "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"], [382, "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"], [383, "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"], [384, "\n"], [385, "  \\$checktable = mysqli_query(\\$connection,\n"], [386, "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"], [387, "\n"], [388, "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"], [389, "\n"], [390, "  return false;\n"], [391, "}\n"], [392, "?>               \n"], [393, "EnD\n"], [394, "\n"], [395, "sudo mv /tmp/index.php /var/www/html\n"], [396, "sudo chown root:root /var/www/html/index.php\n"], [397, "\n"], [398, "\n"], [399, "\n"], [400, "EOF\n"], [401, "  tags = merge({\n"], [402, "    Name = \"${local.resource_prefix.value}-dbapp\"\n"], [403, "    }, {\n"], [404, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [405, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [406, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [407, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [408, "    git_modifiers        = \"nimrodkor\"\n"], [409, "    git_org              = \"bridgecrewio\"\n"], [410, "    git_repo             = \"terragoat\"\n"], [411, "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"], [412, "  })\n"], [413, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [243, 413], "resource": "aws_instance.db_app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user_data": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "iam_instance_profile": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ec2profile", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "PASSED", "evaluated_keys": ["associate_public_ip_address"]}, "code_block": [[1, "resource \"aws_instance\" \"web_host\" {\n"], [2, "  # ec2 have plain text secrets in user data\n"], [3, "  ami           = \"${var.ami}\"\n"], [4, "  instance_type = \"t2.nano\"\n"], [5, "\n"], [6, "  vpc_security_group_ids = [\n"], [7, "  \"${aws_security_group.web-node.id}\"]\n"], [8, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [9, "  user_data = <<EOF\n"], [10, "#! /bin/bash\n"], [11, "sudo apt-get update\n"], [12, "sudo apt-get install -y apache2\n"], [13, "sudo systemctl start apache2\n"], [14, "sudo systemctl enable apache2\n"], [15, "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"], [16, "export AWS_SECRET_ACCESS_KEY=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\n"], [17, "export AWS_DEFAULT_REGION=us-west-2\n"], [18, "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"], [19, "EOF\n"], [20, "  tags = merge({\n"], [21, "    Name = \"${local.resource_prefix.value}-ec2\"\n"], [22, "    }, {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"], [31, "  })\n"], [32, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [1, 32], "resource": "aws_instance.web_host", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/public-policies/public-12.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"ami": [{"type": "variable", "name": "ami", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_277", "bc_check_id": "BC_AWS_NETWORKING_78", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port -1", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[77, "resource \"aws_security_group\" \"web-node\" {\n"], [78, "  # security group is open to the world in SSH port\n"], [79, "  name        = \"${local.resource_prefix.value}-sg\"\n"], [80, "  description = \"${local.resource_prefix.value} Security Group\"\n"], [81, "  vpc_id      = aws_vpc.web_vpc.id\n"], [82, "\n"], [83, "  ingress {\n"], [84, "    from_port = 80\n"], [85, "    to_port   = 80\n"], [86, "    protocol  = \"tcp\"\n"], [87, "    cidr_blocks = [\n"], [88, "    \"0.0.0.0/0\"]\n"], [89, "  }\n"], [90, "  ingress {\n"], [91, "    from_port = 22\n"], [92, "    to_port   = 22\n"], [93, "    protocol  = \"tcp\"\n"], [94, "    cidr_blocks = [\n"], [95, "    \"0.0.0.0/0\"]\n"], [96, "  }\n"], [97, "  egress {\n"], [98, "    from_port = 0\n"], [99, "    to_port   = 0\n"], [100, "    protocol  = \"-1\"\n"], [101, "    cidr_blocks = [\n"], [102, "    \"0.0.0.0/0\"]\n"], [103, "  }\n"], [104, "  depends_on = [aws_vpc.web_vpc]\n"], [105, "  tags = {\n"], [106, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [107, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [108, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [109, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [110, "    git_modifiers        = \"nimrodkor\"\n"], [111, "    git_org              = \"bridgecrewio\"\n"], [112, "    git_repo             = \"terragoat\"\n"], [113, "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"], [114, "  }\n"], [115, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [77, 115], "resource": "aws_security_group.web-node", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngressAny", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-group-does-not-allow-all-traffic-on-all-ports.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_25", "bc_check_id": "BC_AWS_NETWORKING_2", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[77, "resource \"aws_security_group\" \"web-node\" {\n"], [78, "  # security group is open to the world in SSH port\n"], [79, "  name        = \"${local.resource_prefix.value}-sg\"\n"], [80, "  description = \"${local.resource_prefix.value} Security Group\"\n"], [81, "  vpc_id      = aws_vpc.web_vpc.id\n"], [82, "\n"], [83, "  ingress {\n"], [84, "    from_port = 80\n"], [85, "    to_port   = 80\n"], [86, "    protocol  = \"tcp\"\n"], [87, "    cidr_blocks = [\n"], [88, "    \"0.0.0.0/0\"]\n"], [89, "  }\n"], [90, "  ingress {\n"], [91, "    from_port = 22\n"], [92, "    to_port   = 22\n"], [93, "    protocol  = \"tcp\"\n"], [94, "    cidr_blocks = [\n"], [95, "    \"0.0.0.0/0\"]\n"], [96, "  }\n"], [97, "  egress {\n"], [98, "    from_port = 0\n"], [99, "    to_port   = 0\n"], [100, "    protocol  = \"-1\"\n"], [101, "    cidr_blocks = [\n"], [102, "    \"0.0.0.0/0\"]\n"], [103, "  }\n"], [104, "  depends_on = [aws_vpc.web_vpc]\n"], [105, "  tags = {\n"], [106, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [107, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [108, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [109, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [110, "    git_modifiers        = \"nimrodkor\"\n"], [111, "    git_org              = \"bridgecrewio\"\n"], [112, "    git_repo             = \"terragoat\"\n"], [113, "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"], [114, "  }\n"], [115, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [77, 115], "resource": "aws_security_group.web-node", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/bc-aws-s3-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[19, "resource aws_iam_role \"iam_for_eks\" {\n"], [20, "  name               = \"${local.resource_prefix.value}-iam-for-eks\"\n"], [21, "  assume_role_policy = data.aws_iam_policy_document.iam_policy_eks.json\n"], [22, "  tags = {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/eks.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"de052596-21a0-43de-8153-469add277b18\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [19, 32], "resource": "aws_iam_role.iam_for_eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "de052596-21a0-43de-8153-469add277b18"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.iam_for_eks", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[19, "resource aws_iam_role \"iam_for_eks\" {\n"], [20, "  name               = \"${local.resource_prefix.value}-iam-for-eks\"\n"], [21, "  assume_role_policy = data.aws_iam_policy_document.iam_policy_eks.json\n"], [22, "  tags = {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/eks.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"de052596-21a0-43de-8153-469add277b18\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [19, 32], "resource": "aws_iam_role.iam_for_eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "de052596-21a0-43de-8153-469add277b18"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.iam_for_eks", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": null, "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[19, "resource aws_iam_role \"iam_for_eks\" {\n"], [20, "  name               = \"${local.resource_prefix.value}-iam-for-eks\"\n"], [21, "  assume_role_policy = data.aws_iam_policy_document.iam_policy_eks.json\n"], [22, "  tags = {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/eks.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"de052596-21a0-43de-8153-469add277b18\"\n"], [31, "  }\n"], [32, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [19, 32], "resource": "aws_iam_role.iam_for_eks", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "de052596-21a0-43de-8153-469add277b18"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.iam_for_eks", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": null, "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[34, "resource aws_iam_role_policy_attachment \"policy_attachment-AmazonEKSClusterPolicy\" {\n"], [35, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n"], [36, "  role       = aws_iam_role.iam_for_eks.name\n"], [37, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [34, 37], "resource": "aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"role": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.iam_for_eks", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": null, "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[39, "resource aws_iam_role_policy_attachment \"policy_attachment-AmazonEKSServicePolicy\" {\n"], [40, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSServicePolicy\"\n"], [41, "  role       = aws_iam_role.iam_for_eks.name\n"], [42, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [39, 42], "resource": "aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"role": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.iam_for_eks", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_339", "bc_check_id": null, "check_name": "Ensure EKS clusters run on a supported Kubernetes version", "check_result": {"result": "PASSED", "evaluated_keys": ["version"]}, "code_block": [[118, "resource aws_eks_cluster \"eks_cluster\" {\n"], [119, "  name     = local.eks_name.value\n"], [120, "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"], [121, "\n"], [122, "  vpc_config {\n"], [123, "    endpoint_private_access = true\n"], [124, "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"], [125, "  }\n"], [126, "\n"], [127, "  depends_on = [\n"], [128, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"], [129, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"], [130, "  ]\n"], [131, "  tags = {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/eks.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"], [140, "  }\n"], [141, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [118, 141], "resource": "aws_eks_cluster.eks_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSPlatformVersion", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "eks_name", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublicActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_49", "bc_check_id": "BC_AWS_IAM_43", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_356", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.ResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_1", "bc_check_id": "BC_AWS_IAM_23", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/iam-23.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_138", "bc_check_id": "BC_AWS_NETWORKING_43", "check_name": "Ensure that ELB is cross-zone-load-balancing enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["cross_zone_load_balancing"]}, "code_block": [[2, "resource \"aws_elb\" \"weblb\" {\n"], [3, "  name = \"weblb-terraform-elb\"\n"], [4, "\n"], [5, "  listener {\n"], [6, "    instance_port     = 8000\n"], [7, "    instance_protocol = \"http\"\n"], [8, "    lb_port           = 80\n"], [9, "    lb_protocol       = \"http\"\n"], [10, "  }\n"], [11, "\n"], [12, "  health_check {\n"], [13, "    healthy_threshold   = 2\n"], [14, "    unhealthy_threshold = 2\n"], [15, "    timeout             = 3\n"], [16, "    target              = \"HTTP:8000/\"\n"], [17, "    interval            = 30\n"], [18, "  }\n"], [19, "\n"], [20, "  subnets                     = [aws_subnet.web_subnet.id]\n"], [21, "  security_groups             = [aws_security_group.web-node.id]\n"], [22, "  instances                   = [aws_instance.web_host.id]\n"], [23, "  cross_zone_load_balancing   = true\n"], [24, "  idle_timeout                = 400\n"], [25, "  connection_draining         = true\n"], [26, "  connection_draining_timeout = 400\n"], [27, "\n"], [28, "  tags = merge({\n"], [29, "    Name = \"foobar-terraform-elb\"\n"], [30, "    }, {\n"], [31, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [32, "    git_file             = \"terraform/aws/elb.tf\"\n"], [33, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [34, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [35, "    git_modifiers        = \"nimrodkor\"\n"], [36, "    git_org              = \"bridgecrewio\"\n"], [37, "    git_repo             = \"terragoat\"\n"], [38, "    yor_trace            = \"b4a83ce9-9a45-43b4-b6d9-1783c282f702\"\n"], [39, "  })\n"], [40, "}"]], "file_path": "/terraform/aws/elb.tf", "file_abs_path": "/terraform/terraform/aws/elb.tf", "repo_file_path": "/terraform/aws/elb.tf", "file_line_range": [2, 40], "resource": "aws_elb.weblb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBCrossZoneEnable", "fixed_definition": null, "entity_tags": {"Name": "foobar-terraform-elb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/elb.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b4a83ce9-9a45-43b4-b6d9-1783c282f702"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-that-elb-is-cross-zone-load-balancing-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/elb.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_328", "bc_check_id": null, "check_name": "Ensure that ALB is configured with defensive or strictest desync mitigation mode", "check_result": {"result": "PASSED", "evaluated_keys": ["desync_mitigation_mode"]}, "code_block": [[2, "resource \"aws_elb\" \"weblb\" {\n"], [3, "  name = \"weblb-terraform-elb\"\n"], [4, "\n"], [5, "  listener {\n"], [6, "    instance_port     = 8000\n"], [7, "    instance_protocol = \"http\"\n"], [8, "    lb_port           = 80\n"], [9, "    lb_protocol       = \"http\"\n"], [10, "  }\n"], [11, "\n"], [12, "  health_check {\n"], [13, "    healthy_threshold   = 2\n"], [14, "    unhealthy_threshold = 2\n"], [15, "    timeout             = 3\n"], [16, "    target              = \"HTTP:8000/\"\n"], [17, "    interval            = 30\n"], [18, "  }\n"], [19, "\n"], [20, "  subnets                     = [aws_subnet.web_subnet.id]\n"], [21, "  security_groups             = [aws_security_group.web-node.id]\n"], [22, "  instances                   = [aws_instance.web_host.id]\n"], [23, "  cross_zone_load_balancing   = true\n"], [24, "  idle_timeout                = 400\n"], [25, "  connection_draining         = true\n"], [26, "  connection_draining_timeout = 400\n"], [27, "\n"], [28, "  tags = merge({\n"], [29, "    Name = \"foobar-terraform-elb\"\n"], [30, "    }, {\n"], [31, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [32, "    git_file             = \"terraform/aws/elb.tf\"\n"], [33, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [34, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [35, "    git_modifiers        = \"nimrodkor\"\n"], [36, "    git_org              = \"bridgecrewio\"\n"], [37, "    git_repo             = \"terragoat\"\n"], [38, "    yor_trace            = \"b4a83ce9-9a45-43b4-b6d9-1783c282f702\"\n"], [39, "  })\n"], [40, "}"]], "file_path": "/terraform/aws/elb.tf", "file_abs_path": "/terraform/terraform/aws/elb.tf", "repo_file_path": "/terraform/aws/elb.tf", "file_line_range": [2, 40], "resource": "aws_elb.weblb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ALBDesyncMode", "fixed_definition": null, "entity_tags": {"Name": "foobar-terraform-elb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/elb.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b4a83ce9-9a45-43b4-b6d9-1783c282f702"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/elb.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_49", "bc_check_id": "BC_AWS_IAM_43", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.StarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-43.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_1", "bc_check_id": "BC_AWS_IAM_23", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.AdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/iam-23.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_6", "bc_check_id": "BC_AWS_ELASTICSEARCH_5", "check_name": "Ensure all Elasticsearch has node-to-node encryption enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["cluster_config/[0]/instance_count"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchNodeToNodeEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/elastisearch-policies/elasticsearch-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_83", "bc_check_id": "BC_AWS_ELASTICSEARCH_6", "check_name": "Ensure Elasticsearch Domain enforces HTTPS", "check_result": {"result": "PASSED", "evaluated_keys": ["domain_endpoint_options/[0]/enforce_https"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchDomainEnforceHTTPS", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/elastisearch-policies/elasticsearch-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": ["policy", "inline_policy"]}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/iam-48.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_227", "bc_check_id": "BC_AWS_GENERAL_122", "check_name": "Ensure KMS key is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["is_enabled"]}, "code_block": [[1, "resource \"aws_kms_key\" \"logs_key\" {\n"], [2, "  # key does not have rotation enabled\n"], [3, "  description = \"${local.resource_prefix.value}-logs bucket key\"\n"], [4, "\n"], [5, "  deletion_window_in_days = 7\n"], [6, "  tags = {\n"], [7, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [8, "    git_file             = \"terraform/aws/kms.tf\"\n"], [9, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [10, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [11, "    git_modifiers        = \"nimrodkor\"\n"], [12, "    git_org              = \"bridgecrewio\"\n"], [13, "    git_repo             = \"terragoat\"\n"], [14, "    yor_trace            = \"cd8fa2a7-4868-4cd1-993d-da4644808ce5\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/kms.tf", "file_abs_path": "/terraform/terraform/aws/kms.tf", "repo_file_path": "/terraform/aws/kms.tf", "file_line_range": [1, 16], "resource": "aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyIsEnabled", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/kms.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "cd8fa2a7-4868-4cd1-993d-da4644808ce5"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-aws-key-management-service-kms-key-is-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/kms.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_kms_key\" \"logs_key\" {\n"], [2, "  # key does not have rotation enabled\n"], [3, "  description = \"${local.resource_prefix.value}-logs bucket key\"\n"], [4, "\n"], [5, "  deletion_window_in_days = 7\n"], [6, "  tags = {\n"], [7, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [8, "    git_file             = \"terraform/aws/kms.tf\"\n"], [9, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [10, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [11, "    git_modifiers        = \"nimrodkor\"\n"], [12, "    git_org              = \"bridgecrewio\"\n"], [13, "    git_repo             = \"terragoat\"\n"], [14, "    yor_trace            = \"cd8fa2a7-4868-4cd1-993d-da4644808ce5\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/kms.tf", "file_abs_path": "/terraform/terraform/aws/kms.tf", "repo_file_path": "/terraform/aws/kms.tf", "file_line_range": [1, 16], "resource": "aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSKeyWildcardPrincipal", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/kms.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "cd8fa2a7-4868-4cd1-993d-da4644808ce5"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/kms.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"iam_for_lambda\" {\n"], [2, "  name = \"${local.resource_prefix.value}-analysis-lambda\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = <<EOF\n"], [6, "{\n"], [7, "  \"Version\": \"2012-10-17\",\n"], [8, "  \"Statement\": [\n"], [9, "    {\n"], [10, "      \"Action\": \"sts:AssumeRole\",\n"], [11, "      \"Principal\": {\n"], [12, "        \"Service\": \"lambda.amazonaws.com\"\n"], [13, "      },\n"], [14, "      \"Effect\": \"Allow\",\n"], [15, "      \"Sid\": \"\"\n"], [16, "    }\n"], [17, "  ]\n"], [18, "}\n"], [19, "EOF\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [22, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [23, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [24, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [25, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"93cfa6f9-a257-40c3-b7dc-3c3686929734\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [1, 30], "resource": "aws_iam_role.iam_for_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "93cfa6f9-a257-40c3-b7dc-3c3686929734"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["assume_role_policy"]}, "code_block": [[1, "resource \"aws_iam_role\" \"iam_for_lambda\" {\n"], [2, "  name = \"${local.resource_prefix.value}-analysis-lambda\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = <<EOF\n"], [6, "{\n"], [7, "  \"Version\": \"2012-10-17\",\n"], [8, "  \"Statement\": [\n"], [9, "    {\n"], [10, "      \"Action\": \"sts:AssumeRole\",\n"], [11, "      \"Principal\": {\n"], [12, "        \"Service\": \"lambda.amazonaws.com\"\n"], [13, "      },\n"], [14, "      \"Effect\": \"Allow\",\n"], [15, "      \"Sid\": \"\"\n"], [16, "    }\n"], [17, "  ]\n"], [18, "}\n"], [19, "EOF\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [22, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [23, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [24, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [25, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"93cfa6f9-a257-40c3-b7dc-3c3686929734\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [1, 30], "resource": "aws_iam_role.iam_for_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "93cfa6f9-a257-40c3-b7dc-3c3686929734"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_274", "bc_check_id": null, "check_name": "Disallow IAM roles, users, and groups from using the AWS AdministratorAccess policy", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_iam_role\" \"iam_for_lambda\" {\n"], [2, "  name = \"${local.resource_prefix.value}-analysis-lambda\"\n"], [3, "\n"], [4, "\n"], [5, "  assume_role_policy = <<EOF\n"], [6, "{\n"], [7, "  \"Version\": \"2012-10-17\",\n"], [8, "  \"Statement\": [\n"], [9, "    {\n"], [10, "      \"Action\": \"sts:AssumeRole\",\n"], [11, "      \"Principal\": {\n"], [12, "        \"Service\": \"lambda.amazonaws.com\"\n"], [13, "      },\n"], [14, "      \"Effect\": \"Allow\",\n"], [15, "      \"Sid\": \"\"\n"], [16, "    }\n"], [17, "  ]\n"], [18, "}\n"], [19, "EOF\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [22, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [23, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [24, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [25, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"93cfa6f9-a257-40c3-b7dc-3c3686929734\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [1, 30], "resource": "aws_iam_role.iam_for_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMManagedAdminPolicy", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "93cfa6f9-a257-40c3-b7dc-3c3686929734"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_102", "bc_check_id": "BC_AWS_GENERAL_42", "check_name": "Ensure Neptune Cluster instance is not publicly available", "check_result": {"result": "PASSED", "evaluated_keys": ["publicly_accessible/[0]"]}, "code_block": [[22, "resource \"aws_neptune_cluster_instance\" \"default\" {\n"], [23, "  count              = 1\n"], [24, "  cluster_identifier = aws_neptune_cluster.default.id\n"], [25, "  engine             = \"neptune\"\n"], [26, "  instance_class     = \"db.t3.medium\" # Smallest instance type listed for neptune https://aws.amazon.com/neptune/pricing/\n"], [27, "  apply_immediately  = true\n"], [28, "  #publicly_accessible                = true # No longer supported, API returns create error. See https://docs.aws.amazon.com/neptune/latest/userguide/api-instances.html#CreateDBInstance\n"], [29, "  tags = {\n"], [30, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [31, "    git_file             = \"terraform/aws/neptune.tf\"\n"], [32, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [33, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [34, "    git_modifiers        = \"matt/nimrodkor\"\n"], [35, "    git_org              = \"bridgecrewio\"\n"], [36, "    git_repo             = \"terragoat\"\n"], [37, "    yor_trace            = \"9b2b45fd-6f9f-44fd-b8bc-868b1db178b3\"\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/neptune.tf", "file_abs_path": "/terraform/terraform/aws/neptune.tf", "repo_file_path": "/terraform/aws/neptune.tf", "file_line_range": [22, 39], "resource": "aws_neptune_cluster_instance.default[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterInstancePublic", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/neptune.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "matt/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9b2b45fd-6f9f-44fd-b8bc-868b1db178b3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-42.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/neptune.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[2, "provider \"aws\" {\n"], [3, "  profile = var.profile\n"], [4, "  region  = var.region\n"], [5, "}\n"]], "file_path": "/terraform/aws/providers.tf", "file_abs_path": "/terraform/terraform/aws/providers.tf", "repo_file_path": "/terraform/aws/providers.tf", "file_line_range": [2, 5], "resource": "aws.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/providers.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"profile": [{"type": "variable", "name": "profile", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "PASSED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/bc-aws-s3-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/s3.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/bc-aws-s3-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/s3.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/bc-aws-s3-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/s3.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/bc-aws-s3-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/s3.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_93", "bc_check_id": "BC_AWS_S3_24", "check_name": "Ensure S3 bucket policy does not lockout all but root user. (Prevent lockouts needing root account fixes)", "check_result": {"result": "PASSED", "evaluated_keys": ["policy"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3ProtectAgainstPolicyLockout", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/bc-aws-s3-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/s3.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_169", "bc_check_id": null, "check_name": "Ensure Azure Kubernetes Cluster (AKS) nodes use scale sets", "check_result": {"result": "PASSED", "evaluated_keys": ["default_node_pool/[0]/type"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSPoolTypeIsScaleSet", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_143", "bc_check_id": "BC_AZR_NETWORKING_60", "check_name": "Ensure AKS cluster nodes do not have public IP addresses", "check_result": {"result": "PASSED", "evaluated_keys": ["default_node_pool/[0]/enable_node_public_ip"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSNodePublicIpDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/ensure-azure-aks-cluster-nodes-do-not-have-public-ip-addresses", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_72", "bc_check_id": "BC_AZR_GENERAL_55", "check_name": "Ensure that remote debugging is not enabled for app services", "check_result": {"result": "PASSED", "evaluated_keys": ["site_config/[0]/remote_debugging_enabled"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceRemoteDebuggingNotEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-remote-debugging-is-not-enabled-for-app-services.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_57", "bc_check_id": "BC_AZR_GENERAL_48", "check_name": "Ensure that CORS disallows every resource to access app services", "check_result": {"result": "PASSED", "evaluated_keys": ["site_config/[0]/cors/[0]/allowed_origins"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceDisallowCORS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-cors-disallows-every-resource-to-access-app-services.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_72", "bc_check_id": "BC_AZR_GENERAL_55", "check_name": "Ensure that remote debugging is not enabled for app services", "check_result": {"result": "PASSED", "evaluated_keys": ["site_config/[0]/remote_debugging_enabled"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceRemoteDebuggingNotEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-remote-debugging-is-not-enabled-for-app-services.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_57", "bc_check_id": "BC_AZR_GENERAL_48", "check_name": "Ensure that CORS disallows every resource to access app services", "check_result": {"result": "PASSED", "evaluated_keys": ["site_config/[0]/cors/[0]/allowed_origins"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceDisallowCORS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-cors-disallows-every-resource-to-access-app-services.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_14", "bc_check_id": "BC_AZR_NETWORKING_5", "check_name": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service", "check_result": {"result": "PASSED", "evaluated_keys": ["https_only/[0]"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceHTTPSOnly", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_15", "bc_check_id": "BC_AZR_NETWORKING_6", "check_name": "Ensure web app is using the latest version of TLS encryption", "check_result": {"result": "PASSED", "evaluated_keys": ["site_config/[0]/min_tls_version/[0]"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_179", "bc_check_id": null, "check_name": "Ensure VM agent is installed", "check_result": {"result": "PASSED", "evaluated_keys": ["provision_vm_agent"]}, "code_block": [[9, "resource azurerm_linux_virtual_machine \"linux_machine\" {\n"], [10, "  admin_username                  = \"terragoat-linux\"\n"], [11, "  admin_password                  = random_string.password.result\n"], [12, "  location                        = var.location\n"], [13, "  name                            = \"terragoat-linux\"\n"], [14, "  network_interface_ids           = [azurerm_network_interface.ni_linux.id]\n"], [15, "  resource_group_name             = azurerm_resource_group.example.name\n"], [16, "  size                            = \"Standard_F2\"\n"], [17, "  disable_password_authentication = false\n"], [18, "  source_image_reference {\n"], [19, "    publisher = \"Canonical\"\n"], [20, "    offer     = \"UbuntuServer\"\n"], [21, "    sku       = \"16.04-LTS\"\n"], [22, "    version   = \"latest\"\n"], [23, "  }\n"], [24, "  os_disk {\n"], [25, "    caching              = \"ReadWrite\"\n"], [26, "    storage_account_type = \"Standard_LRS\"\n"], [27, "  }\n"], [28, "\n"], [29, "  tags = merge({\n"], [30, "    terragoat   = true\n"], [31, "    environment = var.environment\n"], [32, "    }, {\n"], [33, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [34, "    git_file             = \"terraform/azure/instance.tf\"\n"], [35, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [36, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [37, "    git_modifiers        = \"nimrodkor\"\n"], [38, "    git_org              = \"bridgecrewio\"\n"], [39, "    git_repo             = \"terragoat\"\n"], [40, "    yor_trace            = \"736ef713-51b8-4178-ad69-406be81f6ef2\"\n"], [41, "  })\n"], [42, "}\n"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [9, 42], "resource": "azurerm_linux_virtual_machine.linux_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VMAgentIsInstalled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_92", "bc_check_id": "BC_AZR_GENERAL_66", "check_name": "Ensure that Virtual Machines use managed disks", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[9, "resource azurerm_linux_virtual_machine \"linux_machine\" {\n"], [10, "  admin_username                  = \"terragoat-linux\"\n"], [11, "  admin_password                  = random_string.password.result\n"], [12, "  location                        = var.location\n"], [13, "  name                            = \"terragoat-linux\"\n"], [14, "  network_interface_ids           = [azurerm_network_interface.ni_linux.id]\n"], [15, "  resource_group_name             = azurerm_resource_group.example.name\n"], [16, "  size                            = \"Standard_F2\"\n"], [17, "  disable_password_authentication = false\n"], [18, "  source_image_reference {\n"], [19, "    publisher = \"Canonical\"\n"], [20, "    offer     = \"UbuntuServer\"\n"], [21, "    sku       = \"16.04-LTS\"\n"], [22, "    version   = \"latest\"\n"], [23, "  }\n"], [24, "  os_disk {\n"], [25, "    caching              = \"ReadWrite\"\n"], [26, "    storage_account_type = \"Standard_LRS\"\n"], [27, "  }\n"], [28, "\n"], [29, "  tags = merge({\n"], [30, "    terragoat   = true\n"], [31, "    environment = var.environment\n"], [32, "    }, {\n"], [33, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [34, "    git_file             = \"terraform/azure/instance.tf\"\n"], [35, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [36, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [37, "    git_modifiers        = \"nimrodkor\"\n"], [38, "    git_org              = \"bridgecrewio\"\n"], [39, "    git_repo             = \"terragoat\"\n"], [40, "    yor_trace            = \"736ef713-51b8-4178-ad69-406be81f6ef2\"\n"], [41, "  })\n"], [42, "}\n"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [9, 42], "resource": "azurerm_linux_virtual_machine.linux_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VMStorageOsDisk", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-virtual-machines-use-managed-disks.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_179", "bc_check_id": null, "check_name": "Ensure VM agent is installed", "check_result": {"result": "PASSED", "evaluated_keys": ["provision_vm_agent"]}, "code_block": [[44, "resource azurerm_windows_virtual_machine \"windows_machine\" {\n"], [45, "  admin_password        = random_string.password.result\n"], [46, "  admin_username        = \"tg-${var.environment}\"\n"], [47, "  location              = var.location\n"], [48, "  name                  = \"tg-win\"\n"], [49, "  network_interface_ids = [azurerm_network_interface.ni_win.id]\n"], [50, "  resource_group_name   = azurerm_resource_group.example.name\n"], [51, "  size                  = \"Standard_F2\"\n"], [52, "  os_disk {\n"], [53, "    caching              = \"ReadWrite\"\n"], [54, "    storage_account_type = \"Standard_LRS\"\n"], [55, "  }\n"], [56, "\n"], [57, "  source_image_reference {\n"], [58, "    publisher = \"MicrosoftWindowsServer\"\n"], [59, "    offer     = \"WindowsServer\"\n"], [60, "    sku       = \"2016-Datacenter\"\n"], [61, "    version   = \"latest\"\n"], [62, "  }\n"], [63, "\n"], [64, "  tags = merge({\n"], [65, "    terragoat   = true\n"], [66, "    environment = var.environment\n"], [67, "    }, {\n"], [68, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [69, "    git_file             = \"terraform/azure/instance.tf\"\n"], [70, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [71, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [72, "    git_modifiers        = \"nimrodkor\"\n"], [73, "    git_org              = \"bridgecrewio\"\n"], [74, "    git_repo             = \"terragoat\"\n"], [75, "    yor_trace            = \"41938587-bdfc-4234-b941-560f1ae7d6c0\"\n"], [76, "  })\n"], [77, "}"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [44, 77], "resource": "azurerm_windows_virtual_machine.windows_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VMAgentIsInstalled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_177", "bc_check_id": null, "check_name": "Ensure Windows VM enables automatic updates", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_automatic_updates"]}, "code_block": [[44, "resource azurerm_windows_virtual_machine \"windows_machine\" {\n"], [45, "  admin_password        = random_string.password.result\n"], [46, "  admin_username        = \"tg-${var.environment}\"\n"], [47, "  location              = var.location\n"], [48, "  name                  = \"tg-win\"\n"], [49, "  network_interface_ids = [azurerm_network_interface.ni_win.id]\n"], [50, "  resource_group_name   = azurerm_resource_group.example.name\n"], [51, "  size                  = \"Standard_F2\"\n"], [52, "  os_disk {\n"], [53, "    caching              = \"ReadWrite\"\n"], [54, "    storage_account_type = \"Standard_LRS\"\n"], [55, "  }\n"], [56, "\n"], [57, "  source_image_reference {\n"], [58, "    publisher = \"MicrosoftWindowsServer\"\n"], [59, "    offer     = \"WindowsServer\"\n"], [60, "    sku       = \"2016-Datacenter\"\n"], [61, "    version   = \"latest\"\n"], [62, "  }\n"], [63, "\n"], [64, "  tags = merge({\n"], [65, "    terragoat   = true\n"], [66, "    environment = var.environment\n"], [67, "    }, {\n"], [68, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [69, "    git_file             = \"terraform/azure/instance.tf\"\n"], [70, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [71, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [72, "    git_modifiers        = \"nimrodkor\"\n"], [73, "    git_org              = \"bridgecrewio\"\n"], [74, "    git_repo             = \"terragoat\"\n"], [75, "    yor_trace            = \"41938587-bdfc-4234-b941-560f1ae7d6c0\"\n"], [76, "  })\n"], [77, "}"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [44, 77], "resource": "azurerm_windows_virtual_machine.windows_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.WinVMAutomaticUpdates", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_92", "bc_check_id": "BC_AZR_GENERAL_66", "check_name": "Ensure that Virtual Machines use managed disks", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[44, "resource azurerm_windows_virtual_machine \"windows_machine\" {\n"], [45, "  admin_password        = random_string.password.result\n"], [46, "  admin_username        = \"tg-${var.environment}\"\n"], [47, "  location              = var.location\n"], [48, "  name                  = \"tg-win\"\n"], [49, "  network_interface_ids = [azurerm_network_interface.ni_win.id]\n"], [50, "  resource_group_name   = azurerm_resource_group.example.name\n"], [51, "  size                  = \"Standard_F2\"\n"], [52, "  os_disk {\n"], [53, "    caching              = \"ReadWrite\"\n"], [54, "    storage_account_type = \"Standard_LRS\"\n"], [55, "  }\n"], [56, "\n"], [57, "  source_image_reference {\n"], [58, "    publisher = \"MicrosoftWindowsServer\"\n"], [59, "    offer     = \"WindowsServer\"\n"], [60, "    sku       = \"2016-Datacenter\"\n"], [61, "    version   = \"latest\"\n"], [62, "  }\n"], [63, "\n"], [64, "  tags = merge({\n"], [65, "    terragoat   = true\n"], [66, "    environment = var.environment\n"], [67, "    }, {\n"], [68, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [69, "    git_file             = \"terraform/azure/instance.tf\"\n"], [70, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [71, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [72, "    git_modifiers        = \"nimrodkor\"\n"], [73, "    git_org              = \"bridgecrewio\"\n"], [74, "    git_repo             = \"terragoat\"\n"], [75, "    yor_trace            = \"41938587-bdfc-4234-b941-560f1ae7d6c0\"\n"], [76, "  })\n"], [77, "}"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [44, 77], "resource": "azurerm_windows_virtual_machine.windows_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VMStorageOsDisk", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-virtual-machines-use-managed-disks.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_111", "bc_check_id": "BC_AZR_GENERAL_41", "check_name": "Ensure that key vault enables soft delete", "check_result": {"result": "PASSED", "evaluated_keys": ["soft_delete_enabled"]}, "code_block": [[1, "resource \"azurerm_key_vault\" \"example\" {\n"], [2, "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  location            = azurerm_resource_group.example.location\n"], [4, "  resource_group_name = azurerm_resource_group.example.name\n"], [5, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [6, "  sku_name            = \"premium\"\n"], [7, "  access_policy {\n"], [8, "    tenant_id = data.azurerm_client_config.current.tenant_id\n"], [9, "    object_id = data.azurerm_client_config.current.object_id\n"], [10, "    key_permissions = [\n"], [11, "      \"create\",\n"], [12, "      \"get\",\n"], [13, "    ]\n"], [14, "    secret_permissions = [\n"], [15, "      \"set\",\n"], [16, "    ]\n"], [17, "  }\n"], [18, "  tags = merge({\n"], [19, "    environment = var.environment\n"], [20, "    terragoat   = true\n"], [21, "    }, {\n"], [22, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [23, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [24, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [25, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [26, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [27, "    git_org              = \"bridgecrewio\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"79afeacc-248a-4015-a4fa-76a6a57f06e2\"\n"], [30, "  })\n"], [31, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [1, 31], "resource": "azurerm_key_vault.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesSoftDelete", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-soft-delete.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_3", "bc_check_id": null, "check_name": "Ensure that 'enable_https_traffic_only' is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_https_traffic_only"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountsTransportEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_36", "bc_check_id": "BC_AZR_NETWORKING_16", "check_name": "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountAzureServicesAccessEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "PASSED", "evaluated_keys": ["email_addresses"]}, "code_block": [[153, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy1\" {\n"], [154, "  resource_group_name        = azurerm_resource_group.example.name\n"], [155, "  server_name                = azurerm_mssql_server.mssql1.name\n"], [156, "  state                      = \"Enabled\"\n"], [157, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [158, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [159, "  disabled_alerts = [\n"], [160, "    \"Sql_Injection\",\n"], [161, "    \"Data_Exfiltration\"\n"], [162, "  ]\n"], [163, "  retention_days  = 20\n"], [164, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [165, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [153, 165], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "PASSED", "evaluated_keys": ["email_addresses"]}, "code_block": [[167, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy2\" {\n"], [168, "  resource_group_name        = azurerm_resource_group.example.name\n"], [169, "  server_name                = azurerm_mssql_server.mssql2.name\n"], [170, "  state                      = \"Enabled\"\n"], [171, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [172, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [173, "  disabled_alerts = [\n"], [174, "    \"Sql_Injection\",\n"], [175, "    \"Data_Exfiltration\"\n"], [176, "  ]\n"], [177, "  retention_days  = 20\n"], [178, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [179, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [167, 179], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "PASSED", "evaluated_keys": ["email_addresses"]}, "code_block": [[181, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy3\" {\n"], [182, "  resource_group_name        = azurerm_resource_group.example.name\n"], [183, "  server_name                = azurerm_mssql_server.mssql3.name\n"], [184, "  state                      = \"Enabled\"\n"], [185, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [186, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [187, "  disabled_alerts = [\n"], [188, "    \"Sql_Injection\",\n"], [189, "    \"Data_Exfiltration\"\n"], [190, "  ]\n"], [191, "  retention_days  = 20\n"], [192, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [193, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [181, 193], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy3", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "PASSED", "evaluated_keys": ["email_addresses"]}, "code_block": [[195, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy4\" {\n"], [196, "  resource_group_name        = azurerm_resource_group.example.name\n"], [197, "  server_name                = azurerm_mssql_server.mssql4.name\n"], [198, "  state                      = \"Enabled\"\n"], [199, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [200, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [201, "  disabled_alerts = [\n"], [202, "    \"Sql_Injection\",\n"], [203, "    \"Data_Exfiltration\"\n"], [204, "  ]\n"], [205, "  retention_days  = 20\n"], [206, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [207, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [195, 207], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy4", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "PASSED", "evaluated_keys": ["email_addresses"]}, "code_block": [[222, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy6\" {\n"], [223, "  resource_group_name        = azurerm_resource_group.example.name\n"], [224, "  server_name                = azurerm_mssql_server.mssql6.name\n"], [225, "  state                      = \"Enabled\"\n"], [226, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [227, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [228, "  disabled_alerts = [\n"], [229, "    \"Sql_Injection\",\n"], [230, "    \"Data_Exfiltration\"\n"], [231, "  ]\n"], [232, "  retention_days  = 20\n"], [233, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [234, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [222, 234], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy6", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "PASSED", "evaluated_keys": ["email_addresses"]}, "code_block": [[236, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy7\" {\n"], [237, "  resource_group_name        = azurerm_resource_group.example.name\n"], [238, "  server_name                = azurerm_mssql_server.mssql7.name\n"], [239, "  state                      = \"Enabled\"\n"], [240, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [241, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [242, "  disabled_alerts = [\n"], [243, "    \"Sql_Injection\",\n"], [244, "    \"Data_Exfiltration\"\n"], [245, "  ]\n"], [246, "  retention_days  = 20\n"], [247, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [248, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [236, 248], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy7", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_183", "bc_check_id": null, "check_name": "Ensure that VNET uses local DNS addresses", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"azurerm_virtual_network\" \"example\" {\n"], [2, "  name                = \"terragoat-vn-${var.environment}\"\n"], [3, "  address_space       = [\"10.0.0.0/16\"]\n"], [4, "  location            = azurerm_resource_group.example.location\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  tags = {\n"], [7, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [8, "    git_file             = \"terraform/azure/networking.tf\"\n"], [9, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [10, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [11, "    git_modifiers        = \"nimrodkor\"\n"], [12, "    git_org              = \"bridgecrewio\"\n"], [13, "    git_repo             = \"terragoat\"\n"], [14, "    yor_trace            = \"eb19f165-9c21-4a7a-96e5-5bb557a38228\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [1, 16], "resource": "azurerm_virtual_network.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetLocalDNS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.example", "path": "/terraform/terraform/azure/networking.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_182", "bc_check_id": null, "check_name": "Ensure that VNET has at least 2 connected DNS Endpoints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "resource \"azurerm_virtual_network\" \"example\" {\n"], [2, "  name                = \"terragoat-vn-${var.environment}\"\n"], [3, "  address_space       = [\"10.0.0.0/16\"]\n"], [4, "  location            = azurerm_resource_group.example.location\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  tags = {\n"], [7, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [8, "    git_file             = \"terraform/azure/networking.tf\"\n"], [9, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [10, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [11, "    git_modifiers        = \"nimrodkor\"\n"], [12, "    git_org              = \"bridgecrewio\"\n"], [13, "    git_repo             = \"terragoat\"\n"], [14, "    yor_trace            = \"eb19f165-9c21-4a7a-96e5-5bb557a38228\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [1, 16], "resource": "azurerm_virtual_network.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VnetSingleDNSServer", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.example", "path": "/terraform/terraform/azure/networking.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_118", "bc_check_id": "BC_AZR_NETWORKING_35", "check_name": "Ensure that Network Interfaces disable IP forwarding", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_ip_forwarding"]}, "code_block": [[25, "resource \"azurerm_network_interface\" \"ni_linux\" {\n"], [26, "  name                = \"terragoat-linux-${var.environment}\"\n"], [27, "  location            = azurerm_resource_group.example.location\n"], [28, "  resource_group_name = azurerm_resource_group.example.name\n"], [29, "\n"], [30, "  ip_configuration {\n"], [31, "    name                          = \"internal\"\n"], [32, "    subnet_id                     = azurerm_subnet.example.id\n"], [33, "    private_ip_address_allocation = \"Dynamic\"\n"], [34, "  }\n"], [35, "  tags = {\n"], [36, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [37, "    git_file             = \"terraform/azure/networking.tf\"\n"], [38, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [39, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [40, "    git_modifiers        = \"nimrodkor\"\n"], [41, "    git_org              = \"bridgecrewio\"\n"], [42, "    git_repo             = \"terragoat\"\n"], [43, "    yor_trace            = \"2647f099-dff8-4514-8cef-96159380c02a\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [25, 45], "resource": "azurerm_network_interface.ni_linux", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NetworkInterfaceEnableIPForwarding", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-network-interfaces-disable-ip-forwarding.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_118", "bc_check_id": "BC_AZR_NETWORKING_35", "check_name": "Ensure that Network Interfaces disable IP forwarding", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_ip_forwarding"]}, "code_block": [[47, "resource \"azurerm_network_interface\" \"ni_win\" {\n"], [48, "  name                = \"terragoat-win-${var.environment}\"\n"], [49, "  location            = azurerm_resource_group.example.location\n"], [50, "  resource_group_name = azurerm_resource_group.example.name\n"], [51, "\n"], [52, "  ip_configuration {\n"], [53, "    name                          = \"internal\"\n"], [54, "    subnet_id                     = azurerm_subnet.example.id\n"], [55, "    private_ip_address_allocation = \"Dynamic\"\n"], [56, "  }\n"], [57, "  tags = {\n"], [58, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [59, "    git_file             = \"terraform/azure/networking.tf\"\n"], [60, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [61, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [62, "    git_modifiers        = \"nimrodkor\"\n"], [63, "    git_org              = \"bridgecrewio\"\n"], [64, "    git_repo             = \"terragoat\"\n"], [65, "    yor_trace            = \"2b5dbf28-04fb-4151-a637-a731bbe7ed1d\"\n"], [66, "  }\n"], [67, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [47, 67], "resource": "azurerm_network_interface.ni_win", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NetworkInterfaceEnableIPForwarding", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-network-interfaces-disable-ip-forwarding.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_77", "bc_check_id": "BC_AZR_NETWORKING_22", "check_name": "Ensure that UDP Services are restricted from the Internet ", "check_result": {"result": "PASSED", "evaluated_keys": ["security_rule"]}, "code_block": [[69, "resource azurerm_network_security_group \"bad_sg\" {\n"], [70, "  location            = var.location\n"], [71, "  name                = \"terragoat-${var.environment}\"\n"], [72, "  resource_group_name = azurerm_resource_group.example.name\n"], [73, "\n"], [74, "  security_rule {\n"], [75, "    access                     = \"Allow\"\n"], [76, "    direction                  = \"Inbound\"\n"], [77, "    name                       = \"AllowSSH\"\n"], [78, "    priority                   = 200\n"], [79, "    protocol                   = \"TCP\"\n"], [80, "    source_address_prefix      = \"*\"\n"], [81, "    source_port_range          = \"*\"\n"], [82, "    destination_port_range     = \"22-22\"\n"], [83, "    destination_address_prefix = \"*\"\n"], [84, "  }\n"], [85, "\n"], [86, "  security_rule {\n"], [87, "    access                     = \"Allow\"\n"], [88, "    direction                  = \"Inbound\"\n"], [89, "    name                       = \"AllowRDP\"\n"], [90, "    priority                   = 300\n"], [91, "    protocol                   = \"TCP\"\n"], [92, "    source_address_prefix      = \"*\"\n"], [93, "    source_port_range          = \"*\"\n"], [94, "    destination_port_range     = \"3389-3389\"\n"], [95, "    destination_address_prefix = \"*\"\n"], [96, "  }\n"], [97, "  tags = {\n"], [98, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [99, "    git_file             = \"terraform/azure/networking.tf\"\n"], [100, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [101, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [102, "    git_modifiers        = \"nimrodkor\"\n"], [103, "    git_org              = \"bridgecrewio\"\n"], [104, "    git_repo             = \"terragoat\"\n"], [105, "    yor_trace            = \"1a591ba4-d969-4572-9704-87b5c55c0ba3\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [69, 107], "resource": "azurerm_network_security_group.bad_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleUDPAccessRestricted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-udp-services-are-restricted-from-the-internet.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_160", "bc_check_id": "BC_AZR_NETWORKING_57", "check_name": "Ensure that HTTP (port 80) access is restricted from the internet", "check_result": {"result": "PASSED", "evaluated_keys": ["security_rule"]}, "code_block": [[69, "resource azurerm_network_security_group \"bad_sg\" {\n"], [70, "  location            = var.location\n"], [71, "  name                = \"terragoat-${var.environment}\"\n"], [72, "  resource_group_name = azurerm_resource_group.example.name\n"], [73, "\n"], [74, "  security_rule {\n"], [75, "    access                     = \"Allow\"\n"], [76, "    direction                  = \"Inbound\"\n"], [77, "    name                       = \"AllowSSH\"\n"], [78, "    priority                   = 200\n"], [79, "    protocol                   = \"TCP\"\n"], [80, "    source_address_prefix      = \"*\"\n"], [81, "    source_port_range          = \"*\"\n"], [82, "    destination_port_range     = \"22-22\"\n"], [83, "    destination_address_prefix = \"*\"\n"], [84, "  }\n"], [85, "\n"], [86, "  security_rule {\n"], [87, "    access                     = \"Allow\"\n"], [88, "    direction                  = \"Inbound\"\n"], [89, "    name                       = \"AllowRDP\"\n"], [90, "    priority                   = 300\n"], [91, "    protocol                   = \"TCP\"\n"], [92, "    source_address_prefix      = \"*\"\n"], [93, "    source_port_range          = \"*\"\n"], [94, "    destination_port_range     = \"3389-3389\"\n"], [95, "    destination_address_prefix = \"*\"\n"], [96, "  }\n"], [97, "  tags = {\n"], [98, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [99, "    git_file             = \"terraform/azure/networking.tf\"\n"], [100, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [101, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [102, "    git_modifiers        = \"nimrodkor\"\n"], [103, "    git_org              = \"bridgecrewio\"\n"], [104, "    git_repo             = \"terragoat\"\n"], [105, "    yor_trace            = \"1a591ba4-d969-4572-9704-87b5c55c0ba3\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [69, 107], "resource": "azurerm_network_security_group.bad_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleHTTPAccessRestricted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-azure-http-port-80-access-from-the-internet-is-restricted.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_85", "bc_check_id": "BC_AZR_GENERAL_62", "check_name": "Ensure that Azure Defender is set to On for Kubernetes", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnKubernetes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-kubernetes.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_55", "bc_check_id": "BC_AZR_GENERAL_46", "check_name": "Ensure that Azure Defender is set to On for Servers", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnServers", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-servers.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_61", "bc_check_id": "BC_AZR_GENERAL_50", "check_name": "Ensure that Azure Defender is set to On for App Service", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnAppServices", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-app-service.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_86", "bc_check_id": "BC_AZR_GENERAL_63", "check_name": "Ensure that Azure Defender is set to On for Container Registries", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnContainerRegistry", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-container-registries.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_69", "bc_check_id": "BC_AZR_GENERAL_53", "check_name": "Ensure that Azure Defender is set to On for Azure SQL database servers", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnSqlServers", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-azure-sql-database-servers.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_79", "bc_check_id": "BC_AZR_GENERAL_56", "check_name": "Ensure that Azure Defender is set to On for SQL servers on machines", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnSqlServerVMS", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-sql-servers-on-machines.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_84", "bc_check_id": "BC_AZR_GENERAL_61", "check_name": "Ensure that Azure Defender is set to On for Storage", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnStorage", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-storage.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_87", "bc_check_id": "BC_AZR_GENERAL_64", "check_name": "Ensure that Azure Defender is set to On for Key Vault", "check_result": {"result": "PASSED", "evaluated_keys": ["resource_type", "tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureDefenderOnKeyVaults", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-key-vault.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_131", "bc_check_id": "BC_AZR_GENERAL_49", "check_name": "Ensure that 'Security contact emails' is set", "check_result": {"result": "PASSED", "evaluated_keys": ["email"]}, "code_block": [[5, "resource azurerm_security_center_contact \"contact\" {\n"], [6, "  alert_notifications = false\n"], [7, "  alerts_to_admins    = false\n"], [8, "  email               = \"some@email.com\"\n"], [9, "}"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [5, 9], "resource": "azurerm_security_center_contact.contact", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SecurityCenterContactEmails", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-security-contact-emails-is-set.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_11", "bc_check_id": "BC_AZR_NETWORKING_4", "check_name": "Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)", "check_result": {"result": "PASSED", "evaluated_keys": ["start_ip_address", "end_ip_address"]}, "code_block": [[1, "resource \"azurerm_sql_firewall_rule\" \"example\" {\n"], [2, "  name                = \"terragoat-firewall-rule-${var.environment}\"\n"], [3, "  resource_group_name = azurerm_resource_group.example.name\n"], [4, "  server_name         = azurerm_sql_server.example.name\n"], [5, "  start_ip_address    = \"10.0.17.62\"\n"], [6, "  end_ip_address      = \"10.0.17.62\"\n"], [7, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [1, 7], "resource": "azurerm_sql_firewall_rule.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerNoPublicAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_96", "bc_check_id": "BC_AZR_GENERAL_30", "check_name": "Ensure that MySQL server enables infrastructure encryption", "check_result": {"result": "PASSED", "evaluated_keys": ["infrastructure_encryption_enabled"]}, "code_block": [[44, "resource \"azurerm_mysql_server\" \"example\" {\n"], [45, "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n"], [46, "  location            = azurerm_resource_group.example.location\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "\n"], [49, "  administrator_login          = \"terragoat-${var.environment}\"\n"], [50, "  administrator_login_password = random_string.password.result\n"], [51, "\n"], [52, "  sku_name   = \"B_Gen5_2\"\n"], [53, "  storage_mb = 5120\n"], [54, "  version    = \"5.7\"\n"], [55, "\n"], [56, "  auto_grow_enabled                 = true\n"], [57, "  backup_retention_days             = 7\n"], [58, "  infrastructure_encryption_enabled = true\n"], [59, "  public_network_access_enabled     = true\n"], [60, "  ssl_enforcement_enabled           = false\n"], [61, "  tags = {\n"], [62, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [63, "    git_file             = \"terraform/azure/sql.tf\"\n"], [64, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [65, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [66, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [67, "    git_org              = \"bridgecrewio\"\n"], [68, "    git_repo             = \"terragoat\"\n"], [69, "    yor_trace            = \"1ac18c16-09a4-41c9-9a66-6f514050178e\"\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [44, 71], "resource": "azurerm_mysql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MySQLEncryptionEnaled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-postgresql-server-enables-infrastructure-encryption-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "administrator_login": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_146", "bc_check_id": null, "check_name": "Ensure server parameter 'log_retention' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "PASSED", "evaluated_keys": ["name", "value"]}, "code_block": [[98, "resource \"azurerm_postgresql_configuration\" \"thrtottling_config\" {\n"], [99, "  name                = \"connection_throttling\"\n"], [100, "  resource_group_name = azurerm_resource_group.example.name\n"], [101, "  server_name         = azurerm_postgresql_server.example.name\n"], [102, "  value               = \"off\"\n"], [103, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [98, 103], "resource": "azurerm_postgresql_configuration.thrtottling_config", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerLogRetentionEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_31", "bc_check_id": "BC_AZR_NETWORKING_12", "check_name": "Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "PASSED", "evaluated_keys": ["name", "value"]}, "code_block": [[98, "resource \"azurerm_postgresql_configuration\" \"thrtottling_config\" {\n"], [99, "  name                = \"connection_throttling\"\n"], [100, "  resource_group_name = azurerm_resource_group.example.name\n"], [101, "  server_name         = azurerm_postgresql_server.example.name\n"], [102, "  value               = \"off\"\n"], [103, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [98, 103], "resource": "azurerm_postgresql_configuration.thrtottling_config", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerLogConnectionsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-12.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_30", "bc_check_id": "BC_AZR_NETWORKING_11", "check_name": "Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "PASSED", "evaluated_keys": ["name", "value"]}, "code_block": [[98, "resource \"azurerm_postgresql_configuration\" \"thrtottling_config\" {\n"], [99, "  name                = \"connection_throttling\"\n"], [100, "  resource_group_name = azurerm_resource_group.example.name\n"], [101, "  server_name         = azurerm_postgresql_server.example.name\n"], [102, "  value               = \"off\"\n"], [103, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [98, 103], "resource": "azurerm_postgresql_configuration.thrtottling_config", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerLogCheckpointsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-11.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_32", "bc_check_id": "BC_AZR_NETWORKING_13", "check_name": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "PASSED", "evaluated_keys": ["name", "value"]}, "code_block": [[105, "resource \"azurerm_postgresql_configuration\" \"example\" {\n"], [106, "  name                = \"log_checkpoints\"\n"], [107, "  resource_group_name = azurerm_resource_group.example.name\n"], [108, "  server_name         = azurerm_postgresql_server.example.name\n"], [109, "  value               = \"off\"\n"], [110, "}"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [105, 110], "resource": "azurerm_postgresql_configuration.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerConnectionThrottlingEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-13.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_146", "bc_check_id": null, "check_name": "Ensure server parameter 'log_retention' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "PASSED", "evaluated_keys": ["name", "value"]}, "code_block": [[105, "resource \"azurerm_postgresql_configuration\" \"example\" {\n"], [106, "  name                = \"log_checkpoints\"\n"], [107, "  resource_group_name = azurerm_resource_group.example.name\n"], [108, "  server_name         = azurerm_postgresql_server.example.name\n"], [109, "  value               = \"off\"\n"], [110, "}"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [105, 110], "resource": "azurerm_postgresql_configuration.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerLogRetentionEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_31", "bc_check_id": "BC_AZR_NETWORKING_12", "check_name": "Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "PASSED", "evaluated_keys": ["name", "value"]}, "code_block": [[105, "resource \"azurerm_postgresql_configuration\" \"example\" {\n"], [106, "  name                = \"log_checkpoints\"\n"], [107, "  resource_group_name = azurerm_resource_group.example.name\n"], [108, "  server_name         = azurerm_postgresql_server.example.name\n"], [109, "  value               = \"off\"\n"], [110, "}"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [105, 110], "resource": "azurerm_postgresql_configuration.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerLogConnectionsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-12.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_3", "bc_check_id": null, "check_name": "Ensure that 'enable_https_traffic_only' is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_https_traffic_only"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountsTransportEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_36", "bc_check_id": "BC_AZR_NETWORKING_16", "check_name": "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountAzureServicesAccessEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_206", "bc_check_id": null, "check_name": "Ensure that Storage Accounts use replication", "check_result": {"result": "PASSED", "evaluated_keys": ["account_replication_type"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountsUseReplication", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_35", "bc_check_id": "BC_AZR_NETWORKING_15", "check_name": "Ensure default network access rule for Storage Accounts is set to deny", "check_result": {"result": "PASSED", "evaluated_keys": ["default_action"]}, "code_block": [[62, "resource \"azurerm_storage_account_network_rules\" \"test\" {\n"], [63, "  resource_group_name  = azurerm_resource_group.example.name\n"], [64, "  storage_account_name = azurerm_storage_account.example.name\n"], [65, "\n"], [66, "  default_action = \"Deny\"\n"], [67, "  ip_rules       = [\"127.0.0.1\"]\n"], [68, "  bypass         = [\"Metrics\"]\n"], [69, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [62, 69], "resource": "azurerm_storage_account_network_rules.test", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountDefaultNetworkAccessDeny", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "storage_account_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_57", "bc_check_id": "BC_GCP_SQL_8", "check_name": "Ensure PostgreSQL database 'log_min_duration_statement' flag is set to '-1'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogMinDuration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_56", "bc_check_id": "BC_GCP_SQL_7", "check_name": "Ensure PostgreSQL database 'log_temp_files flag is set to '0'", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogTemp", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_55", "bc_check_id": "BC_GCP_SQL_6", "check_name": "Ensure PostgreSQL database 'log_min_messages' flag is set to a valid value", "check_result": {"result": "PASSED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogMinMessage", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_71", "bc_check_id": "BC_GCP_KUBERNETES_24", "check_name": "Ensure Shielded GKE Nodes are Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["enable_shielded_nodes"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEEnableShieldedNodes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-shielded-gke-nodes-are-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_19", "bc_check_id": "BC_GCP_KUBERNETES_11", "check_name": "Ensure GKE basic auth is disabled", "check_result": {"result": "PASSED", "evaluated_keys": ["master_auth/[0]/username", "master_auth/[0]/password"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEBasicAuth", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-11.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_20", "bc_check_id": "BC_GCP_KUBERNETES_12", "check_name": "Ensure master authorized networks is set to enabled in GKE clusters", "check_result": {"result": "PASSED", "evaluated_keys": ["master_authorized_networks_config"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMasterAuthorizedNetworksEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-12.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_72", "bc_check_id": "BC_GCP_KUBERNETES_25", "check_name": "Ensure Integrity Monitoring for Shielded GKE Nodes is Enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["node_config/[0]/shielded_instance_config/[0]/enable_integrity_monitoring"]}, "code_block": [[24, "resource \"google_container_node_pool\" \"custom_node_pool\" {\n"], [25, "  cluster  = google_container_cluster.workload_cluster.name\n"], [26, "  location = var.region\n"], [27, "\n"], [28, "  node_config {\n"], [29, "    image_type = \"Ubuntu\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [24, 31], "resource": "google_container_node_pool.custom_node_pool", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEEnsureIntegrityMonitoring", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-integrity-monitoring-for-shielded-gke-nodes-is-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_31", "bc_check_id": "BC_GCP_IAM_2", "check_name": "Ensure that instances are not configured to use the default service account with full access to all Cloud APIs", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeDefaultServiceAccountFullAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_OCI_1", "bc_check_id": "BC_OCI_SECRETS_1", "check_name": "Ensure no hard coded OCI private key in provider", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[1, "provider \"oci\" {\n"], [2, "  #these to be provided by env vars\n"], [3, "  # private_key_path\n"], [4, "  # fingerprint\n"], [5, "  # tenancy_ocid \n"], [6, "  # user_ocid   \n"], [7, "  region = \"uk-london-1\"\n"], [8, "}"]], "file_path": "/terraform/oracle/provider.tf", "file_abs_path": "/terraform/terraform/oracle/provider.tf", "repo_file_path": "/terraform/oracle/provider.tf", "file_line_range": [1, 8], "resource": "oci.default", "evaluations": null, "check_class": "checkov.terraform.checks.provider.oci.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/oci-policies/secrets-1/bc-oci-secrets-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/oracle/provider.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV2_GCP_12", "bc_check_id": "BC_GCP_NETWORKING_20", "check_name": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports", "check_result": {"result": "PASSED", "entity": {"google_compute_firewall": {"allow_all": {"__end_line__": 27, "__start_line__": 19, "allow": [{"ports": [["0-65535"]], "protocol": ["tcp"]}], "name": ["terragoat-dev-firewall"], "network": ["google_compute_network.vpc.id"], "source_ranges": [["0.0.0.0/0"]], "__address__": "google_compute_firewall.allow_all"}}}, "evaluated_keys": ["direction", "allow/protocol", "disabled", "source_ranges"]}, "code_block": [[19, "resource \"google_compute_firewall\" \"allow_all\" {\n"], [20, "  name          = \"terragoat-${var.environment}-firewall\"\n"], [21, "  network       = google_compute_network.vpc.id\n"], [22, "  source_ranges = [\"0.0.0.0/0\"]\n"], [23, "  allow {\n"], [24, "    protocol = \"tcp\"\n"], [25, "    ports    = [\"0-65535\"]\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [19, 27], "resource": "google_compute_firewall.allow_all", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-access-to-all-ports.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/networks.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_18", "bc_check_id": null, "check_name": "Ensure GCP network defines a firewall and does not use the default firewall", "check_result": {"result": "PASSED", "entity": {"google_compute_network": {"vpc": {"__end_line__": 5, "__start_line__": 1, "auto_create_subnetworks": [false], "description": ["Virtual vulnerable-by-design network"], "name": ["terragoat-dev-network"], "__address__": "google_compute_network.vpc"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[1, "resource \"google_compute_network\" \"vpc\" {\n"], [2, "  name                    = \"terragoat-${var.environment}-network\"\n"], [3, "  description             = \"Virtual vulnerable-by-design network\"\n"], [4, "  auto_create_subnetworks = false\n"], [5, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [1, 5], "resource": "google_compute_network.vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/networks.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_19", "bc_check_id": null, "check_name": "Ensure GCP Kubernetes engine clusters have 'alpha cluster' feature disabled", "check_result": {"result": "PASSED", "entity": {"google_container_cluster": {"workload_cluster": {"__end_line__": 22, "__start_line__": 6, "enable_legacy_abac": [true], "initial_node_count": [1], "location": ["us-central1"], "logging_service": ["none"], "master_authorized_networks_config": [{"cidr_blocks": [{"cidr_block": ["0.0.0.0/0"]}]}], "monitoring_service": ["none"], "name": ["terragoat-dev-cluster"], "network": ["terragoat-dev-network"], "remove_default_node_pool": [true], "subnetwork": ["terragoat-dev-public-subnetwork"], "__address__": "google_container_cluster.workload_cluster"}}}, "evaluated_keys": ["enable_kubernetes_alpha"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/gke.tf", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_20", "bc_check_id": null, "check_name": "Ensure MySQL DB instance has point-in-time recovery backup configured", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"master_instance": {"__end_line__": 19, "__start_line__": 1, "database_version": ["POSTGRES_11"], "name": ["terragoat-dev-master"], "region": ["us-central1"], "settings": [{"backup_configuration": [{"enabled": [false]}], "ip_configuration": [{"authorized_networks": [{"name": ["WWW"], "value": ["0.0.0.0/0"]}], "ipv4_enabled": [true]}], "tier": ["db-f1-micro"]}], "__address__": "google_sql_database_instance.master_instance"}}}, "evaluated_keys": ["database_version", "settings/backup_configuration/binary_log_enabled"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/big_data.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_14", "bc_check_id": null, "check_name": "Ensure PostgreSQL database flag 'log_executor_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"master_instance": {"__end_line__": 19, "__start_line__": 1, "database_version": ["POSTGRES_11"], "name": ["terragoat-dev-master"], "region": ["us-central1"], "settings": [{"backup_configuration": [{"enabled": [false]}], "ip_configuration": [{"authorized_networks": [{"name": ["WWW"], "value": ["0.0.0.0/0"]}], "ipv4_enabled": [true]}], "tier": ["db-f1-micro"]}], "__address__": "google_sql_database_instance.master_instance"}}}, "evaluated_keys": ["settings/database_flags[*]", "database_version", "settings/database_flags[?(@/name == log_executor_stats & @/value == on)]"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/big_data.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_17", "bc_check_id": null, "check_name": "Ensure PostgreSQL database flag 'log_statement_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"master_instance": {"__end_line__": 19, "__start_line__": 1, "database_version": ["POSTGRES_11"], "name": ["terragoat-dev-master"], "region": ["us-central1"], "settings": [{"backup_configuration": [{"enabled": [false]}], "ip_configuration": [{"authorized_networks": [{"name": ["WWW"], "value": ["0.0.0.0/0"]}], "ipv4_enabled": [true]}], "tier": ["db-f1-micro"]}], "__address__": "google_sql_database_instance.master_instance"}}}, "evaluated_keys": ["settings/database_flags[*]", "database_version", "settings/database_flags[?(@/name == log_statement_stats & @/value == on)]"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/big_data.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_119", "bc_check_id": "BC_AZR_NETWORKING_36", "check_name": "Ensure that Network Interfaces don't use public IPs", "check_result": {"result": "PASSED", "entity": {"azurerm_network_interface": {"ni_linux": {"__end_line__": 45, "__start_line__": 25, "ip_configuration": [{"name": ["internal"], "private_ip_address_allocation": ["Dynamic"], "subnet_id": ["azurerm_subnet.example.id"]}], "location": ["East US"], "name": ["terragoat-linux-dev"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "de3bb777f967989c2c3332faea16cb614c55ccc9", "git_file": "terraform/azure/networking.tf", "git_last_modified_at": "2020-06-17 15:48:15", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "2647f099-dff8-4514-8cef-96159380c02a"}], "__address__": "azurerm_network_interface.ni_linux"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[25, "resource \"azurerm_network_interface\" \"ni_linux\" {\n"], [26, "  name                = \"terragoat-linux-${var.environment}\"\n"], [27, "  location            = azurerm_resource_group.example.location\n"], [28, "  resource_group_name = azurerm_resource_group.example.name\n"], [29, "\n"], [30, "  ip_configuration {\n"], [31, "    name                          = \"internal\"\n"], [32, "    subnet_id                     = azurerm_subnet.example.id\n"], [33, "    private_ip_address_allocation = \"Dynamic\"\n"], [34, "  }\n"], [35, "  tags = {\n"], [36, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [37, "    git_file             = \"terraform/azure/networking.tf\"\n"], [38, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [39, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [40, "    git_modifiers        = \"nimrodkor\"\n"], [41, "    git_org              = \"bridgecrewio\"\n"], [42, "    git_repo             = \"terragoat\"\n"], [43, "    yor_trace            = \"2647f099-dff8-4514-8cef-96159380c02a\"\n"], [44, "  }\n"], [45, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [25, 45], "resource": "azurerm_network_interface.ni_linux", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "de3bb777f967989c2c3332faea16cb614c55ccc9", "git_file": "terraform/azure/networking.tf", "git_last_modified_at": "2020-06-17 15:48:15", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "2647f099-dff8-4514-8cef-96159380c02a"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-network-interfaces-dont-use-public-ips.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/networking.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_119", "bc_check_id": "BC_AZR_NETWORKING_36", "check_name": "Ensure that Network Interfaces don't use public IPs", "check_result": {"result": "PASSED", "entity": {"azurerm_network_interface": {"ni_win": {"__end_line__": 67, "__start_line__": 47, "ip_configuration": [{"name": ["internal"], "private_ip_address_allocation": ["Dynamic"], "subnet_id": ["azurerm_subnet.example.id"]}], "location": ["East US"], "name": ["terragoat-win-dev"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "de3bb777f967989c2c3332faea16cb614c55ccc9", "git_file": "terraform/azure/networking.tf", "git_last_modified_at": "2020-06-17 15:48:15", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "2b5dbf28-04fb-4151-a637-a731bbe7ed1d"}], "__address__": "azurerm_network_interface.ni_win"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[47, "resource \"azurerm_network_interface\" \"ni_win\" {\n"], [48, "  name                = \"terragoat-win-${var.environment}\"\n"], [49, "  location            = azurerm_resource_group.example.location\n"], [50, "  resource_group_name = azurerm_resource_group.example.name\n"], [51, "\n"], [52, "  ip_configuration {\n"], [53, "    name                          = \"internal\"\n"], [54, "    subnet_id                     = azurerm_subnet.example.id\n"], [55, "    private_ip_address_allocation = \"Dynamic\"\n"], [56, "  }\n"], [57, "  tags = {\n"], [58, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [59, "    git_file             = \"terraform/azure/networking.tf\"\n"], [60, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [61, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [62, "    git_modifiers        = \"nimrodkor\"\n"], [63, "    git_org              = \"bridgecrewio\"\n"], [64, "    git_repo             = \"terragoat\"\n"], [65, "    yor_trace            = \"2b5dbf28-04fb-4151-a637-a731bbe7ed1d\"\n"], [66, "  }\n"], [67, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [47, 67], "resource": "azurerm_network_interface.ni_win", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "de3bb777f967989c2c3332faea16cb614c55ccc9", "git_file": "terraform/azure/networking.tf", "git_last_modified_at": "2020-06-17 15:48:15", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "2b5dbf28-04fb-4151-a637-a731bbe7ed1d"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-network-interfaces-dont-use-public-ips.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/networking.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_16", "bc_check_id": null, "check_name": "Ensure PostgreSQL database flag 'log_planner_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"master_instance": {"__end_line__": 19, "__start_line__": 1, "database_version": ["POSTGRES_11"], "name": ["terragoat-dev-master"], "region": ["us-central1"], "settings": [{"backup_configuration": [{"enabled": [false]}], "ip_configuration": [{"authorized_networks": [{"name": ["WWW"], "value": ["0.0.0.0/0"]}], "ipv4_enabled": [true]}], "tier": ["db-f1-micro"]}], "__address__": "google_sql_database_instance.master_instance"}}}, "evaluated_keys": ["settings/database_flags[*]", "settings/database_flags[?(@/name == log_planner_stats & @/value == on)]", "database_version"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/big_data.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_7", "bc_check_id": "BC_GCP_IAM_11", "check_name": "Ensure that a MySQL database instance does not allow anyone to connect with administrative privileges", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"master_instance": {"__end_line__": 19, "__start_line__": 1, "database_version": ["POSTGRES_11"], "name": ["terragoat-dev-master"], "region": ["us-central1"], "settings": [{"backup_configuration": [{"enabled": [false]}], "ip_configuration": [{"authorized_networks": [{"name": ["WWW"], "value": ["0.0.0.0/0"]}], "ipv4_enabled": [true]}], "tier": ["db-f1-micro"]}], "__address__": "google_sql_database_instance.master_instance"}}}, "evaluated_keys": ["password", "name", "database_version", "resource_type"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-iam-policies/ensure-that-a-mysql-database-instance-does-not-allow-anyone-to-connect-with-administrative-privileges.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/big_data.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_2", "bc_check_id": "BC_AZR_GENERAL_70", "check_name": "Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account", "check_result": {"result": "PASSED", "entity": {"azurerm_sql_server": {"example": {"__end_line__": 29, "__start_line__": 9, "administrator_login": ["ariel"], "administrator_login_password": ["Aa12345678"], "location": ["East US"], "name": ["terragoat-sqlserver-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}], "version": ["12.0"], "__address__": "azurerm_sql_server.example"}}}, "evaluated_keys": ["state", "resource_type"]}, "code_block": [[9, "resource \"azurerm_sql_server\" \"example\" {\n"], [10, "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n"], [11, "  resource_group_name          = azurerm_resource_group.example.name\n"], [12, "  location                     = azurerm_resource_group.example.location\n"], [13, "  version                      = \"12.0\"\n"], [14, "  administrator_login          = \"ariel\"\n"], [15, "  administrator_login_password = \"Aa12345678\"\n"], [16, "  tags = merge({\n"], [17, "    environment = var.environment\n"], [18, "    terragoat   = \"true\"\n"], [19, "    }, {\n"], [20, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [21, "    git_file             = \"terraform/azure/sql.tf\"\n"], [22, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [23, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [24, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [25, "    git_org              = \"bridgecrewio\"\n"], [26, "    git_repo             = \"terragoat\"\n"], [27, "    yor_trace            = \"e5ec3432-e61f-4244-b59e-9ecc24ddd4cb\"\n"], [28, "  })\n"], [29, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [9, 29], "resource": "azurerm_sql_server.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-vulnerability-assessment-va-is-enabled-on-a-sql-server-by-setting-a-storage-account.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_34", "bc_check_id": null, "check_name": "Ensure Azure SQL server firewall is not overly permissive", "check_result": {"result": "PASSED", "entity": {"azurerm_sql_firewall_rule": {"example": {"__end_line__": 7, "__start_line__": 1, "end_ip_address": ["10.0.17.62"], "name": ["terragoat-firewall-rule-dev"], "resource_group_name": ["terragoat-dev"], "server_name": ["terragoat-sqlserver-dev${random_integer.rnd_int.result}"], "start_ip_address": ["10.0.17.62"], "__address__": "azurerm_sql_firewall_rule.example"}}}, "evaluated_keys": ["start_ip_address", "end_ip_address"]}, "code_block": [[1, "resource \"azurerm_sql_firewall_rule\" \"example\" {\n"], [2, "  name                = \"terragoat-firewall-rule-${var.environment}\"\n"], [3, "  resource_group_name = azurerm_resource_group.example.name\n"], [4, "  server_name         = azurerm_sql_server.example.name\n"], [5, "  start_ip_address    = \"10.0.17.62\"\n"], [6, "  end_ip_address      = \"10.0.17.62\"\n"], [7, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [1, 7], "resource": "azurerm_sql_firewall_rule.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_13", "bc_check_id": "BC_AZR_GENERAL_69", "check_name": "Ensure that sql servers enables data security policy", "check_result": {"result": "PASSED", "entity": {"azurerm_sql_server": {"example": {"__end_line__": 29, "__start_line__": 9, "administrator_login": ["ariel"], "administrator_login_password": ["Aa12345678"], "location": ["East US"], "name": ["terragoat-sqlserver-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}], "version": ["12.0"], "__address__": "azurerm_sql_server.example"}}}, "evaluated_keys": ["state", "resource_type"]}, "code_block": [[9, "resource \"azurerm_sql_server\" \"example\" {\n"], [10, "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n"], [11, "  resource_group_name          = azurerm_resource_group.example.name\n"], [12, "  location                     = azurerm_resource_group.example.location\n"], [13, "  version                      = \"12.0\"\n"], [14, "  administrator_login          = \"ariel\"\n"], [15, "  administrator_login_password = \"Aa12345678\"\n"], [16, "  tags = merge({\n"], [17, "    environment = var.environment\n"], [18, "    terragoat   = \"true\"\n"], [19, "    }, {\n"], [20, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [21, "    git_file             = \"terraform/azure/sql.tf\"\n"], [22, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [23, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [24, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [25, "    git_org              = \"bridgecrewio\"\n"], [26, "    git_repo             = \"terragoat\"\n"], [27, "    yor_trace            = \"e5ec3432-e61f-4244-b59e-9ecc24ddd4cb\"\n"], [28, "  })\n"], [29, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [9, 29], "resource": "azurerm_sql_server.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-sql-servers-enables-data-security-policy.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_6", "bc_check_id": "BC_AZR_GENERAL_79", "check_name": "Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled", "check_result": {"result": "PASSED", "entity": {"azurerm_sql_server": {"example": {"__end_line__": 29, "__start_line__": 9, "administrator_login": ["ariel"], "administrator_login_password": ["Aa12345678"], "location": ["East US"], "name": ["terragoat-sqlserver-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}], "version": ["12.0"], "__address__": "azurerm_sql_server.example"}}}, "evaluated_keys": ["start_ip_address", "end_ip_address", "resource_type"]}, "code_block": [[9, "resource \"azurerm_sql_server\" \"example\" {\n"], [10, "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n"], [11, "  resource_group_name          = azurerm_resource_group.example.name\n"], [12, "  location                     = azurerm_resource_group.example.location\n"], [13, "  version                      = \"12.0\"\n"], [14, "  administrator_login          = \"ariel\"\n"], [15, "  administrator_login_password = \"Aa12345678\"\n"], [16, "  tags = merge({\n"], [17, "    environment = var.environment\n"], [18, "    terragoat   = \"true\"\n"], [19, "    }, {\n"], [20, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [21, "    git_file             = \"terraform/azure/sql.tf\"\n"], [22, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [23, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [24, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [25, "    git_org              = \"bridgecrewio\"\n"], [26, "    git_repo             = \"terragoat\"\n"], [27, "    yor_trace            = \"e5ec3432-e61f-4244-b59e-9ecc24ddd4cb\"\n"], [28, "  })\n"], [29, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [9, 29], "resource": "azurerm_sql_server.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-allow-access-to-azure-services-for-postgresql-database-server-is-disabled.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_GCP_15", "bc_check_id": null, "check_name": "Ensure PostgreSQL database flag 'log_parser_stats' is set to 'off'", "check_result": {"result": "PASSED", "entity": {"google_sql_database_instance": {"master_instance": {"__end_line__": 19, "__start_line__": 1, "database_version": ["POSTGRES_11"], "name": ["terragoat-dev-master"], "region": ["us-central1"], "settings": [{"backup_configuration": [{"enabled": [false]}], "ip_configuration": [{"authorized_networks": [{"name": ["WWW"], "value": ["0.0.0.0/0"]}], "ipv4_enabled": [true]}], "tier": ["db-f1-micro"]}], "__address__": "google_sql_database_instance.master_instance"}}}, "evaluated_keys": ["settings/database_flags[*]", "settings/database_flags[?(@/name == log_parser_stats & @/value == on)]", "database_version"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/big_data.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_57", "bc_check_id": "BC_AWS_S3_2", "check_name": "S3 Bucket has an ACL defined which allows public WRITE access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/permission", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-2-acl-write-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"web_rtb": {"__end_line__": 208, "__start_line__": 193, "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-rtb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "5e4fee6e-a6aa-4b61-a741-47c5efb463e1"}], "vpc_id": ["aws_vpc.web_vpc.id"], "__address__": "aws_route_table.web_rtb"}}}, "evaluated_keys": ["destination_cidr_block", "instance_id", "route/*/instance_id", "route/*/cidr_block"]}, "code_block": [[193, "resource \"aws_route_table\" \"web_rtb\" {\n"], [194, "  vpc_id = aws_vpc.web_vpc.id\n"], [195, "\n"], [196, "  tags = merge({\n"], [197, "    Name = \"${local.resource_prefix.value}-rtb\"\n"], [198, "    }, {\n"], [199, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [200, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [201, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [202, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [203, "    git_modifiers        = \"nimrodkor\"\n"], [204, "    git_org              = \"bridgecrewio\"\n"], [205, "    git_repo             = \"terragoat\"\n"], [206, "    yor_trace            = \"5e4fee6e-a6aa-4b61-a741-47c5efb463e1\"\n"], [207, "  })\n"], [208, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [193, 208], "resource": "aws_route_table.web_rtb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rtb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "5e4fee6e-a6aa-4b61-a741-47c5efb463e1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_35", "bc_check_id": "BC_AWS_NETWORKING_77", "check_name": "AWS NAT Gateways should be utilized for the default route", "check_result": {"result": "PASSED", "entity": {"aws_route": {"public_internet_gateway": {"__end_line__": 228, "__start_line__": 220, "destination_cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.web_igw.id"], "route_table_id": ["aws_route_table.web_rtb.id"], "timeouts": [{"create": ["5m"]}], "__address__": "aws_route.public_internet_gateway"}}}, "evaluated_keys": ["destination_cidr_block", "instance_id", "route/*/instance_id", "route/*/cidr_block"]}, "code_block": [[220, "resource \"aws_route\" \"public_internet_gateway\" {\n"], [221, "  route_table_id         = aws_route_table.web_rtb.id\n"], [222, "  destination_cidr_block = \"0.0.0.0/0\"\n"], [223, "  gateway_id             = aws_internet_gateway.web_igw.id\n"], [224, "\n"], [225, "  timeouts {\n"], [226, "    create = \"5m\"\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [220, 228], "resource": "aws_route.public_internet_gateway", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-nat-gateways-are-utilized-for-the-default-route.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf"}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "PASSED", "entity": {"aws_vpc": {"web_vpc": {"__end_line__": 133, "__start_line__": 117, "cidr_block": ["172.16.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9bf2359b-952e-4570-9595-52eba4c20473"}], "__address__": "aws_vpc.web_vpc"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[117, "resource \"aws_vpc\" \"web_vpc\" {\n"], [118, "  cidr_block           = \"172.16.0.0/16\"\n"], [119, "  enable_dns_hostnames = true\n"], [120, "  enable_dns_support   = true\n"], [121, "  tags = merge({\n"], [122, "    Name = \"${local.resource_prefix.value}-vpc\"\n"], [123, "    }, {\n"], [124, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [125, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [126, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [127, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [128, "    git_modifiers        = \"nimrodkor\"\n"], [129, "    git_org              = \"bridgecrewio\"\n"], [130, "    git_repo             = \"terragoat\"\n"], [131, "    yor_trace            = \"9bf2359b-952e-4570-9595-52eba4c20473\"\n"], [132, "  })\n"], [133, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [117, 133], "resource": "aws_vpc.web_vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9bf2359b-952e-4570-9595-52eba4c20473"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_19", "bc_check_id": "BC_AWS_S3_14", "check_name": "Ensure all data stored in the S3 bucket is securely encrypted at rest", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-14-data-encrypted-at-rest.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": null, "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"policy_attachment-AmazonEKSClusterPolicy": {"__end_line__": 37, "__start_line__": 34, "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKSClusterPolicy"], "role": ["${data.aws_caller_identity.current.account_id}-acme-dev-iam-for-eks"], "__address__": "aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy"}}}, "evaluated_keys": ["policy_arn", "managed_policy_arn", "managed_policy_arns/*", "name", "arn"]}, "code_block": [[34, "resource aws_iam_role_policy_attachment \"policy_attachment-AmazonEKSClusterPolicy\" {\n"], [35, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSClusterPolicy\"\n"], [36, "  role       = aws_iam_role.iam_for_eks.name\n"], [37, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [34, 37], "resource": "aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/eks.tf", "breadcrumbs": {"role": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.iam_for_eks", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_56", "bc_check_id": null, "check_name": "Ensure AWS Managed IAMFullAccess IAM policy is not used.", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy_attachment": {"policy_attachment-AmazonEKSServicePolicy": {"__end_line__": 42, "__start_line__": 39, "policy_arn": ["arn:aws:iam::aws:policy/AmazonEKSServicePolicy"], "role": ["${data.aws_caller_identity.current.account_id}-acme-dev-iam-for-eks"], "__address__": "aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy"}}}, "evaluated_keys": ["policy_arn", "managed_policy_arn", "managed_policy_arns/*", "name", "arn"]}, "code_block": [[39, "resource aws_iam_role_policy_attachment \"policy_attachment-AmazonEKSServicePolicy\" {\n"], [40, "  policy_arn = \"arn:aws:iam::aws:policy/AmazonEKSServicePolicy\"\n"], [41, "  role       = aws_iam_role.iam_for_eks.name\n"], [42, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [39, 42], "resource": "aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/eks.tf", "breadcrumbs": {"role": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_role.iam_for_eks", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-13-enable-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route_table": {"web_rtb": {"__end_line__": 208, "__start_line__": 193, "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-rtb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "5e4fee6e-a6aa-4b61-a741-47c5efb463e1"}], "vpc_id": ["aws_vpc.web_vpc.id"], "__address__": "aws_route_table.web_rtb"}}}, "evaluated_keys": ["route/*/ipv6_cidr_block", "vpc_peering_connection_id", "destination_ipv6_cidr_block", "route/*/vpc_peering_connection_id", "destination_cidr_block", "route/*/cidr_block"]}, "code_block": [[193, "resource \"aws_route_table\" \"web_rtb\" {\n"], [194, "  vpc_id = aws_vpc.web_vpc.id\n"], [195, "\n"], [196, "  tags = merge({\n"], [197, "    Name = \"${local.resource_prefix.value}-rtb\"\n"], [198, "    }, {\n"], [199, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [200, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [201, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [202, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [203, "    git_modifiers        = \"nimrodkor\"\n"], [204, "    git_org              = \"bridgecrewio\"\n"], [205, "    git_repo             = \"terragoat\"\n"], [206, "    yor_trace            = \"5e4fee6e-a6aa-4b61-a741-47c5efb463e1\"\n"], [207, "  })\n"], [208, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [193, 208], "resource": "aws_route_table.web_rtb", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rtb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "5e4fee6e-a6aa-4b61-a741-47c5efb463e1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_44", "bc_check_id": "BC_AWS_NETWORKING_80", "check_name": "Ensure AWS route table with VPC peering does not contain routes overly permissive to all traffic", "check_result": {"result": "PASSED", "entity": {"aws_route": {"public_internet_gateway": {"__end_line__": 228, "__start_line__": 220, "destination_cidr_block": ["0.0.0.0/0"], "gateway_id": ["aws_internet_gateway.web_igw.id"], "route_table_id": ["aws_route_table.web_rtb.id"], "timeouts": [{"create": ["5m"]}], "__address__": "aws_route.public_internet_gateway"}}}, "evaluated_keys": ["route/*/ipv6_cidr_block", "vpc_peering_connection_id", "destination_ipv6_cidr_block", "route/*/vpc_peering_connection_id", "destination_cidr_block", "route/*/cidr_block"]}, "code_block": [[220, "resource \"aws_route\" \"public_internet_gateway\" {\n"], [221, "  route_table_id         = aws_route_table.web_rtb.id\n"], [222, "  destination_cidr_block = \"0.0.0.0/0\"\n"], [223, "  gateway_id             = aws_internet_gateway.web_igw.id\n"], [224, "\n"], [225, "  timeouts {\n"], [226, "    create = \"5m\"\n"], [227, "  }\n"], [228, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [220, 228], "resource": "aws_route.public_internet_gateway", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-route-table-with-vpc-peering-does-not-contain-routes-overly-permissive-to-all-traffic.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf"}, {"check_id": "CKV2_AWS_22", "bc_check_id": "BC_AWS_IAM_67", "check_name": "Ensure an IAM User does not have access to the console", "check_result": {"result": "PASSED", "entity": {"aws_iam_user": {"user": {"__end_line__": 19, "__start_line__": 1, "force_destroy": [true], "name": ["${data.aws_caller_identity.current.account_id}-acme-dev-user"], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-user", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/iam.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9b45b298-c1ea-426a-9644-610780021eaa"}], "__address__": "aws_iam_user.user"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[1, "resource \"aws_iam_user\" \"user\" {\n"], [2, "  name          = \"${local.resource_prefix.value}-user\"\n"], [3, "  force_destroy = true\n"], [4, "\n"], [5, "  tags = merge({\n"], [6, "    Name        = \"${local.resource_prefix.value}-user\"\n"], [7, "    Environment = local.resource_prefix.value\n"], [8, "    }, {\n"], [9, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [10, "    git_file             = \"terraform/aws/iam.tf\"\n"], [11, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [12, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [13, "    git_modifiers        = \"nimrodkor\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"9b45b298-c1ea-426a-9644-610780021eaa\"\n"], [17, "  })\n"], [18, "\n"], [19, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [1, 19], "resource": "aws_iam_user.user", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-user", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/iam.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9b45b298-c1ea-426a-9644-610780021eaa"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-user-does-not-have-access-to-the-console-group.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/iam.tf", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-16-enable-versioning.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-16-enable-versioning.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-16-enable-versioning.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"default": {"__end_line__": 134, "__start_line__": 117, "name": ["${data.aws_caller_identity.current.account_id}-acme-dev-rds-sg"], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"}], "vpc_id": ["aws_vpc.web_vpc.id"], "__address__": "aws_security_group.default"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[117, "resource \"aws_security_group\" \"default\" {\n"], [118, "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"], [119, "  vpc_id = aws_vpc.web_vpc.id\n"], [120, "\n"], [121, "  tags = merge({\n"], [122, "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"], [123, "    Environment = local.resource_prefix.value\n"], [124, "    }, {\n"], [125, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [126, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [127, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [128, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [129, "    git_modifiers        = \"nimrodkor\"\n"], [130, "    git_org              = \"bridgecrewio\"\n"], [131, "    git_repo             = \"terragoat\"\n"], [132, "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"], [133, "  })\n"], [134, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [117, 134], "resource": "aws_security_group.default", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/db-app.tf", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_5", "bc_check_id": "BC_AWS_NETWORKING_51", "check_name": "Ensure that Security Groups are attached to another resource", "check_result": {"result": "PASSED", "entity": {"aws_security_group": {"web-node": {"__end_line__": 115, "__start_line__": 77, "depends_on": [["aws_vpc.web_vpc"]], "description": ["${data.aws_caller_identity.current.account_id}-acme-dev Security Group"], "egress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [0], "protocol": ["-1"], "to_port": [0]}], "ingress": [{"cidr_blocks": [["0.0.0.0/0"]], "from_port": [80], "protocol": ["tcp"], "to_port": [80]}, {"cidr_blocks": [["0.0.0.0/0"]], "from_port": [22], "protocol": ["tcp"], "to_port": [22]}], "name": ["${data.aws_caller_identity.current.account_id}-acme-dev-sg"], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"}], "vpc_id": ["aws_vpc.web_vpc.id"], "__address__": "aws_security_group.web-node"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[77, "resource \"aws_security_group\" \"web-node\" {\n"], [78, "  # security group is open to the world in SSH port\n"], [79, "  name        = \"${local.resource_prefix.value}-sg\"\n"], [80, "  description = \"${local.resource_prefix.value} Security Group\"\n"], [81, "  vpc_id      = aws_vpc.web_vpc.id\n"], [82, "\n"], [83, "  ingress {\n"], [84, "    from_port = 80\n"], [85, "    to_port   = 80\n"], [86, "    protocol  = \"tcp\"\n"], [87, "    cidr_blocks = [\n"], [88, "    \"0.0.0.0/0\"]\n"], [89, "  }\n"], [90, "  ingress {\n"], [91, "    from_port = 22\n"], [92, "    to_port   = 22\n"], [93, "    protocol  = \"tcp\"\n"], [94, "    cidr_blocks = [\n"], [95, "    \"0.0.0.0/0\"]\n"], [96, "  }\n"], [97, "  egress {\n"], [98, "    from_port = 0\n"], [99, "    to_port   = 0\n"], [100, "    protocol  = \"-1\"\n"], [101, "    cidr_blocks = [\n"], [102, "    \"0.0.0.0/0\"]\n"], [103, "  }\n"], [104, "  depends_on = [aws_vpc.web_vpc]\n"], [105, "  tags = {\n"], [106, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [107, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [108, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [109, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [110, "    git_modifiers        = \"nimrodkor\"\n"], [111, "    git_org              = \"bridgecrewio\"\n"], [112, "    git_repo             = \"terragoat\"\n"], [113, "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"], [114, "  }\n"], [115, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [77, 115], "resource": "aws_security_group.web-node", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_20", "bc_check_id": "BC_AWS_S3_1", "check_name": "S3 Bucket has an ACL defined which allows public READ access.", "check_result": {"result": "PASSED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["acl", "resource_type", "access_control_policy", "access_control_policy/grant/*/grantee/uri", "access_control_policy/grant"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-1-acl-read-permissions-everyone.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_41", "bc_check_id": "BC_AWS_IAM_69", "check_name": "Ensure an IAM role is attached to EC2 instance", "check_result": {"result": "PASSED", "entity": {"aws_instance": {"db_app": {"__end_line__": 413, "__start_line__": 243, "ami": ["data.aws_ami.amazon-linux-2.id"], "iam_instance_profile": ["${data.aws_caller_identity.current.account_id}-acme-dev-profile"], "instance_type": ["t2.nano"], "subnet_id": ["aws_subnet.web_subnet.id"], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}], "user_data": [true], "vpc_security_group_ids": [["aws_security_group.web-node.id"]], "resource_type": ["aws_instance"], "__address__": "aws_instance.db_app"}}}, "evaluated_keys": ["iam_instance_profile"]}, "code_block": [[243, "resource \"aws_instance\" \"db_app\" {\n"], [244, "  # ec2 have plain text secrets in user data\n"], [245, "  ami                  = data.aws_ami.amazon-linux-2.id\n"], [246, "  instance_type        = \"t2.nano\"\n"], [247, "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"], [248, "\n"], [249, "  vpc_security_group_ids = [\n"], [250, "  \"${aws_security_group.web-node.id}\"]\n"], [251, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [252, "  user_data = <<EOF\n"], [253, "#! /bin/bash\n"], [254, "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"], [255, "sudo yum -y update\n"], [256, "sudo yum -y install httpd php php-mysqlnd\n"], [257, "sudo systemctl enable httpd \n"], [258, "sudo systemctl start httpd\n"], [259, "\n"], [260, "sudo mkdir /var/www/inc\n"], [261, "cat << EnD > /tmp/dbinfo.inc\n"], [262, "<?php\n"], [263, "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"], [264, "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"], [265, "define('DB_PASSWORD', '${var.password}');\n"], [266, "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"], [267, "?>\n"], [268, "EnD\n"], [269, "sudo mv /tmp/dbinfo.inc /var/www/inc \n"], [270, "sudo chown root:root /var/www/inc/dbinfo.inc\n"], [271, "\n"], [272, "cat << EnD > /tmp/index.php\n"], [273, "<?php include \"../inc/dbinfo.inc\"; ?>\n"], [274, "<html>\n"], [275, "<body>\n"], [276, "<h1>Sample page</h1>\n"], [277, "<?php\n"], [278, "\n"], [279, "  /* Connect to MySQL and select the database. */\n"], [280, "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"], [281, "\n"], [282, "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"], [283, "\n"], [284, "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"], [285, "\n"], [286, "  /* Ensure that the EMPLOYEES table exists. */\n"], [287, "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"], [288, "\n"], [289, "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"], [290, "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"], [291, "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"], [292, "\n"], [293, "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"], [294, "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"], [295, "  }\n"], [296, "?>\n"], [297, "\n"], [298, "<!-- Input form -->\n"], [299, "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"], [300, "  <table border=\"0\">\n"], [301, "    <tr>\n"], [302, "      <td>NAME</td>\n"], [303, "      <td>ADDRESS</td>\n"], [304, "    </tr>\n"], [305, "    <tr>\n"], [306, "      <td>\n"], [307, "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"], [308, "      </td>\n"], [309, "      <td>\n"], [310, "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"], [311, "      </td>\n"], [312, "      <td>\n"], [313, "        <input type=\"submit\" value=\"Add Data\" />\n"], [314, "      </td>\n"], [315, "    </tr>\n"], [316, "  </table>\n"], [317, "</form>\n"], [318, "\n"], [319, "<!-- Display table data. -->\n"], [320, "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"], [321, "  <tr>\n"], [322, "    <td>ID</td>\n"], [323, "    <td>NAME</td>\n"], [324, "    <td>ADDRESS</td>\n"], [325, "  </tr>\n"], [326, "\n"], [327, "<?php\n"], [328, "\n"], [329, "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"], [330, "\n"], [331, "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"], [332, "  echo \"<tr>\";\n"], [333, "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"], [334, "       \"<td>\",\\$query_data[1], \"</td>\",\n"], [335, "       \"<td>\",\\$query_data[2], \"</td>\";\n"], [336, "  echo \"</tr>\";\n"], [337, "}\n"], [338, "?>\n"], [339, "\n"], [340, "</table>\n"], [341, "\n"], [342, "<!-- Clean up. -->\n"], [343, "<?php\n"], [344, "\n"], [345, "  mysqli_free_result(\\$result);\n"], [346, "  mysqli_close(\\$connection);\n"], [347, "\n"], [348, "?>\n"], [349, "\n"], [350, "</body>\n"], [351, "</html>\n"], [352, "\n"], [353, "\n"], [354, "<?php\n"], [355, "\n"], [356, "/* Add an employee to the table. */\n"], [357, "function AddEmployee(\\$connection, \\$name, \\$address) {\n"], [358, "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"], [359, "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"], [360, "\n"], [361, "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"], [362, "\n"], [363, "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"], [364, "}\n"], [365, "\n"], [366, "/* Check whether the table exists and, if not, create it. */\n"], [367, "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"], [368, "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"], [369, "  {\n"], [370, "     \\$query = \"CREATE TABLE EMPLOYEES (\n"], [371, "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"], [372, "         NAME VARCHAR(45),\n"], [373, "         ADDRESS VARCHAR(90)\n"], [374, "       )\";\n"], [375, "\n"], [376, "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"], [377, "  }\n"], [378, "}\n"], [379, "\n"], [380, "/* Check for the existence of a table. */\n"], [381, "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"], [382, "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"], [383, "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"], [384, "\n"], [385, "  \\$checktable = mysqli_query(\\$connection,\n"], [386, "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"], [387, "\n"], [388, "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"], [389, "\n"], [390, "  return false;\n"], [391, "}\n"], [392, "?>               \n"], [393, "EnD\n"], [394, "\n"], [395, "sudo mv /tmp/index.php /var/www/html\n"], [396, "sudo chown root:root /var/www/html/index.php\n"], [397, "\n"], [398, "\n"], [399, "\n"], [400, "EOF\n"], [401, "  tags = merge({\n"], [402, "    Name = \"${local.resource_prefix.value}-dbapp\"\n"], [403, "    }, {\n"], [404, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [405, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [406, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [407, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [408, "    git_modifiers        = \"nimrodkor\"\n"], [409, "    git_org              = \"bridgecrewio\"\n"], [410, "    git_repo             = \"terragoat\"\n"], [411, "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"], [412, "  })\n"], [413, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [243, 413], "resource": "aws_instance.db_app", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/db-app.tf", "breadcrumbs": {"user_data": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "iam_instance_profile": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ec2profile", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_role_policy": {"ec2policy": {"__end_line__": 226, "__start_line__": 206, "name": ["${data.aws_caller_identity.current.account_id}-acme-dev-policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["s3:*", "ec2:*", "rds:*"], "Effect": "Allow", "Resource": "*"}]}], "role": ["aws_iam_role.ec2role.id"], "__address__": "aws_iam_role_policy.ec2policy"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/db-app.tf", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"iam_policy_eks": {"__end_line__": 16, "__start_line__": 7, "statement": [{"actions": [["sts:AssumeRole"]], "effect": ["Allow"], "principals": [{"identifiers": [["eks.amazonaws.com"]], "type": ["Service"]}]}], "__address__": "aws_iam_policy_document.iam_policy_eks"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[7, "data aws_iam_policy_document \"iam_policy_eks\" {\n"], [8, "  statement {\n"], [9, "    effect  = \"Allow\"\n"], [10, "    actions = [\"sts:AssumeRole\"]\n"], [11, "    principals {\n"], [12, "      type        = \"Service\"\n"], [13, "      identifiers = [\"eks.amazonaws.com\"]\n"], [14, "    }\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [7, 16], "resource": "aws_iam_policy_document.iam_policy_eks", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/eks.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_policy_document": {"policy": {"__end_line__": 39, "__start_line__": 30, "statement": [{"actions": [["es:*"]], "principals": [{"identifiers": [["*"]], "type": ["AWS"]}], "resources": [["*"]]}], "__address__": "aws_iam_policy_document.policy"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/es.tf"}, {"check_id": "CKV2_AWS_40", "bc_check_id": null, "check_name": "Ensure AWS IAM policy does not allow full IAM privileges", "check_result": {"result": "PASSED", "entity": {"aws_iam_user_policy": {"userpolicy": {"__end_line__": 46, "__start_line__": 25, "name": ["excess_policy"], "policy": [{"Version": "2012-10-17", "Statement": [{"Action": ["ec2:*", "s3:*", "lambda:*", "cloudwatch:*"], "Effect": "Allow", "Resource": "*"}]}], "user": ["${data.aws_caller_identity.current.account_id}-acme-dev-user"], "__address__": "aws_iam_user_policy.userpolicy"}}}, "evaluated_keys": ["statement[?(@/effect == Allow)]/actions[*]", "policy/Statement[?(@/Effect == Allow)]/Action[*]", "inline_policy/Statement[?(@/Effect == Allow)]/Action[*]"]}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/iam.tf", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}], "failed_checks": [{"check_id": "CKV_ALI_11", "bc_check_id": "BC_ALI_GENERAL_1", "check_name": "Ensure OSS bucket has transfer Acceleration enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["transfer_acceleration/[0]/enabled"]}, "code_block": [[1, "resource \"alicloud_oss_bucket\" \"bad_bucket\" {\n"], [2, "  # Public and writeable bucket \n"], [3, "  # Versioning isn't enabled\n"], [4, "  # Not Encrypted with a Customer Master Key and no Server side encryption\n"], [5, "  # Doesn't have access logging enabled\" \n"], [6, "  bucket = \"wildwestfreeforall\"\n"], [7, "  acl    = \"public-read-write\"\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"9c114f23d311f787c137723e1f71b27a52f0adec\"\n"], [10, "    git_file             = \"terraform/alicloud/bucket.tf\"\n"], [11, "    git_last_modified_at = \"2022-04-05 15:17:55\"\n"], [12, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [13, "    git_modifiers        = \"james.woolfenden\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"80373049-248d-4f5e-9d25-740c3e80f2b9\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/alicloud/bucket.tf", "file_abs_path": "/terraform/terraform/alicloud/bucket.tf", "repo_file_path": "/terraform/alicloud/bucket.tf", "file_line_range": [1, 18], "resource": "alicloud_oss_bucket.bad_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketTransferAcceleration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_12", "bc_check_id": "BC_ALI_LOGGING_2", "check_name": "Ensure the OSS bucket has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["logging"]}, "code_block": [[1, "resource \"alicloud_oss_bucket\" \"bad_bucket\" {\n"], [2, "  # Public and writeable bucket \n"], [3, "  # Versioning isn't enabled\n"], [4, "  # Not Encrypted with a Customer Master Key and no Server side encryption\n"], [5, "  # Doesn't have access logging enabled\" \n"], [6, "  bucket = \"wildwestfreeforall\"\n"], [7, "  acl    = \"public-read-write\"\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"9c114f23d311f787c137723e1f71b27a52f0adec\"\n"], [10, "    git_file             = \"terraform/alicloud/bucket.tf\"\n"], [11, "    git_last_modified_at = \"2022-04-05 15:17:55\"\n"], [12, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [13, "    git_modifiers        = \"james.woolfenden\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"80373049-248d-4f5e-9d25-740c3e80f2b9\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/alicloud/bucket.tf", "file_abs_path": "/terraform/terraform/alicloud/bucket.tf", "repo_file_path": "/terraform/alicloud/bucket.tf", "file_line_range": [1, 18], "resource": "alicloud_oss_bucket.bad_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketAccessLogs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-logging-policies/ensure-alibaba-cloud-oss-bucket-has-access-logging-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_6", "bc_check_id": "BC_ALI_GENERAL_2", "check_name": "Ensure OSS bucket is encrypted with Customer Master Key", "check_result": {"result": "FAILED", "evaluated_keys": ["server_side_encryption_rule/[0]/kms_master_key_id"]}, "code_block": [[1, "resource \"alicloud_oss_bucket\" \"bad_bucket\" {\n"], [2, "  # Public and writeable bucket \n"], [3, "  # Versioning isn't enabled\n"], [4, "  # Not Encrypted with a Customer Master Key and no Server side encryption\n"], [5, "  # Doesn't have access logging enabled\" \n"], [6, "  bucket = \"wildwestfreeforall\"\n"], [7, "  acl    = \"public-read-write\"\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"9c114f23d311f787c137723e1f71b27a52f0adec\"\n"], [10, "    git_file             = \"terraform/alicloud/bucket.tf\"\n"], [11, "    git_last_modified_at = \"2022-04-05 15:17:55\"\n"], [12, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [13, "    git_modifiers        = \"james.woolfenden\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"80373049-248d-4f5e-9d25-740c3e80f2b9\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/alicloud/bucket.tf", "file_abs_path": "/terraform/terraform/alicloud/bucket.tf", "repo_file_path": "/terraform/alicloud/bucket.tf", "file_line_range": [1, 18], "resource": "alicloud_oss_bucket.bad_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketEncryptedWithCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-is-encrypted-with-customer-master-key.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_10", "bc_check_id": "BC_ALI_GENERAL_3", "check_name": "Ensure OSS bucket has versioning enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["versioning/[0]/status"]}, "code_block": [[1, "resource \"alicloud_oss_bucket\" \"bad_bucket\" {\n"], [2, "  # Public and writeable bucket \n"], [3, "  # Versioning isn't enabled\n"], [4, "  # Not Encrypted with a Customer Master Key and no Server side encryption\n"], [5, "  # Doesn't have access logging enabled\" \n"], [6, "  bucket = \"wildwestfreeforall\"\n"], [7, "  acl    = \"public-read-write\"\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"9c114f23d311f787c137723e1f71b27a52f0adec\"\n"], [10, "    git_file             = \"terraform/alicloud/bucket.tf\"\n"], [11, "    git_last_modified_at = \"2022-04-05 15:17:55\"\n"], [12, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [13, "    git_modifiers        = \"james.woolfenden\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"80373049-248d-4f5e-9d25-740c3e80f2b9\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/alicloud/bucket.tf", "file_abs_path": "/terraform/terraform/alicloud/bucket.tf", "repo_file_path": "/terraform/alicloud/bucket.tf", "file_line_range": [1, 18], "resource": "alicloud_oss_bucket.bad_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketVersioning", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-has-versioning-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_1", "bc_check_id": "BC_ALI_GENERAL_5", "check_name": "Alibaba Cloud OSS bucket accessible to public", "check_result": {"result": "FAILED", "evaluated_keys": ["acl"]}, "code_block": [[1, "resource \"alicloud_oss_bucket\" \"bad_bucket\" {\n"], [2, "  # Public and writeable bucket \n"], [3, "  # Versioning isn't enabled\n"], [4, "  # Not Encrypted with a Customer Master Key and no Server side encryption\n"], [5, "  # Doesn't have access logging enabled\" \n"], [6, "  bucket = \"wildwestfreeforall\"\n"], [7, "  acl    = \"public-read-write\"\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"9c114f23d311f787c137723e1f71b27a52f0adec\"\n"], [10, "    git_file             = \"terraform/alicloud/bucket.tf\"\n"], [11, "    git_last_modified_at = \"2022-04-05 15:17:55\"\n"], [12, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [13, "    git_modifiers        = \"james.woolfenden\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"80373049-248d-4f5e-9d25-740c3e80f2b9\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/alicloud/bucket.tf", "file_abs_path": "/terraform/terraform/alicloud/bucket.tf", "repo_file_path": "/terraform/alicloud/bucket.tf", "file_line_range": [1, 18], "resource": "alicloud_oss_bucket.bad_bucket", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketPublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-is-not-accessible-to-public.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_25", "bc_check_id": "BC_ALI_LOGGING_3", "check_name": "Ensure RDS Instance SQL Collector Retention Period should be greater than 180", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSRetention", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-logging-policies/ensure-alibaba-cloud-rds-instance-sql-collector-retention-period-should-be-greater-than-180.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_30", "bc_check_id": "BC_ALI_GENERAL_10", "check_name": "Ensure RDS instance auto upgrades for minor versions", "check_result": {"result": "FAILED", "evaluated_keys": ["auto_upgrade_minor_version"]}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSInstanceAutoUpgrade", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-rds-instance-is-set-to-perform-auto-upgrades-for-minor-versions.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_9", "bc_check_id": "BC_ALI_GENERAL_7", "check_name": "Ensure database instance is not public", "check_result": {"result": "FAILED", "evaluated_keys": ["security_ips"]}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSIsPublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-database-instance-is-not-public.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_20", "bc_check_id": "BC_ALI_NETWORKING_3", "check_name": "Ensure RDS instance uses SSL", "check_result": {"result": "FAILED", "evaluated_keys": ["ssl_action"]}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSInstanceSSL", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-networking-policies/ensure-alibaba-cloud-rds-instance-uses-ssl.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_36", "bc_check_id": "BC_ALI_GENERAL_13", "check_name": "Ensure RDS instance has log_disconnections enabled", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSInstanceLogDisconnections", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-rds-instance-has-log-disconnections-enabled-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_37", "bc_check_id": "BC_ALI_GENERAL_16", "check_name": "Ensure RDS instance has log_connections enabled", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSInstanceLogConnections", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-rds-instance-has-log-connections-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_35", "bc_check_id": "BC_ALI_GENERAL_11", "check_name": "Ensure RDS instance has log_duration enabled", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"alicloud_db_instance\" \"seeme\" {\n"], [2, "  # Is public due to Security IPS 0.0.0.0/0\n"], [3, "  engine           = \"MySQL\"\n"], [4, "  engine_version   = \"5.6\"\n"], [5, "  instance_type    = \"rds.mysql.t1.small\"\n"], [6, "  instance_storage = \"10\"\n"], [7, "  tde_status       = \"Enabled\"\n"], [8, "  security_ips = [\n"], [9, "    \"0.0.0.0\",\n"], [10, "    \"10.23.12.24/24\"\n"], [11, "  ]\n"], [12, "  parameters {\n"], [13, "    name  = \"innodb_large_prefix\"\n"], [14, "    value = \"ON\"\n"], [15, "  }\n"], [16, "  parameters {\n"], [17, "    name  = \"connect_timeout\"\n"], [18, "    value = \"50\"\n"], [19, "  }\n"], [20, "  tags = {\n"], [21, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [22, "    git_file             = \"terraform/alicloud/rds.tf\"\n"], [23, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [24, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [25, "    git_modifiers        = \"james.woolfenden\"\n"], [26, "    git_org              = \"bridgecrewio\"\n"], [27, "    git_repo             = \"terragoat\"\n"], [28, "    yor_trace            = \"7bd1394e-0a79-4288-8f83-5abcca5bf1ba\"\n"], [29, "  }\n"], [30, "}\n"]], "file_path": "/terraform/alicloud/rds.tf", "file_abs_path": "/terraform/terraform/alicloud/rds.tf", "repo_file_path": "/terraform/alicloud/rds.tf", "file_line_range": [1, 30], "resource": "alicloud_db_instance.seeme", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.RDSInstanceLogsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-rds-instance-has-log-duration-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_5", "bc_check_id": "BC_ALI_LOGGING_5", "check_name": "Ensure Action Trail Logging for all events", "check_result": {"result": "FAILED", "evaluated_keys": ["event_rw"]}, "code_block": [[1, "resource \"alicloud_actiontrail_trail\" \"fail\" {\n"], [2, "  # Action Trail not Logging for all regions\n"], [3, "  # Action Trail not Logging for all events\n"], [4, "  trail_name         = \"action-trail\"\n"], [5, "  oss_write_role_arn = alicloud_ram_role.trail.arn\n"], [6, "  oss_bucket_name    = alicloud_oss_bucket.trail.bucket\n"], [7, "  event_rw           = \"Read\"\n"], [8, "  trail_region       = \"cn-hangzhou\"\n"], [9, "}\n"]], "file_path": "/terraform/alicloud/trail.tf", "file_abs_path": "/terraform/terraform/alicloud/trail.tf", "repo_file_path": "/terraform/alicloud/trail.tf", "file_line_range": [1, 9], "resource": "alicloud_actiontrail_trail.fail", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.ActionTrailLogAllEvents", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-logging-policies/ensure-alibaba-cloud-action-trail-logging-for-all-events.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/trail.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_4", "bc_check_id": "BC_ALI_LOGGING_4", "check_name": "Ensure Action Trail Logging for all regions", "check_result": {"result": "FAILED", "evaluated_keys": ["trail_region"]}, "code_block": [[1, "resource \"alicloud_actiontrail_trail\" \"fail\" {\n"], [2, "  # Action Trail not Logging for all regions\n"], [3, "  # Action Trail not Logging for all events\n"], [4, "  trail_name         = \"action-trail\"\n"], [5, "  oss_write_role_arn = alicloud_ram_role.trail.arn\n"], [6, "  oss_bucket_name    = alicloud_oss_bucket.trail.bucket\n"], [7, "  event_rw           = \"Read\"\n"], [8, "  trail_region       = \"cn-hangzhou\"\n"], [9, "}\n"]], "file_path": "/terraform/alicloud/trail.tf", "file_abs_path": "/terraform/terraform/alicloud/trail.tf", "repo_file_path": "/terraform/alicloud/trail.tf", "file_line_range": [1, 9], "resource": "alicloud_actiontrail_trail.fail", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.ActionTrailLogAllRegions", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-logging-policies/ensure-alibaba-cloud-action-trail-logging-for-all-regions.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/trail.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_11", "bc_check_id": "BC_ALI_GENERAL_1", "check_name": "Ensure OSS bucket has transfer Acceleration enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["transfer_acceleration/[0]/enabled"]}, "code_block": [[11, "resource \"alicloud_oss_bucket\" \"trail\" {\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [15, "    git_file             = \"terraform/alicloud/trail.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"9ce7077b-8195-4e71-aec6-ed1f769555dc\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/alicloud/trail.tf", "file_abs_path": "/terraform/terraform/alicloud/trail.tf", "repo_file_path": "/terraform/alicloud/trail.tf", "file_line_range": [11, 23], "resource": "alicloud_oss_bucket.trail", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketTransferAcceleration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-has-transfer-acceleration-disabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/trail.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_12", "bc_check_id": "BC_ALI_LOGGING_2", "check_name": "Ensure the OSS bucket has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["logging"]}, "code_block": [[11, "resource \"alicloud_oss_bucket\" \"trail\" {\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [15, "    git_file             = \"terraform/alicloud/trail.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"9ce7077b-8195-4e71-aec6-ed1f769555dc\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/alicloud/trail.tf", "file_abs_path": "/terraform/terraform/alicloud/trail.tf", "repo_file_path": "/terraform/alicloud/trail.tf", "file_line_range": [11, 23], "resource": "alicloud_oss_bucket.trail", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketAccessLogs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-logging-policies/ensure-alibaba-cloud-oss-bucket-has-access-logging-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/trail.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_6", "bc_check_id": "BC_ALI_GENERAL_2", "check_name": "Ensure OSS bucket is encrypted with Customer Master Key", "check_result": {"result": "FAILED", "evaluated_keys": ["server_side_encryption_rule/[0]/kms_master_key_id"]}, "code_block": [[11, "resource \"alicloud_oss_bucket\" \"trail\" {\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [15, "    git_file             = \"terraform/alicloud/trail.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"9ce7077b-8195-4e71-aec6-ed1f769555dc\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/alicloud/trail.tf", "file_abs_path": "/terraform/terraform/alicloud/trail.tf", "repo_file_path": "/terraform/alicloud/trail.tf", "file_line_range": [11, 23], "resource": "alicloud_oss_bucket.trail", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketEncryptedWithCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-is-encrypted-with-customer-master-key.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/trail.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_ALI_10", "bc_check_id": "BC_ALI_GENERAL_3", "check_name": "Ensure OSS bucket has versioning enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["versioning/[0]/status"]}, "code_block": [[11, "resource \"alicloud_oss_bucket\" \"trail\" {\n"], [12, "\n"], [13, "  tags = {\n"], [14, "    git_commit           = \"c2ff052009d49c65e6af551eb1506abc73b5976c\"\n"], [15, "    git_file             = \"terraform/alicloud/trail.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-05 15:14:28\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"9ce7077b-8195-4e71-aec6-ed1f769555dc\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/alicloud/trail.tf", "file_abs_path": "/terraform/terraform/alicloud/trail.tf", "repo_file_path": "/terraform/alicloud/trail.tf", "file_line_range": [11, 23], "resource": "alicloud_oss_bucket.trail", "evaluations": null, "check_class": "checkov.terraform.checks.resource.alicloud.OSSBucketVersioning", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/alibaba-policies/alibaba-general-policies/ensure-alibaba-cloud-oss-bucket-has-versioning-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/alicloud/trail.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_129", "bc_check_id": "BC_AWS_IAM_60", "check_name": "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceLogging", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_354", "bc_check_id": null, "check_name": "Ensure RDS Performance Insights are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["performance_insights_kms_key_id"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerfInsightsEncryptionWithCMK", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_16", "bc_check_id": "BC_AWS_GENERAL_4", "check_name": "Ensure all data stored in the RDS is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEncryption", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "FAILED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_157", "bc_check_id": "BC_AWS_GENERAL_73", "check_name": "Ensure that RDS instances have Multi-AZ enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["multi_az"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSMultiAZEnabled", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-73.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_293", "bc_check_id": null, "check_name": "Ensure that AWS database instances have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstanceDeletionProtection", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_226", "bc_check_id": "BC_AWS_GENERAL_121", "check_name": "Ensure DB instance gets all minor upgrades automatically", "check_result": {"result": "FAILED", "evaluated_keys": ["auto_minor_version_upgrade"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceMinorUpgrade", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_17", "bc_check_id": "BC_AWS_PUBLIC_2", "check_name": "Ensure all data stored in RDS is not publicly accessible", "check_result": {"result": "FAILED", "evaluated_keys": ["publicly_accessible"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSPubliclyAccessible", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/public-policies/public-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_118", "bc_check_id": "BC_AWS_LOGGING_28", "check_name": "Ensure that enhanced monitoring is enabled for Amazon RDS instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring_interval"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSEnhancedMonitorEnabled", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_353", "bc_check_id": null, "check_name": "Ensure that RDS instances have performance insights enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["performance_insights_enabled"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSInstancePerformanceInsights", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_161", "bc_check_id": "BC_AWS_IAM_65", "check_name": "Ensure RDS database has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSIAMAuthentication", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[117, "resource \"aws_security_group\" \"default\" {\n"], [118, "  name   = \"${local.resource_prefix.value}-rds-sg\"\n"], [119, "  vpc_id = aws_vpc.web_vpc.id\n"], [120, "\n"], [121, "  tags = merge({\n"], [122, "    Name        = \"${local.resource_prefix.value}-rds-sg\"\n"], [123, "    Environment = local.resource_prefix.value\n"], [124, "    }, {\n"], [125, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [126, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [127, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [128, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [129, "    git_modifiers        = \"nimrodkor\"\n"], [130, "    git_org              = \"bridgecrewio\"\n"], [131, "    git_repo             = \"terragoat\"\n"], [132, "    yor_trace            = \"7b251090-8ac1-4290-bd2e-bf3e16126430\"\n"], [133, "  })\n"], [134, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [117, 134], "resource": "aws_security_group.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds-sg", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7b251090-8ac1-4290-bd2e-bf3e16126430"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-31.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[136, "resource \"aws_security_group_rule\" \"ingress\" {\n"], [137, "  type              = \"ingress\"\n"], [138, "  from_port         = \"3306\"\n"], [139, "  to_port           = \"3306\"\n"], [140, "  protocol          = \"tcp\"\n"], [141, "  cidr_blocks       = [\"${aws_vpc.web_vpc.cidr_block}\"]\n"], [142, "  security_group_id = aws_security_group.default.id\n"], [143, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [136, 143], "resource": "aws_security_group_rule.ingress", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-31.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cidr_blocks": [{"type": "resource", "name": "aws_vpc.web_vpc", "path": "/terraform/terraform/aws/ec2.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[145, "resource \"aws_security_group_rule\" \"egress\" {\n"], [146, "  type              = \"egress\"\n"], [147, "  from_port         = 0\n"], [148, "  to_port           = 0\n"], [149, "  protocol          = \"-1\"\n"], [150, "  cidr_blocks       = [\"0.0.0.0/0\"]\n"], [151, "  security_group_id = \"${aws_security_group.default.id}\"\n"], [152, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [145, 152], "resource": "aws_security_group_rule.egress", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-31.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_287", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_290", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_288", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_355", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_289", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[206, "resource \"aws_iam_role_policy\" \"ec2policy\" {\n"], [207, "  name = \"${local.resource_prefix.value}-policy\"\n"], [208, "  role = aws_iam_role.ec2role.id\n"], [209, "\n"], [210, "  policy = <<EOF\n"], [211, "{\n"], [212, "  \"Version\": \"2012-10-17\",\n"], [213, "  \"Statement\": [\n"], [214, "    {\n"], [215, "      \"Action\": [\n"], [216, "        \"s3:*\",\n"], [217, "        \"ec2:*\",\n"], [218, "        \"rds:*\"\n"], [219, "      ],\n"], [220, "      \"Effect\": \"Allow\",\n"], [221, "      \"Resource\": \"*\"\n"], [222, "    }\n"], [223, "  ]\n"], [224, "}\n"], [225, "EOF\n"], [226, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [206, 226], "resource": "aws_iam_role_policy.ec2policy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_126", "bc_check_id": "BC_AWS_LOGGING_26", "check_name": "Ensure that detailed monitoring is enabled for EC2 instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring"]}, "code_block": [[243, "resource \"aws_instance\" \"db_app\" {\n"], [244, "  # ec2 have plain text secrets in user data\n"], [245, "  ami                  = data.aws_ami.amazon-linux-2.id\n"], [246, "  instance_type        = \"t2.nano\"\n"], [247, "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"], [248, "\n"], [249, "  vpc_security_group_ids = [\n"], [250, "  \"${aws_security_group.web-node.id}\"]\n"], [251, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [252, "  user_data = <<EOF\n"], [253, "#! /bin/bash\n"], [254, "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"], [255, "sudo yum -y update\n"], [256, "sudo yum -y install httpd php php-mysqlnd\n"], [257, "sudo systemctl enable httpd \n"], [258, "sudo systemctl start httpd\n"], [259, "\n"], [260, "sudo mkdir /var/www/inc\n"], [261, "cat << EnD > /tmp/dbinfo.inc\n"], [262, "<?php\n"], [263, "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"], [264, "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"], [265, "define('DB_PASSWORD', '${var.password}');\n"], [266, "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"], [267, "?>\n"], [268, "EnD\n"], [269, "sudo mv /tmp/dbinfo.inc /var/www/inc \n"], [270, "sudo chown root:root /var/www/inc/dbinfo.inc\n"], [271, "\n"], [272, "cat << EnD > /tmp/index.php\n"], [273, "<?php include \"../inc/dbinfo.inc\"; ?>\n"], [274, "<html>\n"], [275, "<body>\n"], [276, "<h1>Sample page</h1>\n"], [277, "<?php\n"], [278, "\n"], [279, "  /* Connect to MySQL and select the database. */\n"], [280, "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"], [281, "\n"], [282, "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"], [283, "\n"], [284, "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"], [285, "\n"], [286, "  /* Ensure that the EMPLOYEES table exists. */\n"], [287, "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"], [288, "\n"], [289, "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"], [290, "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"], [291, "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"], [292, "\n"], [293, "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"], [294, "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"], [295, "  }\n"], [296, "?>\n"], [297, "\n"], [298, "<!-- Input form -->\n"], [299, "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"], [300, "  <table border=\"0\">\n"], [301, "    <tr>\n"], [302, "      <td>NAME</td>\n"], [303, "      <td>ADDRESS</td>\n"], [304, "    </tr>\n"], [305, "    <tr>\n"], [306, "      <td>\n"], [307, "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"], [308, "      </td>\n"], [309, "      <td>\n"], [310, "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"], [311, "      </td>\n"], [312, "      <td>\n"], [313, "        <input type=\"submit\" value=\"Add Data\" />\n"], [314, "      </td>\n"], [315, "    </tr>\n"], [316, "  </table>\n"], [317, "</form>\n"], [318, "\n"], [319, "<!-- Display table data. -->\n"], [320, "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"], [321, "  <tr>\n"], [322, "    <td>ID</td>\n"], [323, "    <td>NAME</td>\n"], [324, "    <td>ADDRESS</td>\n"], [325, "  </tr>\n"], [326, "\n"], [327, "<?php\n"], [328, "\n"], [329, "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"], [330, "\n"], [331, "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"], [332, "  echo \"<tr>\";\n"], [333, "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"], [334, "       \"<td>\",\\$query_data[1], \"</td>\",\n"], [335, "       \"<td>\",\\$query_data[2], \"</td>\";\n"], [336, "  echo \"</tr>\";\n"], [337, "}\n"], [338, "?>\n"], [339, "\n"], [340, "</table>\n"], [341, "\n"], [342, "<!-- Clean up. -->\n"], [343, "<?php\n"], [344, "\n"], [345, "  mysqli_free_result(\\$result);\n"], [346, "  mysqli_close(\\$connection);\n"], [347, "\n"], [348, "?>\n"], [349, "\n"], [350, "</body>\n"], [351, "</html>\n"], [352, "\n"], [353, "\n"], [354, "<?php\n"], [355, "\n"], [356, "/* Add an employee to the table. */\n"], [357, "function AddEmployee(\\$connection, \\$name, \\$address) {\n"], [358, "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"], [359, "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"], [360, "\n"], [361, "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"], [362, "\n"], [363, "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"], [364, "}\n"], [365, "\n"], [366, "/* Check whether the table exists and, if not, create it. */\n"], [367, "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"], [368, "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"], [369, "  {\n"], [370, "     \\$query = \"CREATE TABLE EMPLOYEES (\n"], [371, "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"], [372, "         NAME VARCHAR(45),\n"], [373, "         ADDRESS VARCHAR(90)\n"], [374, "       )\";\n"], [375, "\n"], [376, "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"], [377, "  }\n"], [378, "}\n"], [379, "\n"], [380, "/* Check for the existence of a table. */\n"], [381, "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"], [382, "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"], [383, "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"], [384, "\n"], [385, "  \\$checktable = mysqli_query(\\$connection,\n"], [386, "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"], [387, "\n"], [388, "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"], [389, "\n"], [390, "  return false;\n"], [391, "}\n"], [392, "?>               \n"], [393, "EnD\n"], [394, "\n"], [395, "sudo mv /tmp/index.php /var/www/html\n"], [396, "sudo chown root:root /var/www/html/index.php\n"], [397, "\n"], [398, "\n"], [399, "\n"], [400, "EOF\n"], [401, "  tags = merge({\n"], [402, "    Name = \"${local.resource_prefix.value}-dbapp\"\n"], [403, "    }, {\n"], [404, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [405, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [406, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [407, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [408, "    git_modifiers        = \"nimrodkor\"\n"], [409, "    git_org              = \"bridgecrewio\"\n"], [410, "    git_repo             = \"terragoat\"\n"], [411, "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"], [412, "  })\n"], [413, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [243, 413], "resource": "aws_instance.db_app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user_data": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "iam_instance_profile": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ec2profile", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_135", "bc_check_id": "BC_AWS_GENERAL_68", "check_name": "Ensure that EC2 is EBS optimized", "check_result": {"result": "FAILED", "evaluated_keys": ["ebs_optimized"]}, "code_block": [[243, "resource \"aws_instance\" \"db_app\" {\n"], [244, "  # ec2 have plain text secrets in user data\n"], [245, "  ami                  = data.aws_ami.amazon-linux-2.id\n"], [246, "  instance_type        = \"t2.nano\"\n"], [247, "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"], [248, "\n"], [249, "  vpc_security_group_ids = [\n"], [250, "  \"${aws_security_group.web-node.id}\"]\n"], [251, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [252, "  user_data = <<EOF\n"], [253, "#! /bin/bash\n"], [254, "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"], [255, "sudo yum -y update\n"], [256, "sudo yum -y install httpd php php-mysqlnd\n"], [257, "sudo systemctl enable httpd \n"], [258, "sudo systemctl start httpd\n"], [259, "\n"], [260, "sudo mkdir /var/www/inc\n"], [261, "cat << EnD > /tmp/dbinfo.inc\n"], [262, "<?php\n"], [263, "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"], [264, "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"], [265, "define('DB_PASSWORD', '${var.password}');\n"], [266, "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"], [267, "?>\n"], [268, "EnD\n"], [269, "sudo mv /tmp/dbinfo.inc /var/www/inc \n"], [270, "sudo chown root:root /var/www/inc/dbinfo.inc\n"], [271, "\n"], [272, "cat << EnD > /tmp/index.php\n"], [273, "<?php include \"../inc/dbinfo.inc\"; ?>\n"], [274, "<html>\n"], [275, "<body>\n"], [276, "<h1>Sample page</h1>\n"], [277, "<?php\n"], [278, "\n"], [279, "  /* Connect to MySQL and select the database. */\n"], [280, "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"], [281, "\n"], [282, "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"], [283, "\n"], [284, "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"], [285, "\n"], [286, "  /* Ensure that the EMPLOYEES table exists. */\n"], [287, "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"], [288, "\n"], [289, "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"], [290, "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"], [291, "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"], [292, "\n"], [293, "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"], [294, "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"], [295, "  }\n"], [296, "?>\n"], [297, "\n"], [298, "<!-- Input form -->\n"], [299, "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"], [300, "  <table border=\"0\">\n"], [301, "    <tr>\n"], [302, "      <td>NAME</td>\n"], [303, "      <td>ADDRESS</td>\n"], [304, "    </tr>\n"], [305, "    <tr>\n"], [306, "      <td>\n"], [307, "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"], [308, "      </td>\n"], [309, "      <td>\n"], [310, "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"], [311, "      </td>\n"], [312, "      <td>\n"], [313, "        <input type=\"submit\" value=\"Add Data\" />\n"], [314, "      </td>\n"], [315, "    </tr>\n"], [316, "  </table>\n"], [317, "</form>\n"], [318, "\n"], [319, "<!-- Display table data. -->\n"], [320, "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"], [321, "  <tr>\n"], [322, "    <td>ID</td>\n"], [323, "    <td>NAME</td>\n"], [324, "    <td>ADDRESS</td>\n"], [325, "  </tr>\n"], [326, "\n"], [327, "<?php\n"], [328, "\n"], [329, "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"], [330, "\n"], [331, "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"], [332, "  echo \"<tr>\";\n"], [333, "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"], [334, "       \"<td>\",\\$query_data[1], \"</td>\",\n"], [335, "       \"<td>\",\\$query_data[2], \"</td>\";\n"], [336, "  echo \"</tr>\";\n"], [337, "}\n"], [338, "?>\n"], [339, "\n"], [340, "</table>\n"], [341, "\n"], [342, "<!-- Clean up. -->\n"], [343, "<?php\n"], [344, "\n"], [345, "  mysqli_free_result(\\$result);\n"], [346, "  mysqli_close(\\$connection);\n"], [347, "\n"], [348, "?>\n"], [349, "\n"], [350, "</body>\n"], [351, "</html>\n"], [352, "\n"], [353, "\n"], [354, "<?php\n"], [355, "\n"], [356, "/* Add an employee to the table. */\n"], [357, "function AddEmployee(\\$connection, \\$name, \\$address) {\n"], [358, "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"], [359, "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"], [360, "\n"], [361, "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"], [362, "\n"], [363, "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"], [364, "}\n"], [365, "\n"], [366, "/* Check whether the table exists and, if not, create it. */\n"], [367, "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"], [368, "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"], [369, "  {\n"], [370, "     \\$query = \"CREATE TABLE EMPLOYEES (\n"], [371, "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"], [372, "         NAME VARCHAR(45),\n"], [373, "         ADDRESS VARCHAR(90)\n"], [374, "       )\";\n"], [375, "\n"], [376, "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"], [377, "  }\n"], [378, "}\n"], [379, "\n"], [380, "/* Check for the existence of a table. */\n"], [381, "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"], [382, "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"], [383, "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"], [384, "\n"], [385, "  \\$checktable = mysqli_query(\\$connection,\n"], [386, "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"], [387, "\n"], [388, "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"], [389, "\n"], [390, "  return false;\n"], [391, "}\n"], [392, "?>               \n"], [393, "EnD\n"], [394, "\n"], [395, "sudo mv /tmp/index.php /var/www/html\n"], [396, "sudo chown root:root /var/www/html/index.php\n"], [397, "\n"], [398, "\n"], [399, "\n"], [400, "EOF\n"], [401, "  tags = merge({\n"], [402, "    Name = \"${local.resource_prefix.value}-dbapp\"\n"], [403, "    }, {\n"], [404, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [405, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [406, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [407, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [408, "    git_modifiers        = \"nimrodkor\"\n"], [409, "    git_org              = \"bridgecrewio\"\n"], [410, "    git_repo             = \"terragoat\"\n"], [411, "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"], [412, "  })\n"], [413, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [243, 413], "resource": "aws_instance.db_app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user_data": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "iam_instance_profile": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ec2profile", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[243, "resource \"aws_instance\" \"db_app\" {\n"], [244, "  # ec2 have plain text secrets in user data\n"], [245, "  ami                  = data.aws_ami.amazon-linux-2.id\n"], [246, "  instance_type        = \"t2.nano\"\n"], [247, "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"], [248, "\n"], [249, "  vpc_security_group_ids = [\n"], [250, "  \"${aws_security_group.web-node.id}\"]\n"], [251, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [252, "  user_data = <<EOF\n"], [253, "#! /bin/bash\n"], [254, "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"], [255, "sudo yum -y update\n"], [256, "sudo yum -y install httpd php php-mysqlnd\n"], [257, "sudo systemctl enable httpd \n"], [258, "sudo systemctl start httpd\n"], [259, "\n"], [260, "sudo mkdir /var/www/inc\n"], [261, "cat << EnD > /tmp/dbinfo.inc\n"], [262, "<?php\n"], [263, "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"], [264, "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"], [265, "define('DB_PASSWORD', '${var.password}');\n"], [266, "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"], [267, "?>\n"], [268, "EnD\n"], [269, "sudo mv /tmp/dbinfo.inc /var/www/inc \n"], [270, "sudo chown root:root /var/www/inc/dbinfo.inc\n"], [271, "\n"], [272, "cat << EnD > /tmp/index.php\n"], [273, "<?php include \"../inc/dbinfo.inc\"; ?>\n"], [274, "<html>\n"], [275, "<body>\n"], [276, "<h1>Sample page</h1>\n"], [277, "<?php\n"], [278, "\n"], [279, "  /* Connect to MySQL and select the database. */\n"], [280, "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"], [281, "\n"], [282, "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"], [283, "\n"], [284, "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"], [285, "\n"], [286, "  /* Ensure that the EMPLOYEES table exists. */\n"], [287, "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"], [288, "\n"], [289, "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"], [290, "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"], [291, "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"], [292, "\n"], [293, "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"], [294, "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"], [295, "  }\n"], [296, "?>\n"], [297, "\n"], [298, "<!-- Input form -->\n"], [299, "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"], [300, "  <table border=\"0\">\n"], [301, "    <tr>\n"], [302, "      <td>NAME</td>\n"], [303, "      <td>ADDRESS</td>\n"], [304, "    </tr>\n"], [305, "    <tr>\n"], [306, "      <td>\n"], [307, "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"], [308, "      </td>\n"], [309, "      <td>\n"], [310, "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"], [311, "      </td>\n"], [312, "      <td>\n"], [313, "        <input type=\"submit\" value=\"Add Data\" />\n"], [314, "      </td>\n"], [315, "    </tr>\n"], [316, "  </table>\n"], [317, "</form>\n"], [318, "\n"], [319, "<!-- Display table data. -->\n"], [320, "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"], [321, "  <tr>\n"], [322, "    <td>ID</td>\n"], [323, "    <td>NAME</td>\n"], [324, "    <td>ADDRESS</td>\n"], [325, "  </tr>\n"], [326, "\n"], [327, "<?php\n"], [328, "\n"], [329, "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"], [330, "\n"], [331, "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"], [332, "  echo \"<tr>\";\n"], [333, "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"], [334, "       \"<td>\",\\$query_data[1], \"</td>\",\n"], [335, "       \"<td>\",\\$query_data[2], \"</td>\";\n"], [336, "  echo \"</tr>\";\n"], [337, "}\n"], [338, "?>\n"], [339, "\n"], [340, "</table>\n"], [341, "\n"], [342, "<!-- Clean up. -->\n"], [343, "<?php\n"], [344, "\n"], [345, "  mysqli_free_result(\\$result);\n"], [346, "  mysqli_close(\\$connection);\n"], [347, "\n"], [348, "?>\n"], [349, "\n"], [350, "</body>\n"], [351, "</html>\n"], [352, "\n"], [353, "\n"], [354, "<?php\n"], [355, "\n"], [356, "/* Add an employee to the table. */\n"], [357, "function AddEmployee(\\$connection, \\$name, \\$address) {\n"], [358, "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"], [359, "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"], [360, "\n"], [361, "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"], [362, "\n"], [363, "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"], [364, "}\n"], [365, "\n"], [366, "/* Check whether the table exists and, if not, create it. */\n"], [367, "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"], [368, "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"], [369, "  {\n"], [370, "     \\$query = \"CREATE TABLE EMPLOYEES (\n"], [371, "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"], [372, "         NAME VARCHAR(45),\n"], [373, "         ADDRESS VARCHAR(90)\n"], [374, "       )\";\n"], [375, "\n"], [376, "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"], [377, "  }\n"], [378, "}\n"], [379, "\n"], [380, "/* Check for the existence of a table. */\n"], [381, "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"], [382, "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"], [383, "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"], [384, "\n"], [385, "  \\$checktable = mysqli_query(\\$connection,\n"], [386, "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"], [387, "\n"], [388, "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"], [389, "\n"], [390, "  return false;\n"], [391, "}\n"], [392, "?>               \n"], [393, "EnD\n"], [394, "\n"], [395, "sudo mv /tmp/index.php /var/www/html\n"], [396, "sudo chown root:root /var/www/html/index.php\n"], [397, "\n"], [398, "\n"], [399, "\n"], [400, "EOF\n"], [401, "  tags = merge({\n"], [402, "    Name = \"${local.resource_prefix.value}-dbapp\"\n"], [403, "    }, {\n"], [404, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [405, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [406, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [407, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [408, "    git_modifiers        = \"nimrodkor\"\n"], [409, "    git_org              = \"bridgecrewio\"\n"], [410, "    git_repo             = \"terragoat\"\n"], [411, "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"], [412, "  })\n"], [413, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [243, 413], "resource": "aws_instance.db_app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-13.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user_data": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "iam_instance_profile": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ec2profile", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens", "metadata_options/[0]/http_endpoint"]}, "code_block": [[243, "resource \"aws_instance\" \"db_app\" {\n"], [244, "  # ec2 have plain text secrets in user data\n"], [245, "  ami                  = data.aws_ami.amazon-linux-2.id\n"], [246, "  instance_type        = \"t2.nano\"\n"], [247, "  iam_instance_profile = aws_iam_instance_profile.ec2profile.name\n"], [248, "\n"], [249, "  vpc_security_group_ids = [\n"], [250, "  \"${aws_security_group.web-node.id}\"]\n"], [251, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [252, "  user_data = <<EOF\n"], [253, "#! /bin/bash\n"], [254, "### Config from https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Tutorials.WebServerDB.CreateWebServer.html\n"], [255, "sudo yum -y update\n"], [256, "sudo yum -y install httpd php php-mysqlnd\n"], [257, "sudo systemctl enable httpd \n"], [258, "sudo systemctl start httpd\n"], [259, "\n"], [260, "sudo mkdir /var/www/inc\n"], [261, "cat << EnD > /tmp/dbinfo.inc\n"], [262, "<?php\n"], [263, "define('DB_SERVER', '${aws_db_instance.default.endpoint}');\n"], [264, "define('DB_USERNAME', '${aws_db_instance.default.username}');\n"], [265, "define('DB_PASSWORD', '${var.password}');\n"], [266, "define('DB_DATABASE', '${aws_db_instance.default.name}');\n"], [267, "?>\n"], [268, "EnD\n"], [269, "sudo mv /tmp/dbinfo.inc /var/www/inc \n"], [270, "sudo chown root:root /var/www/inc/dbinfo.inc\n"], [271, "\n"], [272, "cat << EnD > /tmp/index.php\n"], [273, "<?php include \"../inc/dbinfo.inc\"; ?>\n"], [274, "<html>\n"], [275, "<body>\n"], [276, "<h1>Sample page</h1>\n"], [277, "<?php\n"], [278, "\n"], [279, "  /* Connect to MySQL and select the database. */\n"], [280, "  \\$connection = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD);\n"], [281, "\n"], [282, "  if (mysqli_connect_errno()) echo \"Failed to connect to MySQL: \" . mysqli_connect_error();\n"], [283, "\n"], [284, "  \\$database = mysqli_select_db(\\$connection, DB_DATABASE);\n"], [285, "\n"], [286, "  /* Ensure that the EMPLOYEES table exists. */\n"], [287, "  VerifyEmployeesTable(\\$connection, DB_DATABASE);\n"], [288, "\n"], [289, "  /* If input fields are populated, add a row to the EMPLOYEES table. */\n"], [290, "  \\$employee_name = htmlentities(\\$_POST['NAME']);\n"], [291, "  \\$employee_address = htmlentities(\\$_POST['ADDRESS']);\n"], [292, "\n"], [293, "  if (strlen(\\$employee_name) || strlen(\\$employee_address)) {\n"], [294, "    AddEmployee(\\$connection, \\$employee_name, \\$employee_address);\n"], [295, "  }\n"], [296, "?>\n"], [297, "\n"], [298, "<!-- Input form -->\n"], [299, "<form action=\"<?PHP echo \\$_SERVER['SCRIPT_NAME'] ?>\" method=\"POST\">\n"], [300, "  <table border=\"0\">\n"], [301, "    <tr>\n"], [302, "      <td>NAME</td>\n"], [303, "      <td>ADDRESS</td>\n"], [304, "    </tr>\n"], [305, "    <tr>\n"], [306, "      <td>\n"], [307, "        <input type=\"text\" name=\"NAME\" maxlength=\"45\" size=\"30\" />\n"], [308, "      </td>\n"], [309, "      <td>\n"], [310, "        <input type=\"text\" name=\"ADDRESS\" maxlength=\"90\" size=\"60\" />\n"], [311, "      </td>\n"], [312, "      <td>\n"], [313, "        <input type=\"submit\" value=\"Add Data\" />\n"], [314, "      </td>\n"], [315, "    </tr>\n"], [316, "  </table>\n"], [317, "</form>\n"], [318, "\n"], [319, "<!-- Display table data. -->\n"], [320, "<table border=\"1\" cellpadding=\"2\" cellspacing=\"2\">\n"], [321, "  <tr>\n"], [322, "    <td>ID</td>\n"], [323, "    <td>NAME</td>\n"], [324, "    <td>ADDRESS</td>\n"], [325, "  </tr>\n"], [326, "\n"], [327, "<?php\n"], [328, "\n"], [329, "\\$result = mysqli_query(\\$connection, \"SELECT * FROM EMPLOYEES\");\n"], [330, "\n"], [331, "while(\\$query_data = mysqli_fetch_row(\\$result)) {\n"], [332, "  echo \"<tr>\";\n"], [333, "  echo \"<td>\",\\$query_data[0], \"</td>\",\n"], [334, "       \"<td>\",\\$query_data[1], \"</td>\",\n"], [335, "       \"<td>\",\\$query_data[2], \"</td>\";\n"], [336, "  echo \"</tr>\";\n"], [337, "}\n"], [338, "?>\n"], [339, "\n"], [340, "</table>\n"], [341, "\n"], [342, "<!-- Clean up. -->\n"], [343, "<?php\n"], [344, "\n"], [345, "  mysqli_free_result(\\$result);\n"], [346, "  mysqli_close(\\$connection);\n"], [347, "\n"], [348, "?>\n"], [349, "\n"], [350, "</body>\n"], [351, "</html>\n"], [352, "\n"], [353, "\n"], [354, "<?php\n"], [355, "\n"], [356, "/* Add an employee to the table. */\n"], [357, "function AddEmployee(\\$connection, \\$name, \\$address) {\n"], [358, "   \\$n = mysqli_real_escape_string(\\$connection, \\$name);\n"], [359, "   \\$a = mysqli_real_escape_string(\\$connection, \\$address);\n"], [360, "\n"], [361, "   \\$query = \"INSERT INTO EMPLOYEES (NAME, ADDRESS) VALUES ('\\$n', '\\$a');\";\n"], [362, "\n"], [363, "   if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error adding employee data.</p>\");\n"], [364, "}\n"], [365, "\n"], [366, "/* Check whether the table exists and, if not, create it. */\n"], [367, "function VerifyEmployeesTable(\\$connection, \\$dbName) {\n"], [368, "  if(!TableExists(\"EMPLOYEES\", \\$connection, \\$dbName))\n"], [369, "  {\n"], [370, "     \\$query = \"CREATE TABLE EMPLOYEES (\n"], [371, "         ID int(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n"], [372, "         NAME VARCHAR(45),\n"], [373, "         ADDRESS VARCHAR(90)\n"], [374, "       )\";\n"], [375, "\n"], [376, "     if(!mysqli_query(\\$connection, \\$query)) echo(\"<p>Error creating table.</p>\");\n"], [377, "  }\n"], [378, "}\n"], [379, "\n"], [380, "/* Check for the existence of a table. */\n"], [381, "function TableExists(\\$tableName, \\$connection, \\$dbName) {\n"], [382, "  \\$t = mysqli_real_escape_string(\\$connection, \\$tableName);\n"], [383, "  \\$d = mysqli_real_escape_string(\\$connection, \\$dbName);\n"], [384, "\n"], [385, "  \\$checktable = mysqli_query(\\$connection,\n"], [386, "      \"SELECT TABLE_NAME FROM information_schema.TABLES WHERE TABLE_NAME = '\\$t' AND TABLE_SCHEMA = '\\$d'\");\n"], [387, "\n"], [388, "  if(mysqli_num_rows(\\$checktable) > 0) return true;\n"], [389, "\n"], [390, "  return false;\n"], [391, "}\n"], [392, "?>               \n"], [393, "EnD\n"], [394, "\n"], [395, "sudo mv /tmp/index.php /var/www/html\n"], [396, "sudo chown root:root /var/www/html/index.php\n"], [397, "\n"], [398, "\n"], [399, "\n"], [400, "EOF\n"], [401, "  tags = merge({\n"], [402, "    Name = \"${local.resource_prefix.value}-dbapp\"\n"], [403, "    }, {\n"], [404, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [405, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [406, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [407, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [408, "    git_modifiers        = \"nimrodkor\"\n"], [409, "    git_org              = \"bridgecrewio\"\n"], [410, "    git_repo             = \"terragoat\"\n"], [411, "    yor_trace            = \"f7999d4e-c983-43ee-bd88-7903a6f8483e\"\n"], [412, "  })\n"], [413, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [243, 413], "resource": "aws_instance.db_app", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-dbapp", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7999d4e-c983-43ee-bd88-7903a6f8483e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-31.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/db-app.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user_data": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "iam_instance_profile": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_instance_profile.ec2profile", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_126", "bc_check_id": "BC_AWS_LOGGING_26", "check_name": "Ensure that detailed monitoring is enabled for EC2 instances", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring"]}, "code_block": [[1, "resource \"aws_instance\" \"web_host\" {\n"], [2, "  # ec2 have plain text secrets in user data\n"], [3, "  ami           = \"${var.ami}\"\n"], [4, "  instance_type = \"t2.nano\"\n"], [5, "\n"], [6, "  vpc_security_group_ids = [\n"], [7, "  \"${aws_security_group.web-node.id}\"]\n"], [8, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [9, "  user_data = <<EOF\n"], [10, "#! /bin/bash\n"], [11, "sudo apt-get update\n"], [12, "sudo apt-get install -y apache2\n"], [13, "sudo systemctl start apache2\n"], [14, "sudo systemctl enable apache2\n"], [15, "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"], [16, "export AWS_SECRET_ACCESS_KEY=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\n"], [17, "export AWS_DEFAULT_REGION=us-west-2\n"], [18, "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"], [19, "EOF\n"], [20, "  tags = merge({\n"], [21, "    Name = \"${local.resource_prefix.value}-ec2\"\n"], [22, "    }, {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"], [31, "  })\n"], [32, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [1, 32], "resource": "aws_instance.web_host", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2DetailedMonitoringEnabled", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"ami": [{"type": "variable", "name": "ami", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_135", "bc_check_id": "BC_AWS_GENERAL_68", "check_name": "Ensure that EC2 is EBS optimized", "check_result": {"result": "FAILED", "evaluated_keys": ["ebs_optimized"]}, "code_block": [[1, "resource \"aws_instance\" \"web_host\" {\n"], [2, "  # ec2 have plain text secrets in user data\n"], [3, "  ami           = \"${var.ami}\"\n"], [4, "  instance_type = \"t2.nano\"\n"], [5, "\n"], [6, "  vpc_security_group_ids = [\n"], [7, "  \"${aws_security_group.web-node.id}\"]\n"], [8, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [9, "  user_data = <<EOF\n"], [10, "#! /bin/bash\n"], [11, "sudo apt-get update\n"], [12, "sudo apt-get install -y apache2\n"], [13, "sudo systemctl start apache2\n"], [14, "sudo systemctl enable apache2\n"], [15, "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"], [16, "export AWS_SECRET_ACCESS_KEY=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\n"], [17, "export AWS_DEFAULT_REGION=us-west-2\n"], [18, "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"], [19, "EOF\n"], [20, "  tags = merge({\n"], [21, "    Name = \"${local.resource_prefix.value}-ec2\"\n"], [22, "    }, {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"], [31, "  })\n"], [32, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [1, 32], "resource": "aws_instance.web_host", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2EBSOptimized", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"ami": [{"type": "variable", "name": "ami", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_8", "bc_check_id": "BC_AWS_GENERAL_13", "check_name": "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["root_block_device"]}, "code_block": [[1, "resource \"aws_instance\" \"web_host\" {\n"], [2, "  # ec2 have plain text secrets in user data\n"], [3, "  ami           = \"${var.ami}\"\n"], [4, "  instance_type = \"t2.nano\"\n"], [5, "\n"], [6, "  vpc_security_group_ids = [\n"], [7, "  \"${aws_security_group.web-node.id}\"]\n"], [8, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [9, "  user_data = <<EOF\n"], [10, "#! /bin/bash\n"], [11, "sudo apt-get update\n"], [12, "sudo apt-get install -y apache2\n"], [13, "sudo systemctl start apache2\n"], [14, "sudo systemctl enable apache2\n"], [15, "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"], [16, "export AWS_SECRET_ACCESS_KEY=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\n"], [17, "export AWS_DEFAULT_REGION=us-west-2\n"], [18, "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"], [19, "EOF\n"], [20, "  tags = merge({\n"], [21, "    Name = \"${local.resource_prefix.value}-ec2\"\n"], [22, "    }, {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"], [31, "  })\n"], [32, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [1, 32], "resource": "aws_instance.web_host", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LaunchConfigurationEBSEncryption", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-13.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"ami": [{"type": "variable", "name": "ami", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens", "metadata_options/[0]/http_endpoint"]}, "code_block": [[1, "resource \"aws_instance\" \"web_host\" {\n"], [2, "  # ec2 have plain text secrets in user data\n"], [3, "  ami           = \"${var.ami}\"\n"], [4, "  instance_type = \"t2.nano\"\n"], [5, "\n"], [6, "  vpc_security_group_ids = [\n"], [7, "  \"${aws_security_group.web-node.id}\"]\n"], [8, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [9, "  user_data = <<EOF\n"], [10, "#! /bin/bash\n"], [11, "sudo apt-get update\n"], [12, "sudo apt-get install -y apache2\n"], [13, "sudo systemctl start apache2\n"], [14, "sudo systemctl enable apache2\n"], [15, "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"], [16, "export AWS_SECRET_ACCESS_KEY=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\n"], [17, "export AWS_DEFAULT_REGION=us-west-2\n"], [18, "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"], [19, "EOF\n"], [20, "  tags = merge({\n"], [21, "    Name = \"${local.resource_prefix.value}-ec2\"\n"], [22, "    }, {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"], [31, "  })\n"], [32, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [1, 32], "resource": "aws_instance.web_host", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-31.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"ami": [{"type": "variable", "name": "ami", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_46", "bc_check_id": "BC_AWS_SECRETS_1", "check_name": "Ensure no hard-coded secrets exist in EC2 user data", "check_result": {"result": "FAILED", "evaluated_keys": ["user_data"]}, "code_block": [[1, "resource \"aws_instance\" \"web_host\" {\n"], [2, "  # ec2 have plain text secrets in user data\n"], [3, "  ami           = \"${var.ami}\"\n"], [4, "  instance_type = \"t2.nano\"\n"], [5, "\n"], [6, "  vpc_security_group_ids = [\n"], [7, "  \"${aws_security_group.web-node.id}\"]\n"], [8, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [9, "  user_data = <<EOF\n"], [10, "#! /bin/bash\n"], [11, "sudo apt-get update\n"], [12, "sudo apt-get install -y apache2\n"], [13, "sudo systemctl start apache2\n"], [14, "sudo systemctl enable apache2\n"], [15, "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"], [16, "export AWS_SECRET_ACCESS_KEY=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\n"], [17, "export AWS_DEFAULT_REGION=us-west-2\n"], [18, "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"], [19, "EOF\n"], [20, "  tags = merge({\n"], [21, "    Name = \"${local.resource_prefix.value}-ec2\"\n"], [22, "    }, {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"], [31, "  })\n"], [32, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [1, 32], "resource": "aws_instance.web_host", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2Credentials", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/secrets-policies/bc-aws-secrets-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"ami": [{"type": "variable", "name": "ami", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_3", "bc_check_id": "BC_AWS_GENERAL_3", "check_name": "Ensure all data stored in the EBS is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["encrypted"]}, "code_block": [[34, "resource \"aws_ebs_volume\" \"web_host_storage\" {\n"], [35, "  # unencrypted volume\n"], [36, "  availability_zone = \"${var.region}a\"\n"], [37, "  #encrypted         = false  # Setting this causes the volume to be recreated on apply \n"], [38, "  size = 1\n"], [39, "  tags = merge({\n"], [40, "    Name = \"${local.resource_prefix.value}-ebs\"\n"], [41, "    }, {\n"], [42, "    git_commit           = \"d3439f0f2af62f6fa3521e14d6c27819ef8f12e1\"\n"], [43, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [44, "    git_last_modified_at = \"2021-05-02 11:17:26\"\n"], [45, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [46, "    git_modifiers        = \"nimrodkor\"\n"], [47, "    git_org              = \"bridgecrewio\"\n"], [48, "    git_repo             = \"terragoat\"\n"], [49, "    yor_trace            = \"c5509daf-10f0-46af-9e03-41989212521d\"\n"], [50, "  })\n"], [51, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [34, 51], "resource": "aws_ebs_volume.web_host_storage", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EBSEncryption", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ebs", "git_commit": "d3439f0f2af62f6fa3521e14d6c27819ef8f12e1", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2021-05-02 11:17:26", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c5509daf-10f0-46af-9e03-41989212521d"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-3-encrypt-ebs-volume.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_189", "bc_check_id": "BC_AWS_GENERAL_109", "check_name": "Ensure EBS Volume is encrypted by KMS using a customer managed Key (CMK)", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[34, "resource \"aws_ebs_volume\" \"web_host_storage\" {\n"], [35, "  # unencrypted volume\n"], [36, "  availability_zone = \"${var.region}a\"\n"], [37, "  #encrypted         = false  # Setting this causes the volume to be recreated on apply \n"], [38, "  size = 1\n"], [39, "  tags = merge({\n"], [40, "    Name = \"${local.resource_prefix.value}-ebs\"\n"], [41, "    }, {\n"], [42, "    git_commit           = \"d3439f0f2af62f6fa3521e14d6c27819ef8f12e1\"\n"], [43, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [44, "    git_last_modified_at = \"2021-05-02 11:17:26\"\n"], [45, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [46, "    git_modifiers        = \"nimrodkor\"\n"], [47, "    git_org              = \"bridgecrewio\"\n"], [48, "    git_repo             = \"terragoat\"\n"], [49, "    yor_trace            = \"c5509daf-10f0-46af-9e03-41989212521d\"\n"], [50, "  })\n"], [51, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [34, 51], "resource": "aws_ebs_volume.web_host_storage", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EBSVolumeEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ebs", "git_commit": "d3439f0f2af62f6fa3521e14d6c27819ef8f12e1", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2021-05-02 11:17:26", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c5509daf-10f0-46af-9e03-41989212521d"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-109.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_260", "bc_check_id": "BC_AWS_NETWORKING_67", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[0]/from_port", "ingress/[0]/to_port", "ingress/[0]/cidr_blocks", "ingress/[0]/ipv6_cidr_blocks"]}, "code_block": [[77, "resource \"aws_security_group\" \"web-node\" {\n"], [78, "  # security group is open to the world in SSH port\n"], [79, "  name        = \"${local.resource_prefix.value}-sg\"\n"], [80, "  description = \"${local.resource_prefix.value} Security Group\"\n"], [81, "  vpc_id      = aws_vpc.web_vpc.id\n"], [82, "\n"], [83, "  ingress {\n"], [84, "    from_port = 80\n"], [85, "    to_port   = 80\n"], [86, "    protocol  = \"tcp\"\n"], [87, "    cidr_blocks = [\n"], [88, "    \"0.0.0.0/0\"]\n"], [89, "  }\n"], [90, "  ingress {\n"], [91, "    from_port = 22\n"], [92, "    to_port   = 22\n"], [93, "    protocol  = \"tcp\"\n"], [94, "    cidr_blocks = [\n"], [95, "    \"0.0.0.0/0\"]\n"], [96, "  }\n"], [97, "  egress {\n"], [98, "    from_port = 0\n"], [99, "    to_port   = 0\n"], [100, "    protocol  = \"-1\"\n"], [101, "    cidr_blocks = [\n"], [102, "    \"0.0.0.0/0\"]\n"], [103, "  }\n"], [104, "  depends_on = [aws_vpc.web_vpc]\n"], [105, "  tags = {\n"], [106, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [107, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [108, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [109, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [110, "    git_modifiers        = \"nimrodkor\"\n"], [111, "    git_org              = \"bridgecrewio\"\n"], [112, "    git_repo             = \"terragoat\"\n"], [113, "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"], [114, "  }\n"], [115, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [77, 115], "resource": "aws_security_group.web-node", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress80", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_23", "bc_check_id": "BC_AWS_NETWORKING_31", "check_name": "Ensure every security groups rule has a description", "check_result": {"result": "FAILED", "evaluated_keys": ["description", "egress/[0]", "ingress/[0]"]}, "code_block": [[77, "resource \"aws_security_group\" \"web-node\" {\n"], [78, "  # security group is open to the world in SSH port\n"], [79, "  name        = \"${local.resource_prefix.value}-sg\"\n"], [80, "  description = \"${local.resource_prefix.value} Security Group\"\n"], [81, "  vpc_id      = aws_vpc.web_vpc.id\n"], [82, "\n"], [83, "  ingress {\n"], [84, "    from_port = 80\n"], [85, "    to_port   = 80\n"], [86, "    protocol  = \"tcp\"\n"], [87, "    cidr_blocks = [\n"], [88, "    \"0.0.0.0/0\"]\n"], [89, "  }\n"], [90, "  ingress {\n"], [91, "    from_port = 22\n"], [92, "    to_port   = 22\n"], [93, "    protocol  = \"tcp\"\n"], [94, "    cidr_blocks = [\n"], [95, "    \"0.0.0.0/0\"]\n"], [96, "  }\n"], [97, "  egress {\n"], [98, "    from_port = 0\n"], [99, "    to_port   = 0\n"], [100, "    protocol  = \"-1\"\n"], [101, "    cidr_blocks = [\n"], [102, "    \"0.0.0.0/0\"]\n"], [103, "  }\n"], [104, "  depends_on = [aws_vpc.web_vpc]\n"], [105, "  tags = {\n"], [106, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [107, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [108, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [109, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [110, "    git_modifiers        = \"nimrodkor\"\n"], [111, "    git_org              = \"bridgecrewio\"\n"], [112, "    git_repo             = \"terragoat\"\n"], [113, "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"], [114, "  }\n"], [115, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [77, 115], "resource": "aws_security_group.web-node", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupRuleDescription", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-31.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_24", "bc_check_id": "BC_AWS_NETWORKING_1", "check_name": "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22", "check_result": {"result": "FAILED", "evaluated_keys": ["ingress/[1]/from_port", "ingress/[1]/to_port", "ingress/[1]/cidr_blocks", "ingress/[1]/ipv6_cidr_blocks"]}, "code_block": [[77, "resource \"aws_security_group\" \"web-node\" {\n"], [78, "  # security group is open to the world in SSH port\n"], [79, "  name        = \"${local.resource_prefix.value}-sg\"\n"], [80, "  description = \"${local.resource_prefix.value} Security Group\"\n"], [81, "  vpc_id      = aws_vpc.web_vpc.id\n"], [82, "\n"], [83, "  ingress {\n"], [84, "    from_port = 80\n"], [85, "    to_port   = 80\n"], [86, "    protocol  = \"tcp\"\n"], [87, "    cidr_blocks = [\n"], [88, "    \"0.0.0.0/0\"]\n"], [89, "  }\n"], [90, "  ingress {\n"], [91, "    from_port = 22\n"], [92, "    to_port   = 22\n"], [93, "    protocol  = \"tcp\"\n"], [94, "    cidr_blocks = [\n"], [95, "    \"0.0.0.0/0\"]\n"], [96, "  }\n"], [97, "  egress {\n"], [98, "    from_port = 0\n"], [99, "    to_port   = 0\n"], [100, "    protocol  = \"-1\"\n"], [101, "    cidr_blocks = [\n"], [102, "    \"0.0.0.0/0\"]\n"], [103, "  }\n"], [104, "  depends_on = [aws_vpc.web_vpc]\n"], [105, "  tags = {\n"], [106, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [107, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [108, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [109, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [110, "    git_modifiers        = \"nimrodkor\"\n"], [111, "    git_org              = \"bridgecrewio\"\n"], [112, "    git_repo             = \"terragoat\"\n"], [113, "    yor_trace            = \"b7af1b40-64eb-4519-a1a0-ab198db4b193\"\n"], [114, "  }\n"], [115, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [77, 115], "resource": "aws_security_group.web-node", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SecurityGroupUnrestrictedIngress22", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b7af1b40-64eb-4519-a1a0-ab198db4b193"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-1-port-security.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[135, "resource \"aws_subnet\" \"web_subnet\" {\n"], [136, "  vpc_id                  = aws_vpc.web_vpc.id\n"], [137, "  cidr_block              = \"172.16.10.0/24\"\n"], [138, "  availability_zone       = \"${var.region}a\"\n"], [139, "  map_public_ip_on_launch = true\n"], [140, "\n"], [141, "  tags = merge({\n"], [142, "    Name = \"${local.resource_prefix.value}-subnet\"\n"], [143, "    }, {\n"], [144, "    git_commit           = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"], [145, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [146, "    git_last_modified_at = \"2021-05-02 11:16:31\"\n"], [147, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [148, "    git_modifiers        = \"nimrodkor\"\n"], [149, "    git_org              = \"bridgecrewio\"\n"], [150, "    git_repo             = \"terragoat\"\n"], [151, "    yor_trace            = \"0345f650-d280-4ca8-86c9-c71c38c0eda8\"\n"], [152, "  })\n"], [153, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [135, 153], "resource": "aws_subnet.web_subnet", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-subnet", "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2021-05-02 11:16:31", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0345f650-d280-4ca8-86c9-c71c38c0eda8"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[155, "resource \"aws_subnet\" \"web_subnet2\" {\n"], [156, "  vpc_id                  = aws_vpc.web_vpc.id\n"], [157, "  cidr_block              = \"172.16.11.0/24\"\n"], [158, "  availability_zone       = \"${var.region}b\"\n"], [159, "  map_public_ip_on_launch = true\n"], [160, "\n"], [161, "  tags = merge({\n"], [162, "    Name = \"${local.resource_prefix.value}-subnet2\"\n"], [163, "    }, {\n"], [164, "    git_commit           = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"], [165, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [166, "    git_last_modified_at = \"2021-05-02 11:16:31\"\n"], [167, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [168, "    git_modifiers        = \"nimrodkor\"\n"], [169, "    git_org              = \"bridgecrewio\"\n"], [170, "    git_repo             = \"terragoat\"\n"], [171, "    yor_trace            = \"224af03a-00e0-4981-be30-14965833c2db\"\n"], [172, "  })\n"], [173, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [155, 173], "resource": "aws_subnet.web_subnet2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-subnet2", "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2021-05-02 11:16:31", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "224af03a-00e0-4981-be30-14965833c2db"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ec2.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_163", "bc_check_id": "BC_AWS_GENERAL_8", "check_name": "Ensure ECR image scanning on push is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["image_scanning_configuration/[0]/scan_on_push"]}, "code_block": [[1, "resource aws_ecr_repository \"repository\" {\n"], [2, "  name                 = \"${local.resource_prefix.value}-repository\"\n"], [3, "  image_tag_mutability = \"MUTABLE\"\n"], [4, "\n"], [5, "\n"], [6, "  tags = merge({\n"], [7, "    Name = \"${local.resource_prefix.value}-repository\"\n"], [8, "    }, {\n"], [9, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [10, "    git_file             = \"terraform/aws/ecr.tf\"\n"], [11, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [12, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [13, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"7a3ec657-fa54-4aa2-8467-5d08d6c90bc2\"\n"], [17, "  })\n"], [18, "}\n"]], "file_path": "/terraform/aws/ecr.tf", "file_abs_path": "/terraform/terraform/aws/ecr.tf", "repo_file_path": "/terraform/aws/ecr.tf", "file_line_range": [1, 18], "resource": "aws_ecr_repository.repository", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRImageScanning", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-repository", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/ecr.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7a3ec657-fa54-4aa2-8467-5d08d6c90bc2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ecr.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecr_repository.repository", "path": "/terraform/terraform/aws/ecr.tf", "module_connection": false}, {"type": "locals", "name": "docker_image", "path": "/terraform/terraform/aws/ecr.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_136", "bc_check_id": "BC_AWS_GENERAL_53", "check_name": "Ensure that ECR repositories are encrypted using KMS", "check_result": {"result": "FAILED", "evaluated_keys": ["encryption_configuration/[0]/encryption_type"]}, "code_block": [[1, "resource aws_ecr_repository \"repository\" {\n"], [2, "  name                 = \"${local.resource_prefix.value}-repository\"\n"], [3, "  image_tag_mutability = \"MUTABLE\"\n"], [4, "\n"], [5, "\n"], [6, "  tags = merge({\n"], [7, "    Name = \"${local.resource_prefix.value}-repository\"\n"], [8, "    }, {\n"], [9, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [10, "    git_file             = \"terraform/aws/ecr.tf\"\n"], [11, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [12, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [13, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"7a3ec657-fa54-4aa2-8467-5d08d6c90bc2\"\n"], [17, "  })\n"], [18, "}\n"]], "file_path": "/terraform/aws/ecr.tf", "file_abs_path": "/terraform/terraform/aws/ecr.tf", "repo_file_path": "/terraform/aws/ecr.tf", "file_line_range": [1, 18], "resource": "aws_ecr_repository.repository", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRRepositoryEncrypted", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-repository", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/ecr.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7a3ec657-fa54-4aa2-8467-5d08d6c90bc2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-ecr-repositories-are-encrypted.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ecr.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecr_repository.repository", "path": "/terraform/terraform/aws/ecr.tf", "module_connection": false}, {"type": "locals", "name": "docker_image", "path": "/terraform/terraform/aws/ecr.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_51", "bc_check_id": "BC_AWS_GENERAL_24", "check_name": "Ensure ECR Image Tags are immutable", "check_result": {"result": "FAILED", "evaluated_keys": ["image_tag_mutability"]}, "code_block": [[1, "resource aws_ecr_repository \"repository\" {\n"], [2, "  name                 = \"${local.resource_prefix.value}-repository\"\n"], [3, "  image_tag_mutability = \"MUTABLE\"\n"], [4, "\n"], [5, "\n"], [6, "  tags = merge({\n"], [7, "    Name = \"${local.resource_prefix.value}-repository\"\n"], [8, "    }, {\n"], [9, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [10, "    git_file             = \"terraform/aws/ecr.tf\"\n"], [11, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [12, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [13, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"7a3ec657-fa54-4aa2-8467-5d08d6c90bc2\"\n"], [17, "  })\n"], [18, "}\n"]], "file_path": "/terraform/aws/ecr.tf", "file_abs_path": "/terraform/terraform/aws/ecr.tf", "repo_file_path": "/terraform/aws/ecr.tf", "file_line_range": [1, 18], "resource": "aws_ecr_repository.repository", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ECRImmutableTags", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-repository", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/ecr.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7a3ec657-fa54-4aa2-8467-5d08d6c90bc2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/ecr.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_ecr_repository.repository", "path": "/terraform/terraform/aws/ecr.tf", "module_connection": false}, {"type": "locals", "name": "docker_image", "path": "/terraform/terraform/aws/ecr.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[62, "resource aws_subnet \"eks_subnet1\" {\n"], [63, "  vpc_id                  = aws_vpc.eks_vpc.id\n"], [64, "  cidr_block              = \"10.10.10.0/24\"\n"], [65, "  availability_zone       = \"${var.region}a\"\n"], [66, "  map_public_ip_on_launch = true\n"], [67, "  tags = merge({\n"], [68, "    Name                                            = \"${local.resource_prefix.value}-eks-subnet\"\n"], [69, "    \"kubernetes.io/cluster/${local.eks_name.value}\" = \"shared\"\n"], [70, "    }, {\n"], [71, "    git_commit                                       = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"], [72, "    git_file                                         = \"terraform/aws/eks.tf\"\n"], [73, "    git_last_modified_at                             = \"2021-05-02 11:16:31\"\n"], [74, "    git_last_modified_by                             = \"nimrodkor@gmail.com\"\n"], [75, "    git_modifiers                                    = \"nimrodkor\"\n"], [76, "    git_org                                          = \"bridgecrewio\"\n"], [77, "    git_repo                                         = \"terragoat\"\n"], [78, "    \"kubernetes.io/cluster/$${local.eks_name.value}\" = \"shared\"\n"], [79, "    yor_trace                                        = \"1fb4fa23-a5d6-4d6a-b7dc-88749383f48d\"\n"], [80, "    }, {\n"], [81, "    \"kubernetes.io/cluster/$$${local.eks_name.value}\" = \"shared\"\n"], [82, "    \"kubernetes.io/cluster/$${local.eks_name.value}\"  = \"shared\"\n"], [83, "    }, {\n"], [84, "    \"kubernetes.io/cluster/$$$${local.eks_name.value}\" = \"shared\"\n"], [85, "    \"kubernetes.io/cluster/$$${local.eks_name.value}\"  = \"shared\"\n"], [86, "    \"kubernetes.io/cluster/$${local.eks_name.value}\"   = \"shared\"\n"], [87, "  })\n"], [88, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [62, 88], "resource": "aws_subnet.eks_subnet1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-subnet", "kubernetes.io/cluster/data.aws_caller_identity.current.account_id-acme-dev-eks": "shared", "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2021-05-02 11:16:31", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "kubernetes.io/cluster/$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared", "yor_trace": "1fb4fa23-a5d6-4d6a-b7dc-88749383f48d", "kubernetes.io/cluster/$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared", "kubernetes.io/cluster/$$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "eks_name", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_130", "bc_check_id": "BC_AWS_NETWORKING_53", "check_name": "Ensure VPC subnets do not assign public IP by default", "check_result": {"result": "FAILED", "evaluated_keys": ["map_public_ip_on_launch"]}, "code_block": [[90, "resource aws_subnet \"eks_subnet2\" {\n"], [91, "  vpc_id                  = aws_vpc.eks_vpc.id\n"], [92, "  cidr_block              = \"10.10.11.0/24\"\n"], [93, "  availability_zone       = \"${var.region}b\"\n"], [94, "  map_public_ip_on_launch = true\n"], [95, "  tags = merge({\n"], [96, "    Name                                            = \"${local.resource_prefix.value}-eks-subnet2\"\n"], [97, "    \"kubernetes.io/cluster/${local.eks_name.value}\" = \"shared\"\n"], [98, "    }, {\n"], [99, "    git_commit                                       = \"6e62522d2ab8f63740e53752b84a6e99cd65696a\"\n"], [100, "    git_file                                         = \"terraform/aws/eks.tf\"\n"], [101, "    git_last_modified_at                             = \"2021-05-02 11:16:31\"\n"], [102, "    git_last_modified_by                             = \"nimrodkor@gmail.com\"\n"], [103, "    git_modifiers                                    = \"nimrodkor\"\n"], [104, "    git_org                                          = \"bridgecrewio\"\n"], [105, "    git_repo                                         = \"terragoat\"\n"], [106, "    \"kubernetes.io/cluster/$${local.eks_name.value}\" = \"shared\"\n"], [107, "    yor_trace                                        = \"9ce04af2-5321-4e6c-a262-e4d7c1f69525\"\n"], [108, "    }, {\n"], [109, "    \"kubernetes.io/cluster/$$${local.eks_name.value}\" = \"shared\"\n"], [110, "    \"kubernetes.io/cluster/$${local.eks_name.value}\"  = \"shared\"\n"], [111, "    }, {\n"], [112, "    \"kubernetes.io/cluster/$$$${local.eks_name.value}\" = \"shared\"\n"], [113, "    \"kubernetes.io/cluster/$$${local.eks_name.value}\"  = \"shared\"\n"], [114, "    \"kubernetes.io/cluster/$${local.eks_name.value}\"   = \"shared\"\n"], [115, "  })\n"], [116, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [90, 116], "resource": "aws_subnet.eks_subnet2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.SubnetPublicIP", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-subnet2", "kubernetes.io/cluster/data.aws_caller_identity.current.account_id-acme-dev-eks": "shared", "git_commit": "6e62522d2ab8f63740e53752b84a6e99cd65696a", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2021-05-02 11:16:31", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "kubernetes.io/cluster/$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared", "yor_trace": "9ce04af2-5321-4e6c-a262-e4d7c1f69525", "kubernetes.io/cluster/$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared", "kubernetes.io/cluster/$$$data.aws_caller_identity.current.account_id-acme-dev-eks": "shared"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "eks_name", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_37", "bc_check_id": "BC_AWS_KUBERNETES_4", "check_name": "Ensure Amazon EKS control plane logging enabled for all log types", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cluster_log_types"]}, "code_block": [[118, "resource aws_eks_cluster \"eks_cluster\" {\n"], [119, "  name     = local.eks_name.value\n"], [120, "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"], [121, "\n"], [122, "  vpc_config {\n"], [123, "    endpoint_private_access = true\n"], [124, "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"], [125, "  }\n"], [126, "\n"], [127, "  depends_on = [\n"], [128, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"], [129, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"], [130, "  ]\n"], [131, "  tags = {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/eks.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"], [140, "  }\n"], [141, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [118, 141], "resource": "aws_eks_cluster.eks_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSControlPlaneLogging", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "eks_name", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_39", "bc_check_id": "BC_AWS_KUBERNETES_2", "check_name": "Ensure Amazon EKS public endpoint disabled", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_config/[0]/endpoint_public_access"]}, "code_block": [[118, "resource aws_eks_cluster \"eks_cluster\" {\n"], [119, "  name     = local.eks_name.value\n"], [120, "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"], [121, "\n"], [122, "  vpc_config {\n"], [123, "    endpoint_private_access = true\n"], [124, "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"], [125, "  }\n"], [126, "\n"], [127, "  depends_on = [\n"], [128, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"], [129, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"], [130, "  ]\n"], [131, "  tags = {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/eks.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"], [140, "  }\n"], [141, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [118, 141], "resource": "aws_eks_cluster.eks_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSPublicAccess", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "eks_name", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_38", "bc_check_id": "BC_AWS_KUBERNETES_1", "check_name": "Ensure Amazon EKS public endpoint not accessible to 0.0.0.0/0", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_config"]}, "code_block": [[118, "resource aws_eks_cluster \"eks_cluster\" {\n"], [119, "  name     = local.eks_name.value\n"], [120, "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"], [121, "\n"], [122, "  vpc_config {\n"], [123, "    endpoint_private_access = true\n"], [124, "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"], [125, "  }\n"], [126, "\n"], [127, "  depends_on = [\n"], [128, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"], [129, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"], [130, "  ]\n"], [131, "  tags = {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/eks.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"], [140, "  }\n"], [141, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [118, 141], "resource": "aws_eks_cluster.eks_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSPublicAccessCIDR", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "eks_name", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_58", "bc_check_id": "BC_AWS_KUBERNETES_3", "check_name": "Ensure EKS Cluster has Secrets Encryption Enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["encryption_config/[0]/resources"]}, "code_block": [[118, "resource aws_eks_cluster \"eks_cluster\" {\n"], [119, "  name     = local.eks_name.value\n"], [120, "  role_arn = \"${aws_iam_role.iam_for_eks.arn}\"\n"], [121, "\n"], [122, "  vpc_config {\n"], [123, "    endpoint_private_access = true\n"], [124, "    subnet_ids              = [\"${aws_subnet.eks_subnet1.id}\", \"${aws_subnet.eks_subnet2.id}\"]\n"], [125, "  }\n"], [126, "\n"], [127, "  depends_on = [\n"], [128, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSClusterPolicy\",\n"], [129, "    \"aws_iam_role_policy_attachment.policy_attachment-AmazonEKSServicePolicy\",\n"], [130, "  ]\n"], [131, "  tags = {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/eks.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"7fa14261-c18d-4fa2-aec4-746f6e64d2d3\"\n"], [140, "  }\n"], [141, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [118, 141], "resource": "aws_eks_cluster.eks_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EKSSecretsEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "7fa14261-c18d-4fa2-aec4-746f6e64d2d3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-kubernetes-policies/bc-aws-kubernetes-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/eks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "eks_name", "path": "/terraform/terraform/aws/eks.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_127", "bc_check_id": "BC_AWS_GENERAL_67", "check_name": "Ensure that Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager", "check_result": {"result": "FAILED", "evaluated_keys": ["listener/0"]}, "code_block": [[2, "resource \"aws_elb\" \"weblb\" {\n"], [3, "  name = \"weblb-terraform-elb\"\n"], [4, "\n"], [5, "  listener {\n"], [6, "    instance_port     = 8000\n"], [7, "    instance_protocol = \"http\"\n"], [8, "    lb_port           = 80\n"], [9, "    lb_protocol       = \"http\"\n"], [10, "  }\n"], [11, "\n"], [12, "  health_check {\n"], [13, "    healthy_threshold   = 2\n"], [14, "    unhealthy_threshold = 2\n"], [15, "    timeout             = 3\n"], [16, "    target              = \"HTTP:8000/\"\n"], [17, "    interval            = 30\n"], [18, "  }\n"], [19, "\n"], [20, "  subnets                     = [aws_subnet.web_subnet.id]\n"], [21, "  security_groups             = [aws_security_group.web-node.id]\n"], [22, "  instances                   = [aws_instance.web_host.id]\n"], [23, "  cross_zone_load_balancing   = true\n"], [24, "  idle_timeout                = 400\n"], [25, "  connection_draining         = true\n"], [26, "  connection_draining_timeout = 400\n"], [27, "\n"], [28, "  tags = merge({\n"], [29, "    Name = \"foobar-terraform-elb\"\n"], [30, "    }, {\n"], [31, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [32, "    git_file             = \"terraform/aws/elb.tf\"\n"], [33, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [34, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [35, "    git_modifiers        = \"nimrodkor\"\n"], [36, "    git_org              = \"bridgecrewio\"\n"], [37, "    git_repo             = \"terragoat\"\n"], [38, "    yor_trace            = \"b4a83ce9-9a45-43b4-b6d9-1783c282f702\"\n"], [39, "  })\n"], [40, "}"]], "file_path": "/terraform/aws/elb.tf", "file_abs_path": "/terraform/terraform/aws/elb.tf", "repo_file_path": "/terraform/aws/elb.tf", "file_line_range": [2, 40], "resource": "aws_elb.weblb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBUsesSSL", "fixed_definition": null, "entity_tags": {"Name": "foobar-terraform-elb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/elb.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b4a83ce9-9a45-43b4-b6d9-1783c282f702"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-elastic-load-balancers-uses-ssl-certificates-provided-by-aws-certificate-manager.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/elb.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_92", "bc_check_id": "BC_AWS_LOGGING_23", "check_name": "Ensure the ELB has access logging enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["access_logs/[0]/enabled"]}, "code_block": [[2, "resource \"aws_elb\" \"weblb\" {\n"], [3, "  name = \"weblb-terraform-elb\"\n"], [4, "\n"], [5, "  listener {\n"], [6, "    instance_port     = 8000\n"], [7, "    instance_protocol = \"http\"\n"], [8, "    lb_port           = 80\n"], [9, "    lb_protocol       = \"http\"\n"], [10, "  }\n"], [11, "\n"], [12, "  health_check {\n"], [13, "    healthy_threshold   = 2\n"], [14, "    unhealthy_threshold = 2\n"], [15, "    timeout             = 3\n"], [16, "    target              = \"HTTP:8000/\"\n"], [17, "    interval            = 30\n"], [18, "  }\n"], [19, "\n"], [20, "  subnets                     = [aws_subnet.web_subnet.id]\n"], [21, "  security_groups             = [aws_security_group.web-node.id]\n"], [22, "  instances                   = [aws_instance.web_host.id]\n"], [23, "  cross_zone_load_balancing   = true\n"], [24, "  idle_timeout                = 400\n"], [25, "  connection_draining         = true\n"], [26, "  connection_draining_timeout = 400\n"], [27, "\n"], [28, "  tags = merge({\n"], [29, "    Name = \"foobar-terraform-elb\"\n"], [30, "    }, {\n"], [31, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [32, "    git_file             = \"terraform/aws/elb.tf\"\n"], [33, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [34, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [35, "    git_modifiers        = \"nimrodkor\"\n"], [36, "    git_org              = \"bridgecrewio\"\n"], [37, "    git_repo             = \"terragoat\"\n"], [38, "    yor_trace            = \"b4a83ce9-9a45-43b4-b6d9-1783c282f702\"\n"], [39, "  })\n"], [40, "}"]], "file_path": "/terraform/aws/elb.tf", "file_abs_path": "/terraform/terraform/aws/elb.tf", "repo_file_path": "/terraform/aws/elb.tf", "file_line_range": [2, 40], "resource": "aws_elb.weblb", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ELBAccessLogs", "fixed_definition": null, "entity_tags": {"Name": "foobar-terraform-elb", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/elb.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "b4a83ce9-9a45-43b4-b6d9-1783c282f702"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-23.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/elb.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_283", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow ALL or any AWS principal permissions to the resource", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPublicActionsPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_356", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.ResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[30, "data aws_iam_policy_document \"policy\" {\n"], [31, "  statement {\n"], [32, "    actions = [\"es:*\"]\n"], [33, "    principals {\n"], [34, "      type        = \"AWS\"\n"], [35, "      identifiers = [\"*\"]\n"], [36, "    }\n"], [37, "    resources = [\"*\"]\n"], [38, "  }\n"], [39, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [30, 39], "resource": "aws_iam_policy_document.policy", "evaluations": null, "check_class": "checkov.terraform.checks.data.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_318", "bc_check_id": null, "check_name": "Ensure Elasticsearch domains are configured with at least three dedicated master nodes for HA", "check_result": {"result": "FAILED", "evaluated_keys": ["cluster_config"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchDomainHA", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_5", "bc_check_id": "BC_AWS_ELASTICSEARCH_3", "check_name": "Ensure all data stored in the Elasticsearch is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["encrypt_at_rest/[0]/enabled"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/elastisearch-policies/elasticsearch-3-enable-encryptionatrest.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_84", "bc_check_id": "BC_AWS_ELASTICSEARCH_7", "check_name": "Ensure Elasticsearch Domain Logging is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["log_publishing_options/[0]/cloudwatch_log_group_arn"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchDomainLogging", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/elastisearch-policies/elasticsearch-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_317", "bc_check_id": null, "check_name": "Ensure Elasticsearch Domain Audit Logging is enabled", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchDomainAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_228", "bc_check_id": "BC_AWS_GENERAL_151", "check_name": "Verify Elasticsearch domain is using an up to date TLS policy", "check_result": {"result": "FAILED", "evaluated_keys": ["domain_endpoint_options/[0]/tls_security_policy"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchTLSPolicy", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-aws-elasticsearch-domain-uses-an-updated-tls-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_247", "bc_check_id": "BC_AWS_GENERAL_155", "check_name": "Ensure all data stored in the Elasticsearch is encrypted with a CMK", "check_result": {"result": "FAILED", "evaluated_keys": ["encrypt_at_rest/[0]/kms_key_id"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchEncryptionWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-aws-all-data-stored-in-the-elasticsearch-domain-is-encrypted-using-a-customer-managed-key-cmk.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_137", "bc_check_id": "BC_AWS_NETWORKING_42", "check_name": "Ensure that Elasticsearch is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_options"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchInVPC", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-that-elasticsearch-is-configured-inside-a-vpc.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_248", "bc_check_id": "BC_AWS_NETWORKING_70", "check_name": "Ensure that Elasticsearch is not using the default Security Group", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_options/[0]/security_group_ids"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.ElasticsearchDefaultSG", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/ensure-aws-elasticsearch-does-not-use-the-default-security-group.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/es.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_273", "bc_check_id": null, "check_name": "Ensure access is controlled through SSO and not AWS IAM defined users", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_iam_user\" \"user\" {\n"], [2, "  name          = \"${local.resource_prefix.value}-user\"\n"], [3, "  force_destroy = true\n"], [4, "\n"], [5, "  tags = merge({\n"], [6, "    Name        = \"${local.resource_prefix.value}-user\"\n"], [7, "    Environment = local.resource_prefix.value\n"], [8, "    }, {\n"], [9, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [10, "    git_file             = \"terraform/aws/iam.tf\"\n"], [11, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [12, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [13, "    git_modifiers        = \"nimrodkor\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"9b45b298-c1ea-426a-9644-610780021eaa\"\n"], [17, "  })\n"], [18, "\n"], [19, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [1, 19], "resource": "aws_iam_user.user", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMUserNotUsedForAccess", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-user", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/iam.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9b45b298-c1ea-426a-9644-610780021eaa"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_286", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_287", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_290", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_288", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_355", "bc_check_id": null, "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's resource for restrictable actions", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMStarResourcePolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_289", "bc_check_id": null, "check_name": "Ensure IAM policies does not allow permissions management / resource exposure without constraints", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[25, "resource \"aws_iam_user_policy\" \"userpolicy\" {\n"], [26, "  name = \"excess_policy\"\n"], [27, "  user = \"${aws_iam_user.user.name}\"\n"], [28, "\n"], [29, "  policy = <<EOF\n"], [30, "{\n"], [31, "  \"Version\": \"2012-10-17\",\n"], [32, "  \"Statement\": [\n"], [33, "    {\n"], [34, "      \"Action\": [\n"], [35, "        \"ec2:*\",\n"], [36, "        \"s3:*\",\n"], [37, "        \"lambda:*\",\n"], [38, "        \"cloudwatch:*\"\n"], [39, "      ],\n"], [40, "      \"Effect\": \"Allow\",\n"], [41, "      \"Resource\": \"*\"\n"], [42, "    }\n"], [43, "  ]\n"], [44, "}\n"], [45, "EOF\n"], [46, "}\n"]], "file_path": "/terraform/aws/iam.tf", "file_abs_path": "/terraform/terraform/aws/iam.tf", "repo_file_path": "/terraform/aws/iam.tf", "file_line_range": [25, 46], "resource": "aws_iam_user_policy.userpolicy", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/iam.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"user": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_iam_user.user", "path": "/terraform/terraform/aws/iam.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_key_rotation"]}, "code_block": [[1, "resource \"aws_kms_key\" \"logs_key\" {\n"], [2, "  # key does not have rotation enabled\n"], [3, "  description = \"${local.resource_prefix.value}-logs bucket key\"\n"], [4, "\n"], [5, "  deletion_window_in_days = 7\n"], [6, "  tags = {\n"], [7, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [8, "    git_file             = \"terraform/aws/kms.tf\"\n"], [9, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [10, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [11, "    git_modifiers        = \"nimrodkor\"\n"], [12, "    git_org              = \"bridgecrewio\"\n"], [13, "    git_repo             = \"terragoat\"\n"], [14, "    yor_trace            = \"cd8fa2a7-4868-4cd1-993d-da4644808ce5\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/kms.tf", "file_abs_path": "/terraform/terraform/aws/kms.tf", "repo_file_path": "/terraform/aws/kms.tf", "file_line_range": [1, 16], "resource": "aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/kms.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "cd8fa2a7-4868-4cd1-993d-da4644808ce5"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/logging-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/kms.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["dead_letter_config/[0]/target_arn"]}, "code_block": [[32, "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"], [33, "  # lambda have plain text secrets in environment variables\n"], [34, "  filename      = \"resources/lambda_function_payload.zip\"\n"], [35, "  function_name = \"${local.resource_prefix.value}-analysis\"\n"], [36, "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"], [37, "  handler       = \"exports.test\"\n"], [38, "\n"], [39, "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"], [40, "\n"], [41, "  runtime = \"nodejs12.x\"\n"], [42, "\n"], [43, "  environment {\n"], [44, "    variables = {\n"], [45, "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"], [46, "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"], [47, "    }\n"], [48, "  }\n"], [49, "  tags = {\n"], [50, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [51, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [52, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [53, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [54, "    git_modifiers        = \"nimrodkor\"\n"], [55, "    git_org              = \"bridgecrewio\"\n"], [56, "    git_repo             = \"terragoat\"\n"], [57, "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"], [58, "  }\n"], [59, "}"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [32, 59], "resource": "aws_lambda_function.analysis_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"function_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_272", "bc_check_id": null, "check_name": "Ensure AWS Lambda function is configured to validate code-signing", "check_result": {"result": "FAILED", "evaluated_keys": ["code_signing_config_arn"]}, "code_block": [[32, "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"], [33, "  # lambda have plain text secrets in environment variables\n"], [34, "  filename      = \"resources/lambda_function_payload.zip\"\n"], [35, "  function_name = \"${local.resource_prefix.value}-analysis\"\n"], [36, "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"], [37, "  handler       = \"exports.test\"\n"], [38, "\n"], [39, "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"], [40, "\n"], [41, "  runtime = \"nodejs12.x\"\n"], [42, "\n"], [43, "  environment {\n"], [44, "    variables = {\n"], [45, "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"], [46, "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"], [47, "    }\n"], [48, "  }\n"], [49, "  tags = {\n"], [50, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [51, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [52, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [53, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [54, "    git_modifiers        = \"nimrodkor\"\n"], [55, "    git_org              = \"bridgecrewio\"\n"], [56, "    git_repo             = \"terragoat\"\n"], [57, "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"], [58, "  }\n"], [59, "}"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [32, 59], "resource": "aws_lambda_function.analysis_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaCodeSigningConfigured", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"function_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "FAILED", "evaluated_keys": ["environment/[0]/variables"]}, "code_block": [[32, "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"], [33, "  # lambda have plain text secrets in environment variables\n"], [34, "  filename      = \"resources/lambda_function_payload.zip\"\n"], [35, "  function_name = \"${local.resource_prefix.value}-analysis\"\n"], [36, "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"], [37, "  handler       = \"exports.test\"\n"], [38, "\n"], [39, "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"], [40, "\n"], [41, "  runtime = \"nodejs12.x\"\n"], [42, "\n"], [43, "  environment {\n"], [44, "    variables = {\n"], [45, "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"], [46, "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"], [47, "    }\n"], [48, "  }\n"], [49, "  tags = {\n"], [50, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [51, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [52, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [53, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [54, "    git_modifiers        = \"nimrodkor\"\n"], [55, "    git_org              = \"bridgecrewio\"\n"], [56, "    git_repo             = \"terragoat\"\n"], [57, "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"], [58, "  }\n"], [59, "}"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [32, 59], "resource": "aws_lambda_function.analysis_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"function_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "FAILED", "evaluated_keys": ["environment/[0]/variables/[0]/secret_key", "environment/[0]/variables/[0]/access_key"]}, "code_block": [[32, "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"], [33, "  # lambda have plain text secrets in environment variables\n"], [34, "  filename      = \"resources/lambda_function_payload.zip\"\n"], [35, "  function_name = \"${local.resource_prefix.value}-analysis\"\n"], [36, "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"], [37, "  handler       = \"exports.test\"\n"], [38, "\n"], [39, "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"], [40, "\n"], [41, "  runtime = \"nodejs12.x\"\n"], [42, "\n"], [43, "  environment {\n"], [44, "    variables = {\n"], [45, "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"], [46, "      secret_key = \"wJalrX**********************************\"\n"], [47, "    }\n"], [48, "  }\n"], [49, "  tags = {\n"], [50, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [51, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [52, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [53, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [54, "    git_modifiers        = \"nimrodkor\"\n"], [55, "    git_org              = \"bridgecrewio\"\n"], [56, "    git_repo             = \"terragoat\"\n"], [57, "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"], [58, "  }\n"], [59, "}"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [32, 59], "resource": "aws_lambda_function.analysis_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"function_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["reserved_concurrent_executions/[0]"]}, "code_block": [[32, "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"], [33, "  # lambda have plain text secrets in environment variables\n"], [34, "  filename      = \"resources/lambda_function_payload.zip\"\n"], [35, "  function_name = \"${local.resource_prefix.value}-analysis\"\n"], [36, "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"], [37, "  handler       = \"exports.test\"\n"], [38, "\n"], [39, "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"], [40, "\n"], [41, "  runtime = \"nodejs12.x\"\n"], [42, "\n"], [43, "  environment {\n"], [44, "    variables = {\n"], [45, "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"], [46, "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"], [47, "    }\n"], [48, "  }\n"], [49, "  tags = {\n"], [50, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [51, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [52, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [53, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [54, "    git_modifiers        = \"nimrodkor\"\n"], [55, "    git_org              = \"bridgecrewio\"\n"], [56, "    git_repo             = \"terragoat\"\n"], [57, "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"], [58, "  }\n"], [59, "}"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [32, 59], "resource": "aws_lambda_function.analysis_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"function_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_50", "bc_check_id": "BC_AWS_SERVERLESS_4", "check_name": "X-ray tracing is enabled for Lambda", "check_result": {"result": "FAILED", "evaluated_keys": ["tracing_config/[0]/mode"]}, "code_block": [[32, "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"], [33, "  # lambda have plain text secrets in environment variables\n"], [34, "  filename      = \"resources/lambda_function_payload.zip\"\n"], [35, "  function_name = \"${local.resource_prefix.value}-analysis\"\n"], [36, "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"], [37, "  handler       = \"exports.test\"\n"], [38, "\n"], [39, "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"], [40, "\n"], [41, "  runtime = \"nodejs12.x\"\n"], [42, "\n"], [43, "  environment {\n"], [44, "    variables = {\n"], [45, "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"], [46, "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"], [47, "    }\n"], [48, "  }\n"], [49, "  tags = {\n"], [50, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [51, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [52, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [53, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [54, "    git_modifiers        = \"nimrodkor\"\n"], [55, "    git_org              = \"bridgecrewio\"\n"], [56, "    git_repo             = \"terragoat\"\n"], [57, "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"], [58, "  }\n"], [59, "}"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [32, 59], "resource": "aws_lambda_function.analysis_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaXrayEnabled", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"function_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["vpc_config"]}, "code_block": [[32, "resource \"aws_lambda_function\" \"analysis_lambda\" {\n"], [33, "  # lambda have plain text secrets in environment variables\n"], [34, "  filename      = \"resources/lambda_function_payload.zip\"\n"], [35, "  function_name = \"${local.resource_prefix.value}-analysis\"\n"], [36, "  role          = \"${aws_iam_role.iam_for_lambda.arn}\"\n"], [37, "  handler       = \"exports.test\"\n"], [38, "\n"], [39, "  source_code_hash = \"${filebase64sha256(\"resources/lambda_function_payload.zip\")}\"\n"], [40, "\n"], [41, "  runtime = \"nodejs12.x\"\n"], [42, "\n"], [43, "  environment {\n"], [44, "    variables = {\n"], [45, "      access_key = \"AKIAIOSFODNN7EXAMPLE\"\n"], [46, "      secret_key = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"\n"], [47, "    }\n"], [48, "  }\n"], [49, "  tags = {\n"], [50, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [51, "    git_file             = \"terraform/aws/lambda.tf\"\n"], [52, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [53, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [54, "    git_modifiers        = \"nimrodkor\"\n"], [55, "    git_org              = \"bridgecrewio\"\n"], [56, "    git_repo             = \"terragoat\"\n"], [57, "    yor_trace            = \"f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e\"\n"], [58, "  }\n"], [59, "}"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [32, 59], "resource": "aws_lambda_function.analysis_lambda", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/aws/lambda.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f7d8bc47-e5d9-4b09-9d8f-e7b9724d826e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/lambda.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"function_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_44", "bc_check_id": "BC_AWS_GENERAL_18", "check_name": "Ensure Neptune storage is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[1, "resource \"aws_neptune_cluster\" \"default\" {\n"], [2, "  cluster_identifier                  = var.neptune-dbname\n"], [3, "  engine                              = \"neptune\"\n"], [4, "  backup_retention_period             = 5\n"], [5, "  preferred_backup_window             = \"07:00-09:00\"\n"], [6, "  skip_final_snapshot                 = true\n"], [7, "  iam_database_authentication_enabled = false\n"], [8, "  apply_immediately                   = true\n"], [9, "  storage_encrypted                   = false\n"], [10, "  tags = {\n"], [11, "    git_commit           = \"aa8fd16fd94cccf6af206e2f0922b5558f8ac514\"\n"], [12, "    git_file             = \"terraform/aws/neptune.tf\"\n"], [13, "    git_last_modified_at = \"2020-08-21 19:14:35\"\n"], [14, "    git_last_modified_by = \"matt@bridgecrew.io\"\n"], [15, "    git_modifiers        = \"matt\"\n"], [16, "    git_org              = \"bridgecrewio\"\n"], [17, "    git_repo             = \"terragoat\"\n"], [18, "    yor_trace            = \"0d4cbb85-73ed-4ca0-b1da-296e4185f34e\"\n"], [19, "  }\n"], [20, "}\n"]], "file_path": "/terraform/aws/neptune.tf", "file_abs_path": "/terraform/terraform/aws/neptune.tf", "repo_file_path": "/terraform/aws/neptune.tf", "file_line_range": [1, 20], "resource": "aws_neptune_cluster.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterStorageEncrypted", "fixed_definition": null, "entity_tags": {"git_commit": "aa8fd16fd94cccf6af206e2f0922b5558f8ac514", "git_file": "terraform/aws/neptune.tf", "git_last_modified_at": "2020-08-21 19:14:35", "git_last_modified_by": "matt@bridgecrew.io", "git_modifiers": "matt", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0d4cbb85-73ed-4ca0-b1da-296e4185f34e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/general-18.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/neptune.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cluster_identifier": [{"type": "variable", "name": "neptune-dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_101", "bc_check_id": "BC_AWS_LOGGING_24", "check_name": "Ensure Neptune logging is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_cloudwatch_logs_exports"]}, "code_block": [[1, "resource \"aws_neptune_cluster\" \"default\" {\n"], [2, "  cluster_identifier                  = var.neptune-dbname\n"], [3, "  engine                              = \"neptune\"\n"], [4, "  backup_retention_period             = 5\n"], [5, "  preferred_backup_window             = \"07:00-09:00\"\n"], [6, "  skip_final_snapshot                 = true\n"], [7, "  iam_database_authentication_enabled = false\n"], [8, "  apply_immediately                   = true\n"], [9, "  storage_encrypted                   = false\n"], [10, "  tags = {\n"], [11, "    git_commit           = \"aa8fd16fd94cccf6af206e2f0922b5558f8ac514\"\n"], [12, "    git_file             = \"terraform/aws/neptune.tf\"\n"], [13, "    git_last_modified_at = \"2020-08-21 19:14:35\"\n"], [14, "    git_last_modified_by = \"matt@bridgecrew.io\"\n"], [15, "    git_modifiers        = \"matt\"\n"], [16, "    git_org              = \"bridgecrewio\"\n"], [17, "    git_repo             = \"terragoat\"\n"], [18, "    yor_trace            = \"0d4cbb85-73ed-4ca0-b1da-296e4185f34e\"\n"], [19, "  }\n"], [20, "}\n"]], "file_path": "/terraform/aws/neptune.tf", "file_abs_path": "/terraform/terraform/aws/neptune.tf", "repo_file_path": "/terraform/aws/neptune.tf", "file_line_range": [1, 20], "resource": "aws_neptune_cluster.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "aa8fd16fd94cccf6af206e2f0922b5558f8ac514", "git_file": "terraform/aws/neptune.tf", "git_last_modified_at": "2020-08-21 19:14:35", "git_last_modified_by": "matt@bridgecrew.io", "git_modifiers": "matt", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0d4cbb85-73ed-4ca0-b1da-296e4185f34e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/bc-aws-logging-24.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/neptune.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cluster_identifier": [{"type": "variable", "name": "neptune-dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_347", "bc_check_id": null, "check_name": "Ensure Neptune is encrypted by KMS using a customer managed Key (CMK)", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_arn"]}, "code_block": [[1, "resource \"aws_neptune_cluster\" \"default\" {\n"], [2, "  cluster_identifier                  = var.neptune-dbname\n"], [3, "  engine                              = \"neptune\"\n"], [4, "  backup_retention_period             = 5\n"], [5, "  preferred_backup_window             = \"07:00-09:00\"\n"], [6, "  skip_final_snapshot                 = true\n"], [7, "  iam_database_authentication_enabled = false\n"], [8, "  apply_immediately                   = true\n"], [9, "  storage_encrypted                   = false\n"], [10, "  tags = {\n"], [11, "    git_commit           = \"aa8fd16fd94cccf6af206e2f0922b5558f8ac514\"\n"], [12, "    git_file             = \"terraform/aws/neptune.tf\"\n"], [13, "    git_last_modified_at = \"2020-08-21 19:14:35\"\n"], [14, "    git_last_modified_by = \"matt@bridgecrew.io\"\n"], [15, "    git_modifiers        = \"matt\"\n"], [16, "    git_org              = \"bridgecrewio\"\n"], [17, "    git_repo             = \"terragoat\"\n"], [18, "    yor_trace            = \"0d4cbb85-73ed-4ca0-b1da-296e4185f34e\"\n"], [19, "  }\n"], [20, "}\n"]], "file_path": "/terraform/aws/neptune.tf", "file_abs_path": "/terraform/terraform/aws/neptune.tf", "repo_file_path": "/terraform/aws/neptune.tf", "file_line_range": [1, 20], "resource": "aws_neptune_cluster.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "aa8fd16fd94cccf6af206e2f0922b5558f8ac514", "git_file": "terraform/aws/neptune.tf", "git_last_modified_at": "2020-08-21 19:14:35", "git_last_modified_by": "matt@bridgecrew.io", "git_modifiers": "matt", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0d4cbb85-73ed-4ca0-b1da-296e4185f34e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/neptune.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"cluster_identifier": [{"type": "variable", "name": "neptune-dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_280", "bc_check_id": null, "check_name": "Ensure Neptune snapshot is encrypted by KMS using a customer managed Key (CMK)", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[41, "resource \"aws_neptune_cluster_snapshot\" \"default\" {\n"], [42, "  db_cluster_identifier          = aws_neptune_cluster.default.id\n"], [43, "  db_cluster_snapshot_identifier = \"resourcetestsnapshot1\"\n"], [44, "}\n"]], "file_path": "/terraform/aws/neptune.tf", "file_abs_path": "/terraform/terraform/aws/neptune.tf", "repo_file_path": "/terraform/aws/neptune.tf", "file_line_range": [41, 44], "resource": "aws_neptune_cluster_snapshot.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterSnapshotEncryptedWithCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/neptune.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_279", "bc_check_id": null, "check_name": "Ensure Neptune snapshot is securely encrypted", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[41, "resource \"aws_neptune_cluster_snapshot\" \"default\" {\n"], [42, "  db_cluster_identifier          = aws_neptune_cluster.default.id\n"], [43, "  db_cluster_snapshot_identifier = \"resourcetestsnapshot1\"\n"], [44, "}\n"]], "file_path": "/terraform/aws/neptune.tf", "file_abs_path": "/terraform/terraform/aws/neptune.tf", "repo_file_path": "/terraform/aws/neptune.tf", "file_line_range": [41, 44], "resource": "aws_neptune_cluster_snapshot.default", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.NeptuneClusterSnapshotEncrypted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/neptune.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_41", "bc_check_id": "BC_AWS_SECRETS_5", "check_name": "Ensure no hard coded AWS access key and secret key exists in provider", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[7, "provider \"aws\" {\n"], [8, "  alias      = \"plain_text_access_keys_provider\"\n"], [9, "  region     = \"us-west-1\"\n"], [10, "  access_key = \"AKIAI***************\"\n"], [11, "  secret_key = \"wJalrX**********************************\"\n"], [12, "}\n"]], "file_path": "/terraform/aws/providers.tf", "file_abs_path": "/terraform/terraform/aws/providers.tf", "repo_file_path": "/terraform/aws/providers.tf", "file_line_range": [7, 12], "resource": "aws.plain_text_access_keys_provider", "evaluations": null, "check_class": "checkov.terraform.checks.provider.aws.credentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/secrets-policies/bc-aws-secrets-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/providers.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_133", "bc_check_id": "BC_AWS_GENERAL_46", "check_name": "Ensure that RDS instances has backup policy", "check_result": {"result": "FAILED", "evaluated_keys": ["backup_retention_period"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.DBInstanceBackupRetentionPeriod", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-instances-have-backup-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_313", "bc_check_id": null, "check_name": "Ensure RDS cluster configured to copy tags to snapshots", "check_result": {"result": "FAILED", "evaluated_keys": ["copy_tags_to_snapshot"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterCopyTags", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_96", "bc_check_id": "BC_AWS_GENERAL_38", "check_name": "Ensure all data stored in Aurora is securely encrypted at rest", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_encrypted"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.AuroraEncryption", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-38.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_162", "bc_check_id": "BC_AWS_IAM_66", "check_name": "Ensure RDS cluster has IAM authentication enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["iam_database_authentication_enabled"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterIAMAuthentication", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-rds-cluster-has-iam-authentication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_327", "bc_check_id": null, "check_name": "Ensure RDS Clusters are encrypted using KMS CMKs", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_325", "bc_check_id": null, "check_name": "Ensure that RDS Cluster audit logging is enabled for MySQL engine", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuditLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_326", "bc_check_id": null, "check_name": "Ensure that RDS Aurora Clusters have backtracking enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["backtrack_window"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterAuroraBacktrack", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_324", "bc_check_id": null, "check_name": "Ensure that RDS Cluster log capture is enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled_cloudwatch_logs_exports/[0]"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSClusterLogging", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_139", "bc_check_id": "BC_AWS_GENERAL_69", "check_name": "Ensure that RDS clusters have deletion protection enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["deletion_protection"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.RDSDeletionProtection", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-and-instances-have-deletion-protection-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/rds.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AWS_186", "bc_check_id": "BC_AWS_GENERAL_106", "check_name": "Ensure S3 bucket Object is encrypted by KMS using a customer managed Key (CMK)", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[23, "resource \"aws_s3_bucket_object\" \"data_object\" {\n"], [24, "  bucket = aws_s3_bucket.data.id\n"], [25, "  key    = \"customer-master.xlsx\"\n"], [26, "  source = \"resources/customer-master.xlsx\"\n"], [27, "  tags = merge({\n"], [28, "    Name        = \"${local.resource_prefix.value}-customer-master\"\n"], [29, "    Environment = local.resource_prefix.value\n"], [30, "    }, {\n"], [31, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [32, "    git_file             = \"terraform/aws/s3.tf\"\n"], [33, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [34, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [35, "    git_modifiers        = \"nimrodkor\"\n"], [36, "    git_org              = \"bridgecrewio\"\n"], [37, "    git_repo             = \"terragoat\"\n"], [38, "    yor_trace            = \"a7f01cc7-63c2-41a8-8555-6665e5e39a64\"\n"], [39, "  })\n"], [40, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [23, 40], "resource": "aws_s3_bucket_object.data_object", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.S3BucketObjectEncryptedWithCMK", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-customer-master", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "a7f01cc7-63c2-41a8-8555-6665e5e39a64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/bc-aws-general-106.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/aws/s3.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_115", "bc_check_id": "BC_AZR_KUBERNETES_6", "check_name": "Ensure that AKS enables private clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["private_cluster_enabled"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSEnablesPrivateClusters", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-enables-private-clusters.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_7", "bc_check_id": "BC_AZR_KUBERNETES_4", "check_name": "Ensure AKS cluster has Network Policy configured", "check_result": {"result": "FAILED", "evaluated_keys": ["network_profile/[0]/network_policy"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSNetworkPolicy", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_8", "bc_check_id": "BC_AZR_KUBERNETES_5", "check_name": "Ensure Kubernetes Dashboard is disabled", "check_result": {"result": "FAILED", "evaluated_keys": ["addon_profile/kube_dashboard", "addon_profile/kube_dashboard/[0]/enabled"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSDashboardDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_116", "bc_check_id": "BC_AZR_KUBERNETES_7", "check_name": "Ensure that AKS uses Azure Policies Add-on", "check_result": {"result": "FAILED", "evaluated_keys": ["addon_profile/[0]/azure_policy/[0]/enabled"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSUsesAzurePoliciesAddon", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-azure-policies-add-on.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_141", "bc_check_id": "BC_AZR_IAM_3", "check_name": "Ensure AKS local admin account is disabled", "check_result": {"result": "FAILED", "evaluated_keys": ["local_account_disabled"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSLocalAdminDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_5", "bc_check_id": "BC_AZR_KUBERNETES_2", "check_name": "Ensure RBAC is enabled on AKS clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["role_based_access_control/[0]/enabled", "role_based_access_control_enabled"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSRbacEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_117", "bc_check_id": "BC_AZR_KUBERNETES_8", "check_name": "Ensure that AKS uses disk encryption set", "check_result": {"result": "FAILED", "evaluated_keys": ["disk_encryption_set_id"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSUsesDiskEncryptionSet", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-disk-encryption-set.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_168", "bc_check_id": null, "check_name": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods.", "check_result": {"result": "FAILED", "evaluated_keys": ["default_node_pool/max_pods"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSMaxPodsMinimum", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_6", "bc_check_id": "BC_AZR_KUBERNETES_3", "check_name": "Ensure AKS has an API Server Authorized IP Ranges enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["api_server_access_profile/[0]/authorized_ip_ranges/[0]"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSApiServerAuthorizedIpRanges", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_170", "bc_check_id": null, "check_name": "Ensure that AKS use the Paid Sku for its SLA", "check_result": {"result": "FAILED", "evaluated_keys": ["sku_tier"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSIsPaidSku", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_4", "bc_check_id": "BC_AZR_KUBERNETES_1", "check_name": "Ensure AKS logging to Azure Monitoring is Configured", "check_result": {"result": "FAILED", "evaluated_keys": ["addon_profile/[0]/oms_agent/[0]/enabled"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSLoggingEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_172", "bc_check_id": null, "check_name": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["key_vault_secrets_provider/secret_rotation_enabled"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSSecretStoreRotation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_171", "bc_check_id": null, "check_name": "Ensure AKS cluster upgrade channel is chosen", "check_result": {"result": "FAILED", "evaluated_keys": ["automatic_channel_upgrade"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AKSUpgradeChannel", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/aks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_65", "bc_check_id": "BC_AZR_LOGGING_9", "check_name": "Ensure that App service enables detailed error messages", "check_result": {"result": "FAILED", "evaluated_keys": ["logs/[0]/detailed_error_messages_enabled"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceDetailedErrorMessagesEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/tbdensure-that-app-service-enables-detailed-error-messages.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_88", "bc_check_id": "BC_AZR_GENERAL_65", "check_name": "Ensure that app services use Azure Files", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_account/[0]/type"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceUsedAzureFiles", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-app-services-use-azure-files.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_16", "bc_check_id": "BC_AZR_IAM_1", "check_name": "Ensure that Register with Azure Active Directory is enabled on App Service", "check_result": {"result": "FAILED", "evaluated_keys": ["identity"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/bc-azr-iam-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_63", "bc_check_id": "BC_AZR_LOGGING_8", "check_name": "Ensure that App service enables HTTP logging", "check_result": {"result": "FAILED", "evaluated_keys": ["logs/[0]/http_logs"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceHttpLoggingEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-http-logging.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_14", "bc_check_id": "BC_AZR_NETWORKING_5", "check_name": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service", "check_result": {"result": "FAILED", "evaluated_keys": ["https_only/[0]"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceHTTPSOnly", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_15", "bc_check_id": "BC_AZR_NETWORKING_6", "check_name": "Ensure web app is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["site_config/[0]/min_tls_version/[0]"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_78", "bc_check_id": "BC_AZR_GENERAL_15", "check_name": "Ensure FTP deployments are disabled", "check_result": {"result": "FAILED", "evaluated_keys": ["site_config/0/ftps_state"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceFTPSState", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-ftp-deployments-are-disabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_18", "bc_check_id": "BC_AZR_NETWORKING_8", "check_name": "Ensure that 'HTTP Version' is the latest if used to run the web app", "check_result": {"result": "FAILED", "evaluated_keys": ["site_config/[0]/http2_enabled"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceHttps20Enabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_213", "bc_check_id": null, "check_name": "Ensure that App Service configures health check", "check_result": {"result": "FAILED", "evaluated_keys": ["site_config/[0]/health_check_path"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceSetHealthCheck", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_71", "bc_check_id": "BC_AZR_GENERAL_54", "check_name": "Ensure that Managed identity provider is enabled for app services", "check_result": {"result": "FAILED", "evaluated_keys": ["identity/[0]/type"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceIdentityProviderEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-managed-identity-provider-is-enabled-for-app-services.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_66", "bc_check_id": "BC_AZR_LOGGING_10", "check_name": "Ensure that App service enables failed request tracing", "check_result": {"result": "FAILED", "evaluated_keys": ["logs/[0]/failed_request_tracing_enabled"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceEnableFailedRequest", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-failed-request-tracing.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_13", "bc_check_id": "BC_AZR_GENERAL_2", "check_name": "Ensure App Service Authentication is set on Azure App Service", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceAuthentication", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_17", "bc_check_id": "BC_AZR_NETWORKING_7", "check_name": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set", "check_result": {"result": "FAILED", "evaluated_keys": ["client_cert_enabled/[0]"]}, "code_block": [[22, "resource azurerm_app_service \"app-service1\" {\n"], [23, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [24, "  location            = var.location\n"], [25, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [26, "  resource_group_name = azurerm_resource_group.example.name\n"], [27, "  https_only          = false\n"], [28, "  site_config {\n"], [29, "    min_tls_version = \"1.1\"\n"], [30, "  }\n"], [31, "  tags = {\n"], [32, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [33, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [34, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [35, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [36, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [37, "    git_org              = \"bridgecrewio\"\n"], [38, "    git_repo             = \"terragoat\"\n"], [39, "    yor_trace            = \"13be096d-c599-46e5-bf54-51c6e9732858\"\n"], [40, "  }\n"], [41, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [22, 41], "resource": "azurerm_app_service.app-service1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceClientCertificate", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_65", "bc_check_id": "BC_AZR_LOGGING_9", "check_name": "Ensure that App service enables detailed error messages", "check_result": {"result": "FAILED", "evaluated_keys": ["logs/[0]/detailed_error_messages_enabled"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceDetailedErrorMessagesEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/tbdensure-that-app-service-enables-detailed-error-messages.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_88", "bc_check_id": "BC_AZR_GENERAL_65", "check_name": "Ensure that app services use Azure Files", "check_result": {"result": "FAILED", "evaluated_keys": ["storage_account/[0]/type"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceUsedAzureFiles", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-app-services-use-azure-files.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_16", "bc_check_id": "BC_AZR_IAM_1", "check_name": "Ensure that Register with Azure Active Directory is enabled on App Service", "check_result": {"result": "FAILED", "evaluated_keys": ["identity"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceIdentity", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/bc-azr-iam-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_63", "bc_check_id": "BC_AZR_LOGGING_8", "check_name": "Ensure that App service enables HTTP logging", "check_result": {"result": "FAILED", "evaluated_keys": ["logs/[0]/http_logs"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceHttpLoggingEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-http-logging.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_78", "bc_check_id": "BC_AZR_GENERAL_15", "check_name": "Ensure FTP deployments are disabled", "check_result": {"result": "FAILED", "evaluated_keys": ["site_config/0/ftps_state"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceFTPSState", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-ftp-deployments-are-disabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_18", "bc_check_id": "BC_AZR_NETWORKING_8", "check_name": "Ensure that 'HTTP Version' is the latest if used to run the web app", "check_result": {"result": "FAILED", "evaluated_keys": ["site_config/[0]/http2_enabled"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceHttps20Enabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_213", "bc_check_id": null, "check_name": "Ensure that App Service configures health check", "check_result": {"result": "FAILED", "evaluated_keys": ["site_config/[0]/health_check_path"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceSetHealthCheck", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_71", "bc_check_id": "BC_AZR_GENERAL_54", "check_name": "Ensure that Managed identity provider is enabled for app services", "check_result": {"result": "FAILED", "evaluated_keys": ["identity/[0]/type"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceIdentityProviderEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-managed-identity-provider-is-enabled-for-app-services.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_66", "bc_check_id": "BC_AZR_LOGGING_10", "check_name": "Ensure that App service enables failed request tracing", "check_result": {"result": "FAILED", "evaluated_keys": ["logs/[0]/failed_request_tracing_enabled"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceEnableFailedRequest", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-that-app-service-enables-failed-request-tracing.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_13", "bc_check_id": "BC_AZR_GENERAL_2", "check_name": "Ensure App Service Authentication is set on Azure App Service", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceAuthentication", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_17", "bc_check_id": "BC_AZR_NETWORKING_7", "check_name": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set", "check_result": {"result": "FAILED", "evaluated_keys": ["client_cert_enabled/[0]"]}, "code_block": [[43, "resource azurerm_app_service \"app-service2\" {\n"], [44, "  app_service_plan_id = azurerm_app_service_plan.example.id\n"], [45, "  location            = var.location\n"], [46, "  name                = \"terragoat-app-service-${var.environment}${random_integer.rnd_int.result}\"\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "  https_only          = true\n"], [49, "\n"], [50, "  auth_settings {\n"], [51, "    enabled = false\n"], [52, "  }\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [55, "    git_file             = \"terraform/azure/app_service.tf\"\n"], [56, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [57, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [58, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [59, "    git_org              = \"bridgecrewio\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"ec8295ab-af68-4cff-b0f1-b0cf5eaf1b75\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/azure/app_service.tf", "file_abs_path": "/terraform/terraform/azure/app_service.tf", "repo_file_path": "/terraform/azure/app_service.tf", "file_line_range": [43, 63], "resource": "azurerm_app_service.app-service2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceClientCertificate", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/app_service.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_217", "bc_check_id": null, "check_name": "Ensure Azure Application gateways listener that allow connection requests over HTTP", "check_result": {"result": "FAILED", "evaluated_keys": ["http_listener/[0]/protocol"]}, "code_block": [[1, "resource \"azurerm_application_gateway\" \"network\" {\n"], [2, "  name                = \"example-appgateway\"\n"], [3, "  resource_group_name = \"example-resourceGroup\"\n"], [4, "  location            = \"example --West-US\"\n"], [5, "\n"], [6, "  sku {\n"], [7, "    name     = \"Standard_Small\"\n"], [8, "    tier     = \"Standard\"\n"], [9, "    capacity = 2\n"], [10, "  }\n"], [11, "\n"], [12, "  gateway_ip_configuration {\n"], [13, "    name      = \"my-gateway-ip-configuration\"\n"], [14, "    subnet_id = \"your subnet id\"\n"], [15, "  }\n"], [16, "\n"], [17, "  frontend_port {\n"], [18, "    name = \"name\"\n"], [19, "    port = \"port-no\"\n"], [20, "  }\n"], [21, "  ####Missing WAF block: As per azure best practices, it is important to have a web application firewall enabled at application gateway.\n"], [22, "\n"], [23, "\n"], [24, "  frontend_ip_configuration {\n"], [25, "    name                 = \"name\"\n"], [26, "    public_ip_address_id = \"Ip-address\"\n"], [27, "  }\n"], [28, "\n"], [29, "  backend_address_pool {\n"], [30, "    name = local.backend_address_pool_name\n"], [31, "  }\n"], [32, "\n"], [33, "  backend_http_settings {\n"], [34, "    name                  = local.http_setting_name\n"], [35, "    cookie_based_affinity = \"Disabled\"\n"], [36, "    path                  = \"/path1/\"\n"], [37, "    port                  = 80\n"], [38, "    protocol              = \"Http\"\n"], [39, "    request_timeout       = 60\n"], [40, "  }\n"], [41, "\n"], [42, "  http_listener {\n"], [43, "    name                           = local.listener_name\n"], [44, "    frontend_ip_configuration_name = local.frontend_ip_configuration_name\n"], [45, "    frontend_port_name             = local.frontend_port_name\n"], [46, "    protocol                       = \"Http\"\n"], [47, "  }\n"], [48, "\n"], [49, "  request_routing_rule {\n"], [50, "    name                       = local.request_routing_rule_name\n"], [51, "    rule_type                  = \"Basic\"\n"], [52, "    http_listener_name         = local.listener_name\n"], [53, "    backend_address_pool_name  = local.backend_address_pool_name\n"], [54, "    backend_http_settings_name = local.http_setting_name\n"], [55, "  }\n"], [56, "  tags = {\n"], [57, "    git_commit           = \"b07a42ebd74b8f0ba647e20b872474b1c29b4814\"\n"], [58, "    git_file             = \"terraform/azure/application_gateway.tf\"\n"], [59, "    git_last_modified_at = \"2021-05-02 10:08:55\"\n"], [60, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [61, "    git_modifiers        = \"harkiratbhardwaj/nimrodkor\"\n"], [62, "    git_org              = \"bridgecrewio\"\n"], [63, "    git_repo             = \"terragoat\"\n"], [64, "    yor_trace            = \"3f62753b-3d20-4fa7-b402-b780234a14d8\"\n"], [65, "  }\n"], [66, "}\n"]], "file_path": "/terraform/azure/application_gateway.tf", "file_abs_path": "/terraform/terraform/azure/application_gateway.tf", "repo_file_path": "/terraform/azure/application_gateway.tf", "file_line_range": [1, 66], "resource": "azurerm_application_gateway.network", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppGWUsesHttps", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/application_gateway.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_218", "bc_check_id": null, "check_name": "Ensure Application Gateway defines secure protocols for in transit communication", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[1, "resource \"azurerm_application_gateway\" \"network\" {\n"], [2, "  name                = \"example-appgateway\"\n"], [3, "  resource_group_name = \"example-resourceGroup\"\n"], [4, "  location            = \"example --West-US\"\n"], [5, "\n"], [6, "  sku {\n"], [7, "    name     = \"Standard_Small\"\n"], [8, "    tier     = \"Standard\"\n"], [9, "    capacity = 2\n"], [10, "  }\n"], [11, "\n"], [12, "  gateway_ip_configuration {\n"], [13, "    name      = \"my-gateway-ip-configuration\"\n"], [14, "    subnet_id = \"your subnet id\"\n"], [15, "  }\n"], [16, "\n"], [17, "  frontend_port {\n"], [18, "    name = \"name\"\n"], [19, "    port = \"port-no\"\n"], [20, "  }\n"], [21, "  ####Missing WAF block: As per azure best practices, it is important to have a web application firewall enabled at application gateway.\n"], [22, "\n"], [23, "\n"], [24, "  frontend_ip_configuration {\n"], [25, "    name                 = \"name\"\n"], [26, "    public_ip_address_id = \"Ip-address\"\n"], [27, "  }\n"], [28, "\n"], [29, "  backend_address_pool {\n"], [30, "    name = local.backend_address_pool_name\n"], [31, "  }\n"], [32, "\n"], [33, "  backend_http_settings {\n"], [34, "    name                  = local.http_setting_name\n"], [35, "    cookie_based_affinity = \"Disabled\"\n"], [36, "    path                  = \"/path1/\"\n"], [37, "    port                  = 80\n"], [38, "    protocol              = \"Http\"\n"], [39, "    request_timeout       = 60\n"], [40, "  }\n"], [41, "\n"], [42, "  http_listener {\n"], [43, "    name                           = local.listener_name\n"], [44, "    frontend_ip_configuration_name = local.frontend_ip_configuration_name\n"], [45, "    frontend_port_name             = local.frontend_port_name\n"], [46, "    protocol                       = \"Http\"\n"], [47, "  }\n"], [48, "\n"], [49, "  request_routing_rule {\n"], [50, "    name                       = local.request_routing_rule_name\n"], [51, "    rule_type                  = \"Basic\"\n"], [52, "    http_listener_name         = local.listener_name\n"], [53, "    backend_address_pool_name  = local.backend_address_pool_name\n"], [54, "    backend_http_settings_name = local.http_setting_name\n"], [55, "  }\n"], [56, "  tags = {\n"], [57, "    git_commit           = \"b07a42ebd74b8f0ba647e20b872474b1c29b4814\"\n"], [58, "    git_file             = \"terraform/azure/application_gateway.tf\"\n"], [59, "    git_last_modified_at = \"2021-05-02 10:08:55\"\n"], [60, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [61, "    git_modifiers        = \"harkiratbhardwaj/nimrodkor\"\n"], [62, "    git_org              = \"bridgecrewio\"\n"], [63, "    git_repo             = \"terragoat\"\n"], [64, "    yor_trace            = \"3f62753b-3d20-4fa7-b402-b780234a14d8\"\n"], [65, "  }\n"], [66, "}\n"]], "file_path": "/terraform/azure/application_gateway.tf", "file_abs_path": "/terraform/terraform/azure/application_gateway.tf", "repo_file_path": "/terraform/azure/application_gateway.tf", "file_line_range": [1, 66], "resource": "azurerm_application_gateway.network", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppGWDefinesSecureProtocols", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/application_gateway.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_178", "bc_check_id": null, "check_name": "Ensure linux VM enables SSH with keys for secure communication", "check_result": {"result": "FAILED", "evaluated_keys": ["admin_ssh_key/[0]/public_key"]}, "code_block": [[9, "resource azurerm_linux_virtual_machine \"linux_machine\" {\n"], [10, "  admin_username                  = \"terragoat-linux\"\n"], [11, "  admin_password                  = random_string.password.result\n"], [12, "  location                        = var.location\n"], [13, "  name                            = \"terragoat-linux\"\n"], [14, "  network_interface_ids           = [azurerm_network_interface.ni_linux.id]\n"], [15, "  resource_group_name             = azurerm_resource_group.example.name\n"], [16, "  size                            = \"Standard_F2\"\n"], [17, "  disable_password_authentication = false\n"], [18, "  source_image_reference {\n"], [19, "    publisher = \"Canonical\"\n"], [20, "    offer     = \"UbuntuServer\"\n"], [21, "    sku       = \"16.04-LTS\"\n"], [22, "    version   = \"latest\"\n"], [23, "  }\n"], [24, "  os_disk {\n"], [25, "    caching              = \"ReadWrite\"\n"], [26, "    storage_account_type = \"Standard_LRS\"\n"], [27, "  }\n"], [28, "\n"], [29, "  tags = merge({\n"], [30, "    terragoat   = true\n"], [31, "    environment = var.environment\n"], [32, "    }, {\n"], [33, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [34, "    git_file             = \"terraform/azure/instance.tf\"\n"], [35, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [36, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [37, "    git_modifiers        = \"nimrodkor\"\n"], [38, "    git_org              = \"bridgecrewio\"\n"], [39, "    git_repo             = \"terragoat\"\n"], [40, "    yor_trace            = \"736ef713-51b8-4178-ad69-406be81f6ef2\"\n"], [41, "  })\n"], [42, "}\n"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [9, 42], "resource": "azurerm_linux_virtual_machine.linux_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.LinuxVMUsesSSH", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_50", "bc_check_id": "BC_AZR_GENERAL_14", "check_name": "Ensure Virtual Machine Extensions are not Installed", "check_result": {"result": "FAILED", "evaluated_keys": ["allow_extension_operations"]}, "code_block": [[9, "resource azurerm_linux_virtual_machine \"linux_machine\" {\n"], [10, "  admin_username                  = \"terragoat-linux\"\n"], [11, "  admin_password                  = random_string.password.result\n"], [12, "  location                        = var.location\n"], [13, "  name                            = \"terragoat-linux\"\n"], [14, "  network_interface_ids           = [azurerm_network_interface.ni_linux.id]\n"], [15, "  resource_group_name             = azurerm_resource_group.example.name\n"], [16, "  size                            = \"Standard_F2\"\n"], [17, "  disable_password_authentication = false\n"], [18, "  source_image_reference {\n"], [19, "    publisher = \"Canonical\"\n"], [20, "    offer     = \"UbuntuServer\"\n"], [21, "    sku       = \"16.04-LTS\"\n"], [22, "    version   = \"latest\"\n"], [23, "  }\n"], [24, "  os_disk {\n"], [25, "    caching              = \"ReadWrite\"\n"], [26, "    storage_account_type = \"Standard_LRS\"\n"], [27, "  }\n"], [28, "\n"], [29, "  tags = merge({\n"], [30, "    terragoat   = true\n"], [31, "    environment = var.environment\n"], [32, "    }, {\n"], [33, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [34, "    git_file             = \"terraform/azure/instance.tf\"\n"], [35, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [36, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [37, "    git_modifiers        = \"nimrodkor\"\n"], [38, "    git_org              = \"bridgecrewio\"\n"], [39, "    git_repo             = \"terragoat\"\n"], [40, "    yor_trace            = \"736ef713-51b8-4178-ad69-406be81f6ef2\"\n"], [41, "  })\n"], [42, "}\n"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [9, 42], "resource": "azurerm_linux_virtual_machine.linux_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureInstanceExtensions", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-14.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_1", "bc_check_id": "BC_AZR_NETWORKING_1", "check_name": "Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)", "check_result": {"result": "FAILED", "evaluated_keys": ["disable_password_authentication"]}, "code_block": [[9, "resource azurerm_linux_virtual_machine \"linux_machine\" {\n"], [10, "  admin_username                  = \"terragoat-linux\"\n"], [11, "  admin_password                  = random_string.password.result\n"], [12, "  location                        = var.location\n"], [13, "  name                            = \"terragoat-linux\"\n"], [14, "  network_interface_ids           = [azurerm_network_interface.ni_linux.id]\n"], [15, "  resource_group_name             = azurerm_resource_group.example.name\n"], [16, "  size                            = \"Standard_F2\"\n"], [17, "  disable_password_authentication = false\n"], [18, "  source_image_reference {\n"], [19, "    publisher = \"Canonical\"\n"], [20, "    offer     = \"UbuntuServer\"\n"], [21, "    sku       = \"16.04-LTS\"\n"], [22, "    version   = \"latest\"\n"], [23, "  }\n"], [24, "  os_disk {\n"], [25, "    caching              = \"ReadWrite\"\n"], [26, "    storage_account_type = \"Standard_LRS\"\n"], [27, "  }\n"], [28, "\n"], [29, "  tags = merge({\n"], [30, "    terragoat   = true\n"], [31, "    environment = var.environment\n"], [32, "    }, {\n"], [33, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [34, "    git_file             = \"terraform/azure/instance.tf\"\n"], [35, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [36, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [37, "    git_modifiers        = \"nimrodkor\"\n"], [38, "    git_org              = \"bridgecrewio\"\n"], [39, "    git_repo             = \"terragoat\"\n"], [40, "    yor_trace            = \"736ef713-51b8-4178-ad69-406be81f6ef2\"\n"], [41, "  })\n"], [42, "}\n"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [9, 42], "resource": "azurerm_linux_virtual_machine.linux_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureInstancePassword", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_149", "bc_check_id": "BC_AZR_GENERAL_84", "check_name": "Ensure that Virtual machine does not enable password authentication", "check_result": {"result": "FAILED", "evaluated_keys": ["disable_password_authentication"]}, "code_block": [[9, "resource azurerm_linux_virtual_machine \"linux_machine\" {\n"], [10, "  admin_username                  = \"terragoat-linux\"\n"], [11, "  admin_password                  = random_string.password.result\n"], [12, "  location                        = var.location\n"], [13, "  name                            = \"terragoat-linux\"\n"], [14, "  network_interface_ids           = [azurerm_network_interface.ni_linux.id]\n"], [15, "  resource_group_name             = azurerm_resource_group.example.name\n"], [16, "  size                            = \"Standard_F2\"\n"], [17, "  disable_password_authentication = false\n"], [18, "  source_image_reference {\n"], [19, "    publisher = \"Canonical\"\n"], [20, "    offer     = \"UbuntuServer\"\n"], [21, "    sku       = \"16.04-LTS\"\n"], [22, "    version   = \"latest\"\n"], [23, "  }\n"], [24, "  os_disk {\n"], [25, "    caching              = \"ReadWrite\"\n"], [26, "    storage_account_type = \"Standard_LRS\"\n"], [27, "  }\n"], [28, "\n"], [29, "  tags = merge({\n"], [30, "    terragoat   = true\n"], [31, "    environment = var.environment\n"], [32, "    }, {\n"], [33, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [34, "    git_file             = \"terraform/azure/instance.tf\"\n"], [35, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [36, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [37, "    git_modifiers        = \"nimrodkor\"\n"], [38, "    git_org              = \"bridgecrewio\"\n"], [39, "    git_repo             = \"terragoat\"\n"], [40, "    yor_trace            = \"736ef713-51b8-4178-ad69-406be81f6ef2\"\n"], [41, "  })\n"], [42, "}\n"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [9, 42], "resource": "azurerm_linux_virtual_machine.linux_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.VMDisablePasswordAuthentication", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-azure-virtual-machine-does-not-enable-password-authentication.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_50", "bc_check_id": "BC_AZR_GENERAL_14", "check_name": "Ensure Virtual Machine Extensions are not Installed", "check_result": {"result": "FAILED", "evaluated_keys": ["allow_extension_operations"]}, "code_block": [[44, "resource azurerm_windows_virtual_machine \"windows_machine\" {\n"], [45, "  admin_password        = random_string.password.result\n"], [46, "  admin_username        = \"tg-${var.environment}\"\n"], [47, "  location              = var.location\n"], [48, "  name                  = \"tg-win\"\n"], [49, "  network_interface_ids = [azurerm_network_interface.ni_win.id]\n"], [50, "  resource_group_name   = azurerm_resource_group.example.name\n"], [51, "  size                  = \"Standard_F2\"\n"], [52, "  os_disk {\n"], [53, "    caching              = \"ReadWrite\"\n"], [54, "    storage_account_type = \"Standard_LRS\"\n"], [55, "  }\n"], [56, "\n"], [57, "  source_image_reference {\n"], [58, "    publisher = \"MicrosoftWindowsServer\"\n"], [59, "    offer     = \"WindowsServer\"\n"], [60, "    sku       = \"2016-Datacenter\"\n"], [61, "    version   = \"latest\"\n"], [62, "  }\n"], [63, "\n"], [64, "  tags = merge({\n"], [65, "    terragoat   = true\n"], [66, "    environment = var.environment\n"], [67, "    }, {\n"], [68, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [69, "    git_file             = \"terraform/azure/instance.tf\"\n"], [70, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [71, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [72, "    git_modifiers        = \"nimrodkor\"\n"], [73, "    git_org              = \"bridgecrewio\"\n"], [74, "    git_repo             = \"terragoat\"\n"], [75, "    yor_trace            = \"41938587-bdfc-4234-b941-560f1ae7d6c0\"\n"], [76, "  })\n"], [77, "}"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [44, 77], "resource": "azurerm_windows_virtual_machine.windows_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureInstanceExtensions", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-14.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_151", "bc_check_id": "BC_AZR_GENERAL_89", "check_name": "Ensure Windows VM enables encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["encryption_at_host_enabled"]}, "code_block": [[44, "resource azurerm_windows_virtual_machine \"windows_machine\" {\n"], [45, "  admin_password        = random_string.password.result\n"], [46, "  admin_username        = \"tg-${var.environment}\"\n"], [47, "  location              = var.location\n"], [48, "  name                  = \"tg-win\"\n"], [49, "  network_interface_ids = [azurerm_network_interface.ni_win.id]\n"], [50, "  resource_group_name   = azurerm_resource_group.example.name\n"], [51, "  size                  = \"Standard_F2\"\n"], [52, "  os_disk {\n"], [53, "    caching              = \"ReadWrite\"\n"], [54, "    storage_account_type = \"Standard_LRS\"\n"], [55, "  }\n"], [56, "\n"], [57, "  source_image_reference {\n"], [58, "    publisher = \"MicrosoftWindowsServer\"\n"], [59, "    offer     = \"WindowsServer\"\n"], [60, "    sku       = \"2016-Datacenter\"\n"], [61, "    version   = \"latest\"\n"], [62, "  }\n"], [63, "\n"], [64, "  tags = merge({\n"], [65, "    terragoat   = true\n"], [66, "    environment = var.environment\n"], [67, "    }, {\n"], [68, "    git_commit           = \"de3bb777f967989c2c3332faea16cb614c55ccc9\"\n"], [69, "    git_file             = \"terraform/azure/instance.tf\"\n"], [70, "    git_last_modified_at = \"2020-06-17 15:48:15\"\n"], [71, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [72, "    git_modifiers        = \"nimrodkor\"\n"], [73, "    git_org              = \"bridgecrewio\"\n"], [74, "    git_repo             = \"terragoat\"\n"], [75, "    yor_trace            = \"41938587-bdfc-4234-b941-560f1ae7d6c0\"\n"], [76, "  })\n"], [77, "}"]], "file_path": "/terraform/azure/instance.tf", "file_abs_path": "/terraform/terraform/azure/instance.tf", "repo_file_path": "/terraform/azure/instance.tf", "file_line_range": [44, 77], "resource": "azurerm_windows_virtual_machine.windows_machine", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.WinVMEncryptionAtHost", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/ensure-azure-windows-vm-enables-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/instance.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "admin_username": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_42", "bc_check_id": "BC_AZR_GENERAL_11", "check_name": "Ensure the key vault is recoverable", "check_result": {"result": "FAILED", "evaluated_keys": ["purge_protection_enabled", "soft_delete_enabled"]}, "code_block": [[1, "resource \"azurerm_key_vault\" \"example\" {\n"], [2, "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  location            = azurerm_resource_group.example.location\n"], [4, "  resource_group_name = azurerm_resource_group.example.name\n"], [5, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [6, "  sku_name            = \"premium\"\n"], [7, "  access_policy {\n"], [8, "    tenant_id = data.azurerm_client_config.current.tenant_id\n"], [9, "    object_id = data.azurerm_client_config.current.object_id\n"], [10, "    key_permissions = [\n"], [11, "      \"create\",\n"], [12, "      \"get\",\n"], [13, "    ]\n"], [14, "    secret_permissions = [\n"], [15, "      \"set\",\n"], [16, "    ]\n"], [17, "  }\n"], [18, "  tags = merge({\n"], [19, "    environment = var.environment\n"], [20, "    terragoat   = true\n"], [21, "    }, {\n"], [22, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [23, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [24, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [25, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [26, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [27, "    git_org              = \"bridgecrewio\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"79afeacc-248a-4015-a4fa-76a6a57f06e2\"\n"], [30, "  })\n"], [31, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [1, 31], "resource": "azurerm_key_vault.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyvaultRecoveryEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-the-key-vault-is-recoverable.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_110", "bc_check_id": "BC_AZR_GENERAL_40", "check_name": "Ensure that key vault enables purge protection", "check_result": {"result": "FAILED", "evaluated_keys": ["purge_protection_enabled"]}, "code_block": [[1, "resource \"azurerm_key_vault\" \"example\" {\n"], [2, "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  location            = azurerm_resource_group.example.location\n"], [4, "  resource_group_name = azurerm_resource_group.example.name\n"], [5, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [6, "  sku_name            = \"premium\"\n"], [7, "  access_policy {\n"], [8, "    tenant_id = data.azurerm_client_config.current.tenant_id\n"], [9, "    object_id = data.azurerm_client_config.current.object_id\n"], [10, "    key_permissions = [\n"], [11, "      \"create\",\n"], [12, "      \"get\",\n"], [13, "    ]\n"], [14, "    secret_permissions = [\n"], [15, "      \"set\",\n"], [16, "    ]\n"], [17, "  }\n"], [18, "  tags = merge({\n"], [19, "    environment = var.environment\n"], [20, "    terragoat   = true\n"], [21, "    }, {\n"], [22, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [23, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [24, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [25, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [26, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [27, "    git_org              = \"bridgecrewio\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"79afeacc-248a-4015-a4fa-76a6a57f06e2\"\n"], [30, "  })\n"], [31, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [1, 31], "resource": "azurerm_key_vault.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesPurgeProtection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-purge-protection.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_109", "bc_check_id": "BC_AZR_NETWORKING_33", "check_name": "Ensure that key vault allows firewall rules settings", "check_result": {"result": "FAILED", "evaluated_keys": ["network_acls/[0]/default_action"]}, "code_block": [[1, "resource \"azurerm_key_vault\" \"example\" {\n"], [2, "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  location            = azurerm_resource_group.example.location\n"], [4, "  resource_group_name = azurerm_resource_group.example.name\n"], [5, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [6, "  sku_name            = \"premium\"\n"], [7, "  access_policy {\n"], [8, "    tenant_id = data.azurerm_client_config.current.tenant_id\n"], [9, "    object_id = data.azurerm_client_config.current.object_id\n"], [10, "    key_permissions = [\n"], [11, "      \"create\",\n"], [12, "      \"get\",\n"], [13, "    ]\n"], [14, "    secret_permissions = [\n"], [15, "      \"set\",\n"], [16, "    ]\n"], [17, "  }\n"], [18, "  tags = merge({\n"], [19, "    environment = var.environment\n"], [20, "    terragoat   = true\n"], [21, "    }, {\n"], [22, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [23, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [24, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [25, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [26, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [27, "    git_org              = \"bridgecrewio\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"79afeacc-248a-4015-a4fa-76a6a57f06e2\"\n"], [30, "  })\n"], [31, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [1, 31], "resource": "azurerm_key_vault.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesFirewallRulesSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-key-vault-allows-firewall-rules-settings.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_189", "bc_check_id": null, "check_name": "Ensure that Azure Key Vault disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[1, "resource \"azurerm_key_vault\" \"example\" {\n"], [2, "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  location            = azurerm_resource_group.example.location\n"], [4, "  resource_group_name = azurerm_resource_group.example.name\n"], [5, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [6, "  sku_name            = \"premium\"\n"], [7, "  access_policy {\n"], [8, "    tenant_id = data.azurerm_client_config.current.tenant_id\n"], [9, "    object_id = data.azurerm_client_config.current.object_id\n"], [10, "    key_permissions = [\n"], [11, "      \"create\",\n"], [12, "      \"get\",\n"], [13, "    ]\n"], [14, "    secret_permissions = [\n"], [15, "      \"set\",\n"], [16, "    ]\n"], [17, "  }\n"], [18, "  tags = merge({\n"], [19, "    environment = var.environment\n"], [20, "    terragoat   = true\n"], [21, "    }, {\n"], [22, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [23, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [24, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [25, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [26, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [27, "    git_org              = \"bridgecrewio\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"79afeacc-248a-4015-a4fa-76a6a57f06e2\"\n"], [30, "  })\n"], [31, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [1, 31], "resource": "azurerm_key_vault.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyVaultDisablesPublicNetworkAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_40", "bc_check_id": "BC_AZR_GENERAL_10", "check_name": "Ensure that the expiration date is set on all keys", "check_result": {"result": "FAILED", "evaluated_keys": ["expiration_date"]}, "code_block": [[33, "resource \"azurerm_key_vault_key\" \"generated\" {\n"], [34, "  name         = \"terragoat-generated-certificate-${var.environment}\"\n"], [35, "  key_vault_id = azurerm_key_vault.example.id\n"], [36, "  key_type     = \"RSA\"\n"], [37, "  key_size     = 2048\n"], [38, "  key_opts = [\n"], [39, "    \"decrypt\",\n"], [40, "    \"encrypt\",\n"], [41, "    \"sign\",\n"], [42, "    \"unwrapKey\",\n"], [43, "    \"verify\",\n"], [44, "    \"wrapKey\",\n"], [45, "  ]\n"], [46, "  tags = {\n"], [47, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [48, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [49, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [50, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [51, "    git_modifiers        = \"nimrodkor\"\n"], [52, "    git_org              = \"bridgecrewio\"\n"], [53, "    git_repo             = \"terragoat\"\n"], [54, "    yor_trace            = \"afbc6e13-63d9-4e6c-8914-d58b7744b5dd\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [33, 56], "resource": "azurerm_key_vault_key.generated", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyExpirationDate", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/set-an-expiration-date-on-all-keys.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_112", "bc_check_id": "BC_AZR_GENERAL_17", "check_name": "Ensure that key vault key is backed by HSM", "check_result": {"result": "FAILED", "evaluated_keys": ["key_type"]}, "code_block": [[33, "resource \"azurerm_key_vault_key\" \"generated\" {\n"], [34, "  name         = \"terragoat-generated-certificate-${var.environment}\"\n"], [35, "  key_vault_id = azurerm_key_vault.example.id\n"], [36, "  key_type     = \"RSA\"\n"], [37, "  key_size     = 2048\n"], [38, "  key_opts = [\n"], [39, "    \"decrypt\",\n"], [40, "    \"encrypt\",\n"], [41, "    \"sign\",\n"], [42, "    \"unwrapKey\",\n"], [43, "    \"verify\",\n"], [44, "    \"wrapKey\",\n"], [45, "  ]\n"], [46, "  tags = {\n"], [47, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [48, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [49, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [50, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [51, "    git_modifiers        = \"nimrodkor\"\n"], [52, "    git_org              = \"bridgecrewio\"\n"], [53, "    git_repo             = \"terragoat\"\n"], [54, "    yor_trace            = \"afbc6e13-63d9-4e6c-8914-d58b7744b5dd\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [33, 56], "resource": "azurerm_key_vault_key.generated", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyBackedByHSM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-key-is-backed-by-hsm.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_41", "bc_check_id": "BC_AZR_SECRETS_1", "check_name": "Ensure that the expiration date is set on all secrets", "check_result": {"result": "FAILED", "evaluated_keys": ["expiration_date"]}, "code_block": [[58, "resource \"azurerm_key_vault_secret\" \"secret\" {\n"], [59, "  key_vault_id = azurerm_key_vault.example.id\n"], [60, "  name         = \"terragoat-secret-${var.environment}\"\n"], [61, "  value        = random_string.password.result\n"], [62, "  tags = {\n"], [63, "    git_commit           = \"f8ff847bb69370bbe03b3d2b70db586ff6c867fc\"\n"], [64, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [65, "    git_last_modified_at = \"2020-06-19 21:16:08\"\n"], [66, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [67, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [68, "    git_org              = \"bridgecrewio\"\n"], [69, "    git_repo             = \"terragoat\"\n"], [70, "    yor_trace            = \"40517524-f05d-485b-bfbe-3fa0dbee511e\"\n"], [71, "  }\n"], [72, "}"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [58, 72], "resource": "azurerm_key_vault_secret.secret", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SecretExpirationDate", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-secrets-policies/set-an-expiration-date-on-all-secrets.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_114", "bc_check_id": "BC_AZR_GENERAL_42", "check_name": "Ensure that key vault secrets have \"content_type\" set", "check_result": {"result": "FAILED", "evaluated_keys": ["content_type"]}, "code_block": [[58, "resource \"azurerm_key_vault_secret\" \"secret\" {\n"], [59, "  key_vault_id = azurerm_key_vault.example.id\n"], [60, "  name         = \"terragoat-secret-${var.environment}\"\n"], [61, "  value        = random_string.password.result\n"], [62, "  tags = {\n"], [63, "    git_commit           = \"f8ff847bb69370bbe03b3d2b70db586ff6c867fc\"\n"], [64, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [65, "    git_last_modified_at = \"2020-06-19 21:16:08\"\n"], [66, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [67, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [68, "    git_org              = \"bridgecrewio\"\n"], [69, "    git_repo             = \"terragoat\"\n"], [70, "    yor_trace            = \"40517524-f05d-485b-bfbe-3fa0dbee511e\"\n"], [71, "  }\n"], [72, "}"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [58, 72], "resource": "azurerm_key_vault_secret.secret", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SecretContentType", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-secrets-have-content-type-set.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/key_vault.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_37", "bc_check_id": "BC_AZR_LOGGING_5", "check_name": "Ensure that Activity Log Retention is set 365 days or greater", "check_result": {"result": "FAILED", "evaluated_keys": ["retention_policy/[0]/enabled", "retention_policy/[0]/days"]}, "code_block": [[1, "resource azurerm_monitor_log_profile \"logging_profile\" {\n"], [2, "  storage_account_id = azurerm_storage_account.example.id\n"], [3, "  categories         = [\"Action\"]\n"], [4, "  locations          = [var.location]\n"], [5, "  name               = \"terragoat-${var.environment}\"\n"], [6, "  retention_policy {\n"], [7, "    enabled = true\n"], [8, "    days    = 30\n"], [9, "  }\n"], [10, "}"]], "file_path": "/terraform/azure/logging.tf", "file_abs_path": "/terraform/terraform/azure/logging.tf", "repo_file_path": "/terraform/azure/logging.tf", "file_line_range": [1, 10], "resource": "azurerm_monitor_log_profile.logging_profile", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MonitorLogProfileRetentionDays", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/set-activity-log-retention-to-365-days-or-greater.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/logging.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"locations": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_38", "bc_check_id": "BC_AZR_LOGGING_6", "check_name": "Ensure audit profile captures all the activities", "check_result": {"result": "FAILED", "evaluated_keys": ["categories"]}, "code_block": [[1, "resource azurerm_monitor_log_profile \"logging_profile\" {\n"], [2, "  storage_account_id = azurerm_storage_account.example.id\n"], [3, "  categories         = [\"Action\"]\n"], [4, "  locations          = [var.location]\n"], [5, "  name               = \"terragoat-${var.environment}\"\n"], [6, "  retention_policy {\n"], [7, "    enabled = true\n"], [8, "    days    = 30\n"], [9, "  }\n"], [10, "}"]], "file_path": "/terraform/azure/logging.tf", "file_abs_path": "/terraform/terraform/azure/logging.tf", "repo_file_path": "/terraform/azure/logging.tf", "file_line_range": [1, 10], "resource": "azurerm_monitor_log_profile.logging_profile", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MonitorLogProfileCategories", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/ensure-audit-profile-captures-all-activities.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/logging.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"locations": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_190", "bc_check_id": null, "check_name": "Ensure that Storage blobs restrict public access", "check_result": {"result": "FAILED", "evaluated_keys": ["allow_nested_items_to_be_public"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageBlobRestrictPublicAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_59", "bc_check_id": "BC_AZR_NETWORKING_18", "check_name": "Ensure that Storage accounts disallow public access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountDisablePublicAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_44", "bc_check_id": "BC_AZR_STORAGE_2", "check_name": "Ensure Storage Account is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["min_tls_version"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountMinimumTlsVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_206", "bc_check_id": null, "check_name": "Ensure that Storage Accounts use replication", "check_result": {"result": "FAILED", "evaluated_keys": ["account_replication_type"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountsUseReplication", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_33", "bc_check_id": "BC_AZR_LOGGING_4", "check_name": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "check_result": {"result": "FAILED", "evaluated_keys": ["account_kind"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountLoggingQueueServiceEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_113", "bc_check_id": "BC_AZR_NETWORKING_34", "check_name": "Ensure that SQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[20, "resource \"azurerm_mssql_server\" \"mssql1\" {\n"], [21, "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"\n"], [22, "  resource_group_name          = azurerm_resource_group.example.name\n"], [23, "  location                     = azurerm_resource_group.example.location\n"], [24, "  version                      = \"12.0\"\n"], [25, "  administrator_login          = \"missadministrator\"\n"], [26, "  administrator_login_password = \"AdminPassword123!\"\n"], [27, "  tags = {\n"], [28, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [29, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [30, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [31, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [32, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"54f6cb23-b30a-4f1d-8064-6f777b9b75db\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [20, 37], "resource": "azurerm_mssql_server.mssql1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-sql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_52", "bc_check_id": "BC_AZR_GENERAL_76", "check_name": "Ensure MSSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["minimum_tls_version"]}, "code_block": [[20, "resource \"azurerm_mssql_server\" \"mssql1\" {\n"], [21, "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"\n"], [22, "  resource_group_name          = azurerm_resource_group.example.name\n"], [23, "  location                     = azurerm_resource_group.example.location\n"], [24, "  version                      = \"12.0\"\n"], [25, "  administrator_login          = \"missadministrator\"\n"], [26, "  administrator_login_password = \"AdminPassword123!\"\n"], [27, "  tags = {\n"], [28, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [29, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [30, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [31, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [32, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"54f6cb23-b30a-4f1d-8064-6f777b9b75db\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [20, 37], "resource": "azurerm_mssql_server.mssql1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MSSQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mssql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_113", "bc_check_id": "BC_AZR_NETWORKING_34", "check_name": "Ensure that SQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[39, "resource \"azurerm_mssql_server\" \"mssql2\" {\n"], [40, "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"\n"], [41, "  resource_group_name          = azurerm_resource_group.example.name\n"], [42, "  location                     = azurerm_resource_group.example.location\n"], [43, "  version                      = \"12.0\"\n"], [44, "  administrator_login          = \"missadministrator\"\n"], [45, "  administrator_login_password = \"AdminPassword123!\"\n"], [46, "  tags = {\n"], [47, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [48, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [49, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [50, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [51, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [52, "    git_org              = \"bridgecrewio\"\n"], [53, "    git_repo             = \"terragoat\"\n"], [54, "    yor_trace            = \"096d2cf2-6d47-41b2-9418-cdedea85e184\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [39, 56], "resource": "azurerm_mssql_server.mssql2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-sql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_52", "bc_check_id": "BC_AZR_GENERAL_76", "check_name": "Ensure MSSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["minimum_tls_version"]}, "code_block": [[39, "resource \"azurerm_mssql_server\" \"mssql2\" {\n"], [40, "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"\n"], [41, "  resource_group_name          = azurerm_resource_group.example.name\n"], [42, "  location                     = azurerm_resource_group.example.location\n"], [43, "  version                      = \"12.0\"\n"], [44, "  administrator_login          = \"missadministrator\"\n"], [45, "  administrator_login_password = \"AdminPassword123!\"\n"], [46, "  tags = {\n"], [47, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [48, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [49, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [50, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [51, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [52, "    git_org              = \"bridgecrewio\"\n"], [53, "    git_repo             = \"terragoat\"\n"], [54, "    yor_trace            = \"096d2cf2-6d47-41b2-9418-cdedea85e184\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [39, 56], "resource": "azurerm_mssql_server.mssql2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MSSQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mssql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_113", "bc_check_id": "BC_AZR_NETWORKING_34", "check_name": "Ensure that SQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[58, "resource \"azurerm_mssql_server\" \"mssql3\" {\n"], [59, "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"\n"], [60, "  resource_group_name          = azurerm_resource_group.example.name\n"], [61, "  location                     = azurerm_resource_group.example.location\n"], [62, "  version                      = \"12.0\"\n"], [63, "  administrator_login          = \"missadministrator\"\n"], [64, "  administrator_login_password = \"AdminPassword123!\"\n"], [65, "  tags = {\n"], [66, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [67, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [68, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [69, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [70, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [71, "    git_org              = \"bridgecrewio\"\n"], [72, "    git_repo             = \"terragoat\"\n"], [73, "    yor_trace            = \"e71d3fb5-addc-481d-ada6-b7432a768de3\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [58, 75], "resource": "azurerm_mssql_server.mssql3", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-sql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_52", "bc_check_id": "BC_AZR_GENERAL_76", "check_name": "Ensure MSSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["minimum_tls_version"]}, "code_block": [[58, "resource \"azurerm_mssql_server\" \"mssql3\" {\n"], [59, "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"\n"], [60, "  resource_group_name          = azurerm_resource_group.example.name\n"], [61, "  location                     = azurerm_resource_group.example.location\n"], [62, "  version                      = \"12.0\"\n"], [63, "  administrator_login          = \"missadministrator\"\n"], [64, "  administrator_login_password = \"AdminPassword123!\"\n"], [65, "  tags = {\n"], [66, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [67, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [68, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [69, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [70, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [71, "    git_org              = \"bridgecrewio\"\n"], [72, "    git_repo             = \"terragoat\"\n"], [73, "    yor_trace            = \"e71d3fb5-addc-481d-ada6-b7432a768de3\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [58, 75], "resource": "azurerm_mssql_server.mssql3", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MSSQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mssql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_113", "bc_check_id": "BC_AZR_NETWORKING_34", "check_name": "Ensure that SQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[77, "resource \"azurerm_mssql_server\" \"mssql4\" {\n"], [78, "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"\n"], [79, "  resource_group_name          = azurerm_resource_group.example.name\n"], [80, "  location                     = azurerm_resource_group.example.location\n"], [81, "  version                      = \"12.0\"\n"], [82, "  administrator_login          = \"missadministrator\"\n"], [83, "  administrator_login_password = \"AdminPassword123!\"\n"], [84, "  tags = {\n"], [85, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [86, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [87, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [88, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [89, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [90, "    git_org              = \"bridgecrewio\"\n"], [91, "    git_repo             = \"terragoat\"\n"], [92, "    yor_trace            = \"c3b85724-4f7e-4c63-a17d-3d04239beae8\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [77, 94], "resource": "azurerm_mssql_server.mssql4", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-sql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_52", "bc_check_id": "BC_AZR_GENERAL_76", "check_name": "Ensure MSSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["minimum_tls_version"]}, "code_block": [[77, "resource \"azurerm_mssql_server\" \"mssql4\" {\n"], [78, "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"\n"], [79, "  resource_group_name          = azurerm_resource_group.example.name\n"], [80, "  location                     = azurerm_resource_group.example.location\n"], [81, "  version                      = \"12.0\"\n"], [82, "  administrator_login          = \"missadministrator\"\n"], [83, "  administrator_login_password = \"AdminPassword123!\"\n"], [84, "  tags = {\n"], [85, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [86, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [87, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [88, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [89, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [90, "    git_org              = \"bridgecrewio\"\n"], [91, "    git_repo             = \"terragoat\"\n"], [92, "    yor_trace            = \"c3b85724-4f7e-4c63-a17d-3d04239beae8\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [77, 94], "resource": "azurerm_mssql_server.mssql4", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MSSQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mssql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_113", "bc_check_id": "BC_AZR_NETWORKING_34", "check_name": "Ensure that SQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[96, "resource \"azurerm_mssql_server\" \"mssql5\" {\n"], [97, "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"\n"], [98, "  resource_group_name          = azurerm_resource_group.example.name\n"], [99, "  location                     = azurerm_resource_group.example.location\n"], [100, "  version                      = \"12.0\"\n"], [101, "  administrator_login          = \"missadministrator\"\n"], [102, "  administrator_login_password = \"AdminPassword123!\"\n"], [103, "  tags = {\n"], [104, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [105, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [106, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [107, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [108, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [109, "    git_org              = \"bridgecrewio\"\n"], [110, "    git_repo             = \"terragoat\"\n"], [111, "    yor_trace            = \"0240ca84-acc9-47d9-b491-9e7e359787a1\"\n"], [112, "  }\n"], [113, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [96, 113], "resource": "azurerm_mssql_server.mssql5", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-sql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_52", "bc_check_id": "BC_AZR_GENERAL_76", "check_name": "Ensure MSSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["minimum_tls_version"]}, "code_block": [[96, "resource \"azurerm_mssql_server\" \"mssql5\" {\n"], [97, "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"\n"], [98, "  resource_group_name          = azurerm_resource_group.example.name\n"], [99, "  location                     = azurerm_resource_group.example.location\n"], [100, "  version                      = \"12.0\"\n"], [101, "  administrator_login          = \"missadministrator\"\n"], [102, "  administrator_login_password = \"AdminPassword123!\"\n"], [103, "  tags = {\n"], [104, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [105, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [106, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [107, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [108, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [109, "    git_org              = \"bridgecrewio\"\n"], [110, "    git_repo             = \"terragoat\"\n"], [111, "    yor_trace            = \"0240ca84-acc9-47d9-b491-9e7e359787a1\"\n"], [112, "  }\n"], [113, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [96, 113], "resource": "azurerm_mssql_server.mssql5", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MSSQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mssql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_113", "bc_check_id": "BC_AZR_NETWORKING_34", "check_name": "Ensure that SQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[115, "resource \"azurerm_mssql_server\" \"mssql6\" {\n"], [116, "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"\n"], [117, "  resource_group_name          = azurerm_resource_group.example.name\n"], [118, "  location                     = azurerm_resource_group.example.location\n"], [119, "  version                      = \"12.0\"\n"], [120, "  administrator_login          = \"missadministrator\"\n"], [121, "  administrator_login_password = \"AdminPassword123!\"\n"], [122, "  tags = {\n"], [123, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [124, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [125, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [126, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [127, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [128, "    git_org              = \"bridgecrewio\"\n"], [129, "    git_repo             = \"terragoat\"\n"], [130, "    yor_trace            = \"042d15fb-edfa-484b-b65e-3d70c50cdee7\"\n"], [131, "  }\n"], [132, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [115, 132], "resource": "azurerm_mssql_server.mssql6", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-sql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_52", "bc_check_id": "BC_AZR_GENERAL_76", "check_name": "Ensure MSSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["minimum_tls_version"]}, "code_block": [[115, "resource \"azurerm_mssql_server\" \"mssql6\" {\n"], [116, "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"\n"], [117, "  resource_group_name          = azurerm_resource_group.example.name\n"], [118, "  location                     = azurerm_resource_group.example.location\n"], [119, "  version                      = \"12.0\"\n"], [120, "  administrator_login          = \"missadministrator\"\n"], [121, "  administrator_login_password = \"AdminPassword123!\"\n"], [122, "  tags = {\n"], [123, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [124, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [125, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [126, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [127, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [128, "    git_org              = \"bridgecrewio\"\n"], [129, "    git_repo             = \"terragoat\"\n"], [130, "    yor_trace            = \"042d15fb-edfa-484b-b65e-3d70c50cdee7\"\n"], [131, "  }\n"], [132, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [115, 132], "resource": "azurerm_mssql_server.mssql6", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MSSQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mssql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_113", "bc_check_id": "BC_AZR_NETWORKING_34", "check_name": "Ensure that SQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[134, "resource \"azurerm_mssql_server\" \"mssql7\" {\n"], [135, "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"\n"], [136, "  resource_group_name          = azurerm_resource_group.example.name\n"], [137, "  location                     = azurerm_resource_group.example.location\n"], [138, "  version                      = \"12.0\"\n"], [139, "  administrator_login          = \"missadministrator\"\n"], [140, "  administrator_login_password = \"AdminPassword123!\"\n"], [141, "  tags = {\n"], [142, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [143, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [144, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [145, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [146, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [147, "    git_org              = \"bridgecrewio\"\n"], [148, "    git_repo             = \"terragoat\"\n"], [149, "    yor_trace            = \"3f1118e1-5067-452e-906f-5123cfc93711\"\n"], [150, "  }\n"], [151, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [134, 151], "resource": "azurerm_mssql_server.mssql7", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-sql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_52", "bc_check_id": "BC_AZR_GENERAL_76", "check_name": "Ensure MSSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["minimum_tls_version"]}, "code_block": [[134, "resource \"azurerm_mssql_server\" \"mssql7\" {\n"], [135, "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"\n"], [136, "  resource_group_name          = azurerm_resource_group.example.name\n"], [137, "  location                     = azurerm_resource_group.example.location\n"], [138, "  version                      = \"12.0\"\n"], [139, "  administrator_login          = \"missadministrator\"\n"], [140, "  administrator_login_password = \"AdminPassword123!\"\n"], [141, "  tags = {\n"], [142, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [143, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [144, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [145, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [146, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [147, "    git_org              = \"bridgecrewio\"\n"], [148, "    git_repo             = \"terragoat\"\n"], [149, "    yor_trace            = \"3f1118e1-5067-452e-906f-5123cfc93711\"\n"], [150, "  }\n"], [151, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [134, 151], "resource": "azurerm_mssql_server.mssql7", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MSSQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mssql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[153, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy1\" {\n"], [154, "  resource_group_name        = azurerm_resource_group.example.name\n"], [155, "  server_name                = azurerm_mssql_server.mssql1.name\n"], [156, "  state                      = \"Enabled\"\n"], [157, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [158, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [159, "  disabled_alerts = [\n"], [160, "    \"Sql_Injection\",\n"], [161, "    \"Data_Exfiltration\"\n"], [162, "  ]\n"], [163, "  retention_days  = 20\n"], [164, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [165, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [153, 165], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[153, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy1\" {\n"], [154, "  resource_group_name        = azurerm_resource_group.example.name\n"], [155, "  server_name                = azurerm_mssql_server.mssql1.name\n"], [156, "  state                      = \"Enabled\"\n"], [157, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [158, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [159, "  disabled_alerts = [\n"], [160, "    \"Sql_Injection\",\n"], [161, "    \"Data_Exfiltration\"\n"], [162, "  ]\n"], [163, "  retention_days  = 20\n"], [164, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [165, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [153, 165], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy1", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[167, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy2\" {\n"], [168, "  resource_group_name        = azurerm_resource_group.example.name\n"], [169, "  server_name                = azurerm_mssql_server.mssql2.name\n"], [170, "  state                      = \"Enabled\"\n"], [171, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [172, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [173, "  disabled_alerts = [\n"], [174, "    \"Sql_Injection\",\n"], [175, "    \"Data_Exfiltration\"\n"], [176, "  ]\n"], [177, "  retention_days  = 20\n"], [178, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [179, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [167, 179], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[167, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy2\" {\n"], [168, "  resource_group_name        = azurerm_resource_group.example.name\n"], [169, "  server_name                = azurerm_mssql_server.mssql2.name\n"], [170, "  state                      = \"Enabled\"\n"], [171, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [172, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [173, "  disabled_alerts = [\n"], [174, "    \"Sql_Injection\",\n"], [175, "    \"Data_Exfiltration\"\n"], [176, "  ]\n"], [177, "  retention_days  = 20\n"], [178, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [179, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [167, 179], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy2", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[181, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy3\" {\n"], [182, "  resource_group_name        = azurerm_resource_group.example.name\n"], [183, "  server_name                = azurerm_mssql_server.mssql3.name\n"], [184, "  state                      = \"Enabled\"\n"], [185, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [186, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [187, "  disabled_alerts = [\n"], [188, "    \"Sql_Injection\",\n"], [189, "    \"Data_Exfiltration\"\n"], [190, "  ]\n"], [191, "  retention_days  = 20\n"], [192, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [193, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [181, 193], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy3", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[181, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy3\" {\n"], [182, "  resource_group_name        = azurerm_resource_group.example.name\n"], [183, "  server_name                = azurerm_mssql_server.mssql3.name\n"], [184, "  state                      = \"Enabled\"\n"], [185, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [186, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [187, "  disabled_alerts = [\n"], [188, "    \"Sql_Injection\",\n"], [189, "    \"Data_Exfiltration\"\n"], [190, "  ]\n"], [191, "  retention_days  = 20\n"], [192, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [193, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [181, 193], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy3", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[195, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy4\" {\n"], [196, "  resource_group_name        = azurerm_resource_group.example.name\n"], [197, "  server_name                = azurerm_mssql_server.mssql4.name\n"], [198, "  state                      = \"Enabled\"\n"], [199, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [200, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [201, "  disabled_alerts = [\n"], [202, "    \"Sql_Injection\",\n"], [203, "    \"Data_Exfiltration\"\n"], [204, "  ]\n"], [205, "  retention_days  = 20\n"], [206, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [207, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [195, 207], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy4", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[195, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy4\" {\n"], [196, "  resource_group_name        = azurerm_resource_group.example.name\n"], [197, "  server_name                = azurerm_mssql_server.mssql4.name\n"], [198, "  state                      = \"Enabled\"\n"], [199, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [200, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [201, "  disabled_alerts = [\n"], [202, "    \"Sql_Injection\",\n"], [203, "    \"Data_Exfiltration\"\n"], [204, "  ]\n"], [205, "  retention_days  = 20\n"], [206, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [207, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [195, 207], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy4", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_addresses"]}, "code_block": [[209, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy5\" {\n"], [210, "  resource_group_name        = azurerm_resource_group.example.name\n"], [211, "  server_name                = azurerm_mssql_server.mssql5.name\n"], [212, "  state                      = \"Enabled\"\n"], [213, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [214, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [215, "  disabled_alerts = [\n"], [216, "    \"Sql_Injection\",\n"], [217, "    \"Data_Exfiltration\"\n"], [218, "  ]\n"], [219, "  retention_days = 20\n"], [220, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [209, 220], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy5", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[209, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy5\" {\n"], [210, "  resource_group_name        = azurerm_resource_group.example.name\n"], [211, "  server_name                = azurerm_mssql_server.mssql5.name\n"], [212, "  state                      = \"Enabled\"\n"], [213, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [214, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [215, "  disabled_alerts = [\n"], [216, "    \"Sql_Injection\",\n"], [217, "    \"Data_Exfiltration\"\n"], [218, "  ]\n"], [219, "  retention_days = 20\n"], [220, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [209, 220], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy5", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[209, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy5\" {\n"], [210, "  resource_group_name        = azurerm_resource_group.example.name\n"], [211, "  server_name                = azurerm_mssql_server.mssql5.name\n"], [212, "  state                      = \"Enabled\"\n"], [213, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [214, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [215, "  disabled_alerts = [\n"], [216, "    \"Sql_Injection\",\n"], [217, "    \"Data_Exfiltration\"\n"], [218, "  ]\n"], [219, "  retention_days = 20\n"], [220, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [209, 220], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy5", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[222, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy6\" {\n"], [223, "  resource_group_name        = azurerm_resource_group.example.name\n"], [224, "  server_name                = azurerm_mssql_server.mssql6.name\n"], [225, "  state                      = \"Enabled\"\n"], [226, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [227, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [228, "  disabled_alerts = [\n"], [229, "    \"Sql_Injection\",\n"], [230, "    \"Data_Exfiltration\"\n"], [231, "  ]\n"], [232, "  retention_days  = 20\n"], [233, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [234, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [222, 234], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy6", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[222, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy6\" {\n"], [223, "  resource_group_name        = azurerm_resource_group.example.name\n"], [224, "  server_name                = azurerm_mssql_server.mssql6.name\n"], [225, "  state                      = \"Enabled\"\n"], [226, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [227, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [228, "  disabled_alerts = [\n"], [229, "    \"Sql_Injection\",\n"], [230, "    \"Data_Exfiltration\"\n"], [231, "  ]\n"], [232, "  retention_days  = 20\n"], [233, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [234, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [222, 234], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy6", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[236, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy7\" {\n"], [237, "  resource_group_name        = azurerm_resource_group.example.name\n"], [238, "  server_name                = azurerm_mssql_server.mssql7.name\n"], [239, "  state                      = \"Enabled\"\n"], [240, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [241, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [242, "  disabled_alerts = [\n"], [243, "    \"Sql_Injection\",\n"], [244, "    \"Data_Exfiltration\"\n"], [245, "  ]\n"], [246, "  retention_days  = 20\n"], [247, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [248, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [236, 248], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy7", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[236, "resource \"azurerm_mssql_server_security_alert_policy\" \"alertpolicy7\" {\n"], [237, "  resource_group_name        = azurerm_resource_group.example.name\n"], [238, "  server_name                = azurerm_mssql_server.mssql7.name\n"], [239, "  state                      = \"Enabled\"\n"], [240, "  storage_endpoint           = azurerm_storage_account.security_storage_account.primary_blob_endpoint\n"], [241, "  storage_account_access_key = azurerm_storage_account.security_storage_account.primary_access_key\n"], [242, "  disabled_alerts = [\n"], [243, "    \"Sql_Injection\",\n"], [244, "    \"Data_Exfiltration\"\n"], [245, "  ]\n"], [246, "  retention_days  = 20\n"], [247, "  email_addresses = [\"securityengineer@bridgecrew.io\"]\n"], [248, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [236, 248], "resource": "azurerm_mssql_server_security_alert_policy.alertpolicy7", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/mssql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_10", "bc_check_id": "BC_AZR_NETWORKING_3", "check_name": "Ensure that SSH access is restricted from the internet", "check_result": {"result": "FAILED", "evaluated_keys": ["security_rule/[0]/access", "security_rule/[0]/direction", "security_rule/[0]/protocol", "security_rule/[0]/destination_port_range", "security_rule/[0]/destination_port_ranges", "security_rule/[0]/source_address_prefix", "security_rule/[0]/source_address_prefixes"]}, "code_block": [[69, "resource azurerm_network_security_group \"bad_sg\" {\n"], [70, "  location            = var.location\n"], [71, "  name                = \"terragoat-${var.environment}\"\n"], [72, "  resource_group_name = azurerm_resource_group.example.name\n"], [73, "\n"], [74, "  security_rule {\n"], [75, "    access                     = \"Allow\"\n"], [76, "    direction                  = \"Inbound\"\n"], [77, "    name                       = \"AllowSSH\"\n"], [78, "    priority                   = 200\n"], [79, "    protocol                   = \"TCP\"\n"], [80, "    source_address_prefix      = \"*\"\n"], [81, "    source_port_range          = \"*\"\n"], [82, "    destination_port_range     = \"22-22\"\n"], [83, "    destination_address_prefix = \"*\"\n"], [84, "  }\n"], [85, "\n"], [86, "  security_rule {\n"], [87, "    access                     = \"Allow\"\n"], [88, "    direction                  = \"Inbound\"\n"], [89, "    name                       = \"AllowRDP\"\n"], [90, "    priority                   = 300\n"], [91, "    protocol                   = \"TCP\"\n"], [92, "    source_address_prefix      = \"*\"\n"], [93, "    source_port_range          = \"*\"\n"], [94, "    destination_port_range     = \"3389-3389\"\n"], [95, "    destination_address_prefix = \"*\"\n"], [96, "  }\n"], [97, "  tags = {\n"], [98, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [99, "    git_file             = \"terraform/azure/networking.tf\"\n"], [100, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [101, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [102, "    git_modifiers        = \"nimrodkor\"\n"], [103, "    git_org              = \"bridgecrewio\"\n"], [104, "    git_repo             = \"terragoat\"\n"], [105, "    yor_trace            = \"1a591ba4-d969-4572-9704-87b5c55c0ba3\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [69, 107], "resource": "azurerm_network_security_group.bad_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleSSHAccessRestricted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_9", "bc_check_id": "BC_AZR_NETWORKING_2", "check_name": "Ensure that RDP access is restricted from the internet", "check_result": {"result": "FAILED", "evaluated_keys": ["security_rule/[1]/access", "security_rule/[1]/direction", "security_rule/[1]/protocol", "security_rule/[1]/destination_port_range", "security_rule/[1]/destination_port_ranges", "security_rule/[1]/source_address_prefix", "security_rule/[1]/source_address_prefixes"]}, "code_block": [[69, "resource azurerm_network_security_group \"bad_sg\" {\n"], [70, "  location            = var.location\n"], [71, "  name                = \"terragoat-${var.environment}\"\n"], [72, "  resource_group_name = azurerm_resource_group.example.name\n"], [73, "\n"], [74, "  security_rule {\n"], [75, "    access                     = \"Allow\"\n"], [76, "    direction                  = \"Inbound\"\n"], [77, "    name                       = \"AllowSSH\"\n"], [78, "    priority                   = 200\n"], [79, "    protocol                   = \"TCP\"\n"], [80, "    source_address_prefix      = \"*\"\n"], [81, "    source_port_range          = \"*\"\n"], [82, "    destination_port_range     = \"22-22\"\n"], [83, "    destination_address_prefix = \"*\"\n"], [84, "  }\n"], [85, "\n"], [86, "  security_rule {\n"], [87, "    access                     = \"Allow\"\n"], [88, "    direction                  = \"Inbound\"\n"], [89, "    name                       = \"AllowRDP\"\n"], [90, "    priority                   = 300\n"], [91, "    protocol                   = \"TCP\"\n"], [92, "    source_address_prefix      = \"*\"\n"], [93, "    source_port_range          = \"*\"\n"], [94, "    destination_port_range     = \"3389-3389\"\n"], [95, "    destination_address_prefix = \"*\"\n"], [96, "  }\n"], [97, "  tags = {\n"], [98, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [99, "    git_file             = \"terraform/azure/networking.tf\"\n"], [100, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [101, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [102, "    git_modifiers        = \"nimrodkor\"\n"], [103, "    git_org              = \"bridgecrewio\"\n"], [104, "    git_repo             = \"terragoat\"\n"], [105, "    yor_trace            = \"1a591ba4-d969-4572-9704-87b5c55c0ba3\"\n"], [106, "  }\n"], [107, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [69, 107], "resource": "azurerm_network_security_group.bad_sg", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NSGRuleRDPAccessRestricted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_12", "bc_check_id": "BC_AZR_LOGGING_1", "check_name": "Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'", "check_result": {"result": "FAILED", "evaluated_keys": ["enabled"]}, "code_block": [[125, "resource azurerm_network_watcher_flow_log \"flow_log\" {\n"], [126, "  enabled                   = false\n"], [127, "  network_security_group_id = azurerm_network_security_group.bad_sg.id\n"], [128, "  network_watcher_name      = azurerm_network_watcher.network_watcher.name\n"], [129, "  resource_group_name       = azurerm_resource_group.example.name\n"], [130, "  storage_account_id        = azurerm_storage_account.example.id\n"], [131, "  retention_policy {\n"], [132, "    enabled = false\n"], [133, "    days    = 10\n"], [134, "  }\n"], [135, "  tags = {\n"], [136, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [137, "    git_file             = \"terraform/azure/networking.tf\"\n"], [138, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [139, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [140, "    git_modifiers        = \"nimrodkor\"\n"], [141, "    git_org              = \"bridgecrewio\"\n"], [142, "    git_repo             = \"terragoat\"\n"], [143, "    yor_trace            = \"33a7212e-7f1a-49fc-af73-8e525c5546ec\"\n"], [144, "  }\n"], [145, "}"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [125, 145], "resource": "azurerm_network_watcher_flow_log.flow_log", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.NetworkWatcherFlowLogPeriod", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/networking.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "network_watcher_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_network_watcher.network_watcher", "path": "/terraform/terraform/azure/networking.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_39", "bc_check_id": "BC_AZR_IAM_2", "check_name": "Ensure that no custom subscription owner roles are created", "check_result": {"result": "FAILED", "evaluated_keys": ["permissions/[0]/actions"]}, "code_block": [[3, "resource \"azurerm_role_definition\" \"example\" {\n"], [4, "  name        = \"my-custom-role\"\n"], [5, "  scope       = data.azurerm_subscription.current_subscription.id\n"], [6, "  description = \"This is a custom role created via Terraform\"\n"], [7, "\n"], [8, "  permissions {\n"], [9, "    actions     = [\"*\"]\n"], [10, "    not_actions = []\n"], [11, "  }\n"], [12, "\n"], [13, "  assignable_scopes = [\n"], [14, "    data.azurerm_subscription.current_subscription.id\n"], [15, "  ]\n"], [16, "}"]], "file_path": "/terraform/azure/roles.tf", "file_abs_path": "/terraform/terraform/azure/roles.tf", "repo_file_path": "/terraform/azure/roles.tf", "file_line_range": [3, 16], "resource": "azurerm_role_definition.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.CutsomRoleDefinitionSubscriptionOwner", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-iam-policies/do-not-create-custom-subscription-owner-roles.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/roles.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_19", "bc_check_id": "BC_AZR_GENERAL_9", "check_name": "Ensure that standard pricing tier is selected", "check_result": {"result": "FAILED", "evaluated_keys": ["tier"]}, "code_block": [[1, "resource azurerm_security_center_subscription_pricing \"pricing\" {\n"], [2, "  tier = \"Free\"\n"], [3, "}\n"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [1, 3], "resource": "azurerm_security_center_subscription_pricing.pricing", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SecurityCenterStandardPricing", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-standard-pricing-tier-is-selected.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_22", "bc_check_id": "BC_AZR_GENERAL_5", "check_name": "Ensure that 'Send email notification for high severity alerts' is set to 'On'", "check_result": {"result": "FAILED", "evaluated_keys": ["alerts_to_admins"]}, "code_block": [[5, "resource azurerm_security_center_contact \"contact\" {\n"], [6, "  alert_notifications = false\n"], [7, "  alerts_to_admins    = false\n"], [8, "  email               = \"some@email.com\"\n"], [9, "}"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [5, 9], "resource": "azurerm_security_center_contact.contact", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SecurityCenterContactEmailAlertAdmins", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_20", "bc_check_id": "BC_AZR_GENERAL_3", "check_name": "Ensure that security contact 'Phone number' is set", "check_result": {"result": "FAILED", "evaluated_keys": ["phone"]}, "code_block": [[5, "resource azurerm_security_center_contact \"contact\" {\n"], [6, "  alert_notifications = false\n"], [7, "  alerts_to_admins    = false\n"], [8, "  email               = \"some@email.com\"\n"], [9, "}"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [5, 9], "resource": "azurerm_security_center_contact.contact", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SecurityCenterContactPhone", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_21", "bc_check_id": "BC_AZR_GENERAL_4", "check_name": "Ensure that 'Send email notification for high severity alerts' is set to 'On'", "check_result": {"result": "FAILED", "evaluated_keys": ["alert_notifications"]}, "code_block": [[5, "resource azurerm_security_center_contact \"contact\" {\n"], [6, "  alert_notifications = false\n"], [7, "  alerts_to_admins    = false\n"], [8, "  email               = \"some@email.com\"\n"], [9, "}"]], "file_path": "/terraform/azure/security_center.tf", "file_abs_path": "/terraform/terraform/azure/security_center.tf", "repo_file_path": "/terraform/azure/security_center.tf", "file_line_range": [5, 9], "resource": "azurerm_security_center_contact.contact", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SecurityCenterContactEmailAlert", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/bc_azr_general_4", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/security_center.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_AZURE_26", "bc_check_id": "BC_AZR_GENERAL_7", "check_name": "Ensure that 'Send Alerts To' is enabled for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_addresses"]}, "code_block": [[31, "resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n"], [32, "  resource_group_name        = azurerm_resource_group.example.name\n"], [33, "  server_name                = azurerm_sql_server.example.name\n"], [34, "  state                      = \"Enabled\"\n"], [35, "  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n"], [36, "  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n"], [37, "  disabled_alerts = [\n"], [38, "    \"Sql_Injection\",\n"], [39, "    \"Data_Exfiltration\"\n"], [40, "  ]\n"], [41, "  retention_days = 20\n"], [42, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [31, 42], "resource": "azurerm_mssql_server_security_alert_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_25", "bc_check_id": "BC_AZR_GENERAL_6", "check_name": "Ensure that 'Threat Detection types' is set to 'All'", "check_result": {"result": "FAILED", "evaluated_keys": ["disabled_alerts"]}, "code_block": [[31, "resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n"], [32, "  resource_group_name        = azurerm_resource_group.example.name\n"], [33, "  server_name                = azurerm_sql_server.example.name\n"], [34, "  state                      = \"Enabled\"\n"], [35, "  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n"], [36, "  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n"], [37, "  disabled_alerts = [\n"], [38, "    \"Sql_Injection\",\n"], [39, "    \"Data_Exfiltration\"\n"], [40, "  ]\n"], [41, "  retention_days = 20\n"], [42, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [31, 42], "resource": "azurerm_mssql_server_security_alert_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerThreatDetectionTypes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_27", "bc_check_id": "BC_AZR_GENERAL_8", "check_name": "Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["email_account_admins"]}, "code_block": [[31, "resource \"azurerm_mssql_server_security_alert_policy\" \"example\" {\n"], [32, "  resource_group_name        = azurerm_resource_group.example.name\n"], [33, "  server_name                = azurerm_sql_server.example.name\n"], [34, "  state                      = \"Enabled\"\n"], [35, "  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n"], [36, "  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n"], [37, "  disabled_alerts = [\n"], [38, "    \"Sql_Injection\",\n"], [39, "    \"Data_Exfiltration\"\n"], [40, "  ]\n"], [41, "  retention_days = 20\n"], [42, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [31, 42], "resource": "azurerm_mssql_server_security_alert_policy.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.SQLServerEmailAlertsToAdminsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_127", "bc_check_id": "BC_AZR_GENERAL_44", "check_name": "Ensure that My SQL server enables Threat detection policy", "check_result": {"result": "FAILED", "evaluated_keys": ["threat_detection_policy/[0]/enabled"]}, "code_block": [[44, "resource \"azurerm_mysql_server\" \"example\" {\n"], [45, "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n"], [46, "  location            = azurerm_resource_group.example.location\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "\n"], [49, "  administrator_login          = \"terragoat-${var.environment}\"\n"], [50, "  administrator_login_password = random_string.password.result\n"], [51, "\n"], [52, "  sku_name   = \"B_Gen5_2\"\n"], [53, "  storage_mb = 5120\n"], [54, "  version    = \"5.7\"\n"], [55, "\n"], [56, "  auto_grow_enabled                 = true\n"], [57, "  backup_retention_days             = 7\n"], [58, "  infrastructure_encryption_enabled = true\n"], [59, "  public_network_access_enabled     = true\n"], [60, "  ssl_enforcement_enabled           = false\n"], [61, "  tags = {\n"], [62, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [63, "    git_file             = \"terraform/azure/sql.tf\"\n"], [64, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [65, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [66, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [67, "    git_org              = \"bridgecrewio\"\n"], [68, "    git_repo             = \"terragoat\"\n"], [69, "    yor_trace            = \"1ac18c16-09a4-41c9-9a66-6f514050178e\"\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [44, 71], "resource": "azurerm_mysql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MySQLTreatDetectionEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-my-sql-server-enables-threat-detection-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "administrator_login": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_94", "bc_check_id": "BC_AZR_GENERAL_19", "check_name": "Ensure that My SQL server enables geo-redundant backups", "check_result": {"result": "FAILED", "evaluated_keys": ["geo_redundant_backup_enabled"]}, "code_block": [[44, "resource \"azurerm_mysql_server\" \"example\" {\n"], [45, "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n"], [46, "  location            = azurerm_resource_group.example.location\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "\n"], [49, "  administrator_login          = \"terragoat-${var.environment}\"\n"], [50, "  administrator_login_password = random_string.password.result\n"], [51, "\n"], [52, "  sku_name   = \"B_Gen5_2\"\n"], [53, "  storage_mb = 5120\n"], [54, "  version    = \"5.7\"\n"], [55, "\n"], [56, "  auto_grow_enabled                 = true\n"], [57, "  backup_retention_days             = 7\n"], [58, "  infrastructure_encryption_enabled = true\n"], [59, "  public_network_access_enabled     = true\n"], [60, "  ssl_enforcement_enabled           = false\n"], [61, "  tags = {\n"], [62, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [63, "    git_file             = \"terraform/azure/sql.tf\"\n"], [64, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [65, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [66, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [67, "    git_org              = \"bridgecrewio\"\n"], [68, "    git_repo             = \"terragoat\"\n"], [69, "    yor_trace            = \"1ac18c16-09a4-41c9-9a66-6f514050178e\"\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [44, 71], "resource": "azurerm_mysql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MySQLGeoBackupEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-my-sql-server-enables-geo-redundant-backups.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "administrator_login": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_54", "bc_check_id": "BC_AZR_GENERAL_77", "check_name": "Ensure MySQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["ssl_minimal_tls_version_enforced"]}, "code_block": [[44, "resource \"azurerm_mysql_server\" \"example\" {\n"], [45, "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n"], [46, "  location            = azurerm_resource_group.example.location\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "\n"], [49, "  administrator_login          = \"terragoat-${var.environment}\"\n"], [50, "  administrator_login_password = random_string.password.result\n"], [51, "\n"], [52, "  sku_name   = \"B_Gen5_2\"\n"], [53, "  storage_mb = 5120\n"], [54, "  version    = \"5.7\"\n"], [55, "\n"], [56, "  auto_grow_enabled                 = true\n"], [57, "  backup_retention_days             = 7\n"], [58, "  infrastructure_encryption_enabled = true\n"], [59, "  public_network_access_enabled     = true\n"], [60, "  ssl_enforcement_enabled           = false\n"], [61, "  tags = {\n"], [62, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [63, "    git_file             = \"terraform/azure/sql.tf\"\n"], [64, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [65, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [66, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [67, "    git_org              = \"bridgecrewio\"\n"], [68, "    git_repo             = \"terragoat\"\n"], [69, "    yor_trace            = \"1ac18c16-09a4-41c9-9a66-6f514050178e\"\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [44, 71], "resource": "azurerm_mysql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MySQLServerMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-mysql-is-using-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "administrator_login": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_53", "bc_check_id": "BC_AZR_NETWORKING_45", "check_name": "Ensure 'public network access enabled' is set to 'False' for mySQL servers", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[44, "resource \"azurerm_mysql_server\" \"example\" {\n"], [45, "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n"], [46, "  location            = azurerm_resource_group.example.location\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "\n"], [49, "  administrator_login          = \"terragoat-${var.environment}\"\n"], [50, "  administrator_login_password = random_string.password.result\n"], [51, "\n"], [52, "  sku_name   = \"B_Gen5_2\"\n"], [53, "  storage_mb = 5120\n"], [54, "  version    = \"5.7\"\n"], [55, "\n"], [56, "  auto_grow_enabled                 = true\n"], [57, "  backup_retention_days             = 7\n"], [58, "  infrastructure_encryption_enabled = true\n"], [59, "  public_network_access_enabled     = true\n"], [60, "  ssl_enforcement_enabled           = false\n"], [61, "  tags = {\n"], [62, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [63, "    git_file             = \"terraform/azure/sql.tf\"\n"], [64, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [65, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [66, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [67, "    git_org              = \"bridgecrewio\"\n"], [68, "    git_repo             = \"terragoat\"\n"], [69, "    yor_trace            = \"1ac18c16-09a4-41c9-9a66-6f514050178e\"\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [44, 71], "resource": "azurerm_mysql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MySQLPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-public-network-access-enabled-is-set-to-false-for-mysql-servers.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "administrator_login": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_28", "bc_check_id": "BC_AZR_NETWORKING_9", "check_name": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for MySQL Database Server", "check_result": {"result": "FAILED", "evaluated_keys": ["ssl_enforcement_enabled"]}, "code_block": [[44, "resource \"azurerm_mysql_server\" \"example\" {\n"], [45, "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n"], [46, "  location            = azurerm_resource_group.example.location\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "\n"], [49, "  administrator_login          = \"terragoat-${var.environment}\"\n"], [50, "  administrator_login_password = random_string.password.result\n"], [51, "\n"], [52, "  sku_name   = \"B_Gen5_2\"\n"], [53, "  storage_mb = 5120\n"], [54, "  version    = \"5.7\"\n"], [55, "\n"], [56, "  auto_grow_enabled                 = true\n"], [57, "  backup_retention_days             = 7\n"], [58, "  infrastructure_encryption_enabled = true\n"], [59, "  public_network_access_enabled     = true\n"], [60, "  ssl_enforcement_enabled           = false\n"], [61, "  tags = {\n"], [62, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [63, "    git_file             = \"terraform/azure/sql.tf\"\n"], [64, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [65, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [66, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [67, "    git_org              = \"bridgecrewio\"\n"], [68, "    git_repo             = \"terragoat\"\n"], [69, "    yor_trace            = \"1ac18c16-09a4-41c9-9a66-6f514050178e\"\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [44, 71], "resource": "azurerm_mysql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.MySQLServerSSLEnforcementEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-9.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "administrator_login": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_147", "bc_check_id": "BC_AZR_NETWORKING_52", "check_name": "Ensure PostgreSQL is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["ssl_minimal_tls_version_enforced"]}, "code_block": [[73, "resource \"azurerm_postgresql_server\" \"example\" {\n"], [74, "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"\n"], [75, "  location                     = azurerm_resource_group.example.location\n"], [76, "  resource_group_name          = azurerm_resource_group.example.name\n"], [77, "  sku_name                     = \"B_Gen5_2\"\n"], [78, "  storage_mb                   = 5120\n"], [79, "  backup_retention_days        = 7\n"], [80, "  geo_redundant_backup_enabled = false\n"], [81, "  auto_grow_enabled            = true\n"], [82, "  administrator_login          = \"terragoat\"\n"], [83, "  administrator_login_password = \"Aa12345678\"\n"], [84, "  version                      = \"9.5\"\n"], [85, "  ssl_enforcement_enabled      = false\n"], [86, "  tags = {\n"], [87, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [88, "    git_file             = \"terraform/azure/sql.tf\"\n"], [89, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [90, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [91, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [92, "    git_org              = \"bridgecrewio\"\n"], [93, "    git_repo             = \"terragoat\"\n"], [94, "    yor_trace            = \"9eae126d-9404-4511-9c32-2243457df459\"\n"], [95, "  }\n"], [96, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [73, 96], "resource": "azurerm_postgresql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLMinTLSVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-azure-postgresql-uses-the-latest-version-of-tls-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_102", "bc_check_id": "BC_AZR_GENERAL_16", "check_name": "Ensure that PostgreSQL server enables geo-redundant backups", "check_result": {"result": "FAILED", "evaluated_keys": ["geo_redundant_backup_enabled"]}, "code_block": [[73, "resource \"azurerm_postgresql_server\" \"example\" {\n"], [74, "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"\n"], [75, "  location                     = azurerm_resource_group.example.location\n"], [76, "  resource_group_name          = azurerm_resource_group.example.name\n"], [77, "  sku_name                     = \"B_Gen5_2\"\n"], [78, "  storage_mb                   = 5120\n"], [79, "  backup_retention_days        = 7\n"], [80, "  geo_redundant_backup_enabled = false\n"], [81, "  auto_grow_enabled            = true\n"], [82, "  administrator_login          = \"terragoat\"\n"], [83, "  administrator_login_password = \"Aa12345678\"\n"], [84, "  version                      = \"9.5\"\n"], [85, "  ssl_enforcement_enabled      = false\n"], [86, "  tags = {\n"], [87, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [88, "    git_file             = \"terraform/azure/sql.tf\"\n"], [89, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [90, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [91, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [92, "    git_org              = \"bridgecrewio\"\n"], [93, "    git_repo             = \"terragoat\"\n"], [94, "    yor_trace            = \"9eae126d-9404-4511-9c32-2243457df459\"\n"], [95, "  }\n"], [96, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [73, 96], "resource": "azurerm_postgresql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgressSQLGeoBackupEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-postgresql-server-enables-geo-redundant-backups.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_68", "bc_check_id": "BC_AZR_NETWORKING_20", "check_name": "Ensure that PostgreSQL server disables public network access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[73, "resource \"azurerm_postgresql_server\" \"example\" {\n"], [74, "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"\n"], [75, "  location                     = azurerm_resource_group.example.location\n"], [76, "  resource_group_name          = azurerm_resource_group.example.name\n"], [77, "  sku_name                     = \"B_Gen5_2\"\n"], [78, "  storage_mb                   = 5120\n"], [79, "  backup_retention_days        = 7\n"], [80, "  geo_redundant_backup_enabled = false\n"], [81, "  auto_grow_enabled            = true\n"], [82, "  administrator_login          = \"terragoat\"\n"], [83, "  administrator_login_password = \"Aa12345678\"\n"], [84, "  version                      = \"9.5\"\n"], [85, "  ssl_enforcement_enabled      = false\n"], [86, "  tags = {\n"], [87, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [88, "    git_file             = \"terraform/azure/sql.tf\"\n"], [89, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [90, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [91, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [92, "    git_org              = \"bridgecrewio\"\n"], [93, "    git_repo             = \"terragoat\"\n"], [94, "    yor_trace            = \"9eae126d-9404-4511-9c32-2243457df459\"\n"], [95, "  }\n"], [96, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [73, 96], "resource": "azurerm_postgresql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerPublicAccessDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-postgresql-server-disables-public-network-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_130", "bc_check_id": "BC_AZR_GENERAL_24", "check_name": "Ensure that PostgreSQL server enables infrastructure encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["infrastructure_encryption_enabled"]}, "code_block": [[73, "resource \"azurerm_postgresql_server\" \"example\" {\n"], [74, "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"\n"], [75, "  location                     = azurerm_resource_group.example.location\n"], [76, "  resource_group_name          = azurerm_resource_group.example.name\n"], [77, "  sku_name                     = \"B_Gen5_2\"\n"], [78, "  storage_mb                   = 5120\n"], [79, "  backup_retention_days        = 7\n"], [80, "  geo_redundant_backup_enabled = false\n"], [81, "  auto_grow_enabled            = true\n"], [82, "  administrator_login          = \"terragoat\"\n"], [83, "  administrator_login_password = \"Aa12345678\"\n"], [84, "  version                      = \"9.5\"\n"], [85, "  ssl_enforcement_enabled      = false\n"], [86, "  tags = {\n"], [87, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [88, "    git_file             = \"terraform/azure/sql.tf\"\n"], [89, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [90, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [91, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [92, "    git_org              = \"bridgecrewio\"\n"], [93, "    git_repo             = \"terragoat\"\n"], [94, "    yor_trace            = \"9eae126d-9404-4511-9c32-2243457df459\"\n"], [95, "  }\n"], [96, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [73, 96], "resource": "azurerm_postgresql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLEncryptionEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-postgresql-server-enables-infrastructure-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_128", "bc_check_id": "BC_AZR_GENERAL_45", "check_name": "Ensure that PostgreSQL server enables Threat detection policy", "check_result": {"result": "FAILED", "evaluated_keys": ["threat_detection_policy/[0]/enabled"]}, "code_block": [[73, "resource \"azurerm_postgresql_server\" \"example\" {\n"], [74, "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"\n"], [75, "  location                     = azurerm_resource_group.example.location\n"], [76, "  resource_group_name          = azurerm_resource_group.example.name\n"], [77, "  sku_name                     = \"B_Gen5_2\"\n"], [78, "  storage_mb                   = 5120\n"], [79, "  backup_retention_days        = 7\n"], [80, "  geo_redundant_backup_enabled = false\n"], [81, "  auto_grow_enabled            = true\n"], [82, "  administrator_login          = \"terragoat\"\n"], [83, "  administrator_login_password = \"Aa12345678\"\n"], [84, "  version                      = \"9.5\"\n"], [85, "  ssl_enforcement_enabled      = false\n"], [86, "  tags = {\n"], [87, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [88, "    git_file             = \"terraform/azure/sql.tf\"\n"], [89, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [90, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [91, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [92, "    git_org              = \"bridgecrewio\"\n"], [93, "    git_repo             = \"terragoat\"\n"], [94, "    yor_trace            = \"9eae126d-9404-4511-9c32-2243457df459\"\n"], [95, "  }\n"], [96, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [73, 96], "resource": "azurerm_postgresql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgresSQLTreatDetectionEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-postgresql-server-enables-threat-detection-policy.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_29", "bc_check_id": "BC_AZR_NETWORKING_10", "check_name": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server", "check_result": {"result": "FAILED", "evaluated_keys": ["ssl_enforcement_enabled"]}, "code_block": [[73, "resource \"azurerm_postgresql_server\" \"example\" {\n"], [74, "  name                         = \"terragoat-postgresql-${var.environment}${random_integer.rnd_int.result}\"\n"], [75, "  location                     = azurerm_resource_group.example.location\n"], [76, "  resource_group_name          = azurerm_resource_group.example.name\n"], [77, "  sku_name                     = \"B_Gen5_2\"\n"], [78, "  storage_mb                   = 5120\n"], [79, "  backup_retention_days        = 7\n"], [80, "  geo_redundant_backup_enabled = false\n"], [81, "  auto_grow_enabled            = true\n"], [82, "  administrator_login          = \"terragoat\"\n"], [83, "  administrator_login_password = \"Aa12345678\"\n"], [84, "  version                      = \"9.5\"\n"], [85, "  ssl_enforcement_enabled      = false\n"], [86, "  tags = {\n"], [87, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [88, "    git_file             = \"terraform/azure/sql.tf\"\n"], [89, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [90, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [91, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [92, "    git_org              = \"bridgecrewio\"\n"], [93, "    git_repo             = \"terragoat\"\n"], [94, "    yor_trace            = \"9eae126d-9404-4511-9c32-2243457df459\"\n"], [95, "  }\n"], [96, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [73, 96], "resource": "azurerm_postgresql_server.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerSSLEnforcementEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-10.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_32", "bc_check_id": "BC_AZR_NETWORKING_13", "check_name": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "FAILED", "evaluated_keys": ["name", "value"]}, "code_block": [[98, "resource \"azurerm_postgresql_configuration\" \"thrtottling_config\" {\n"], [99, "  name                = \"connection_throttling\"\n"], [100, "  resource_group_name = azurerm_resource_group.example.name\n"], [101, "  server_name         = azurerm_postgresql_server.example.name\n"], [102, "  value               = \"off\"\n"], [103, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [98, 103], "resource": "azurerm_postgresql_configuration.thrtottling_config", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerConnectionThrottlingEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-13.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_30", "bc_check_id": "BC_AZR_NETWORKING_11", "check_name": "Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server", "check_result": {"result": "FAILED", "evaluated_keys": ["name", "value"]}, "code_block": [[105, "resource \"azurerm_postgresql_configuration\" \"example\" {\n"], [106, "  name                = \"log_checkpoints\"\n"], [107, "  resource_group_name = azurerm_resource_group.example.name\n"], [108, "  server_name         = azurerm_postgresql_server.example.name\n"], [109, "  value               = \"off\"\n"], [110, "}"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [105, 110], "resource": "azurerm_postgresql_configuration.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLServerLogCheckpointsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/bc-azr-networking-11.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/sql.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "server_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_postgresql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_93", "bc_check_id": "BC_AZR_GENERAL_29", "check_name": "Ensure that managed disks use a specific set of disk encryption sets for the customer-managed key encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["disk_encryption_set_id"]}, "code_block": [[1, "resource \"azurerm_managed_disk\" \"example\" {\n"], [2, "  name                 = \"terragoat-disk-${var.environment}\"\n"], [3, "  location             = var.location\n"], [4, "  resource_group_name  = azurerm_resource_group.example.name\n"], [5, "  storage_account_type = \"Standard_LRS\"\n"], [6, "  create_option        = \"Empty\"\n"], [7, "  disk_size_gb         = 1\n"], [8, "  encryption_settings {\n"], [9, "    enabled = false\n"], [10, "  }\n"], [11, "  tags = {\n"], [12, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [13, "    git_file             = \"terraform/azure/storage.tf\"\n"], [14, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [15, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [16, "    git_modifiers        = \"nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"d17da7b3-f1c5-4723-9f77-d1b9069459c7\"\n"], [20, "  }\n"], [21, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [1, 21], "resource": "azurerm_managed_disk.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureManagedDiskEncryptionSet", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-managed-disks-use-a-specific-set-of-disk-encryption-sets-for-the-customer-managed-key-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_2", "bc_check_id": "BC_AZR_GENERAL_1", "check_name": "Ensure Azure managed disk has encryption enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["encryption_settings/[0]/enabled"]}, "code_block": [[1, "resource \"azurerm_managed_disk\" \"example\" {\n"], [2, "  name                 = \"terragoat-disk-${var.environment}\"\n"], [3, "  location             = var.location\n"], [4, "  resource_group_name  = azurerm_resource_group.example.name\n"], [5, "  storage_account_type = \"Standard_LRS\"\n"], [6, "  create_option        = \"Empty\"\n"], [7, "  disk_size_gb         = 1\n"], [8, "  encryption_settings {\n"], [9, "    enabled = false\n"], [10, "  }\n"], [11, "  tags = {\n"], [12, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [13, "    git_file             = \"terraform/azure/storage.tf\"\n"], [14, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [15, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [16, "    git_modifiers        = \"nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"d17da7b3-f1c5-4723-9f77-d1b9069459c7\"\n"], [20, "  }\n"], [21, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [1, 21], "resource": "azurerm_managed_disk.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AzureManagedDiskEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/bc-azr-general-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_190", "bc_check_id": null, "check_name": "Ensure that Storage blobs restrict public access", "check_result": {"result": "FAILED", "evaluated_keys": ["allow_nested_items_to_be_public"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageBlobRestrictPublicAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_59", "bc_check_id": "BC_AZR_NETWORKING_18", "check_name": "Ensure that Storage accounts disallow public access", "check_result": {"result": "FAILED", "evaluated_keys": ["public_network_access_enabled"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountDisablePublicAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_44", "bc_check_id": "BC_AZR_STORAGE_2", "check_name": "Ensure Storage Account is using the latest version of TLS encryption", "check_result": {"result": "FAILED", "evaluated_keys": ["min_tls_version"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountMinimumTlsVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-storage-policies/bc-azr-storage-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_33", "bc_check_id": "BC_AZR_LOGGING_4", "check_name": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "check_result": {"result": "FAILED", "evaluated_keys": ["queue_properties/[0]/logging/[0]"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountLoggingQueueServiceEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_36", "bc_check_id": "BC_AZR_NETWORKING_16", "check_name": "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access", "check_result": {"result": "FAILED", "evaluated_keys": ["bypass"]}, "code_block": [[62, "resource \"azurerm_storage_account_network_rules\" \"test\" {\n"], [63, "  resource_group_name  = azurerm_resource_group.example.name\n"], [64, "  storage_account_name = azurerm_storage_account.example.name\n"], [65, "\n"], [66, "  default_action = \"Deny\"\n"], [67, "  ip_rules       = [\"127.0.0.1\"]\n"], [68, "  bypass         = [\"Metrics\"]\n"], [69, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [62, 69], "resource": "azurerm_storage_account_network_rules.test", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountAzureServicesAccessEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/azure/storage.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "storage_account_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_109", "bc_check_id": null, "check_name": "Ensure the GCP PostgreSQL database log levels are set to ERROR or lower", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogMinErrorStatement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_54", "bc_check_id": "BC_GCP_SQL_5", "check_name": "Ensure PostgreSQL database 'log_lock_waits' flag is set to 'on'", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogLockWaits", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_52", "bc_check_id": "BC_GCP_SQL_3", "check_name": "Ensure PostgreSQL database 'log_connections' flag is set to 'on'", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogConnection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_51", "bc_check_id": "BC_GCP_SQL_2", "check_name": "Ensure PostgreSQL database 'log_checkpoints' flag is set to 'on'", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogCheckpoints", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_79", "bc_check_id": "BC_GCP_GENERAL_13", "check_name": "Ensure SQL database is using latest Major version", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.CloudSqlMajorVersion", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-sql-database-uses-the-latest-major-version.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_14", "bc_check_id": "BC_GCP_GENERAL_6", "check_name": "Ensure all Cloud SQL database instance have backup configuration enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["settings/[0]/backup_configuration/[0]/enabled"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlBackupConfiguration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_6", "bc_check_id": "BC_GCP_GENERAL_5", "check_name": "Ensure all Cloud SQL database instance requires all incoming connections to use SSL", "check_result": {"result": "FAILED", "evaluated_keys": ["settings/[0]/ip_configuration/[0]/require_ssl/[0]"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlDatabaseRequireSsl", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_110", "bc_check_id": null, "check_name": "Ensure pgAudit is enabled for your GCP PostgreSQL database", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlEnablePgaudit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_60", "bc_check_id": "BC_GCP_SQL_11", "check_name": "Ensure Cloud SQL database does not have public IP", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/SQLSERVER", "settings/[0]/ip_configuration/[0]/ipv4_enabled"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlServerNoPublicIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-11.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_53", "bc_check_id": "BC_GCP_SQL_4", "check_name": "Ensure PostgreSQL database 'log_disconnections' flag is set to 'on'", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogDisconnection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/cloud-sql-policies/bc-gcp-sql-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_108", "bc_check_id": null, "check_name": "Ensure hostnames are logged for GCP PostgreSQL databases", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogHostname", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_111", "bc_check_id": null, "check_name": "Ensure GCP PostgreSQL logs SQL statements", "check_result": {"result": "FAILED", "evaluated_keys": ["database_version/[0]/POSTGRES", "settings"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudPostgreSqlLogStatement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_11", "bc_check_id": "BC_GCP_NETWORKING_4", "check_name": "Ensure that Cloud SQL database Instances are not open to the world", "check_result": {"result": "FAILED", "evaluated_keys": ["settings/[0]/ip_configuration/authorized_networks/[0]/value", "settings/[0]/ip_configuration/authorized_networks/[0]/[0]/value"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleCloudSqlDatabasePubliclyAccessible", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_15", "bc_check_id": "BC_GCP_GENERAL_7", "check_name": "Ensure that BigQuery datasets are not anonymously or publicly accessible", "check_result": {"result": "FAILED", "evaluated_keys": ["access/[0]/special_group"]}, "code_block": [[21, "resource \"google_bigquery_dataset\" \"dataset\" {\n"], [22, "  dataset_id = \"terragoat_${var.environment}_dataset\"\n"], [23, "  access {\n"], [24, "    special_group = \"allAuthenticatedUsers\"\n"], [25, "    role          = \"READER\"\n"], [26, "  }\n"], [27, "  labels = {\n"], [28, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [29, "    git_file             = \"terraform__gcp__big_data_tf\"\n"], [30, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [31, "    git_last_modified_by = \"jameswoolfenden\"\n"], [32, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"2560d883-bc3a-4cb6-b9fc-fb666edf626e\"\n"], [36, "  }\n"], [37, "}"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [21, 37], "resource": "google_bigquery_dataset.dataset", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleBigQueryDatasetPublicACL", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"dataset_id": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_81", "bc_check_id": "BC_GCP_GENERAL_32", "check_name": "Ensure Big Query Datasets are encrypted with Customer Supplied Encryption Keys (CSEK)", "check_result": {"result": "FAILED", "evaluated_keys": ["default_encryption_configuration/[0]/kms_key_name"]}, "code_block": [[21, "resource \"google_bigquery_dataset\" \"dataset\" {\n"], [22, "  dataset_id = \"terragoat_${var.environment}_dataset\"\n"], [23, "  access {\n"], [24, "    special_group = \"allAuthenticatedUsers\"\n"], [25, "    role          = \"READER\"\n"], [26, "  }\n"], [27, "  labels = {\n"], [28, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [29, "    git_file             = \"terraform__gcp__big_data_tf\"\n"], [30, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [31, "    git_last_modified_by = \"jameswoolfenden\"\n"], [32, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"2560d883-bc3a-4cb6-b9fc-fb666edf626e\"\n"], [36, "  }\n"], [37, "}"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [21, 37], "resource": "google_bigquery_dataset.dataset", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.BigQueryDatasetEncryptedWithCMK", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-big-query-tables-are-encrypted-with-customer-supplied-encryption-keys-csek-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/big_data.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"dataset_id": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_29", "bc_check_id": "BC_GCP_GCS_2", "check_name": "Ensure that Cloud Storage buckets have uniform bucket-level access enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["uniform_bucket_level_access"]}, "code_block": [[1, "resource \"google_storage_bucket\" \"terragoat_website\" {\n"], [2, "  name          = \"terragot-${var.environment}\"\n"], [3, "  location      = var.location\n"], [4, "  force_destroy = true\n"], [5, "  labels = {\n"], [6, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [7, "    git_file             = \"terraform__gcp__gcs_tf\"\n"], [8, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [9, "    git_last_modified_by = \"jameswoolfenden\"\n"], [10, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [11, "    git_org              = \"bridgecrewio\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"bd00cd2e-f53f-4daf-8d4d-74c47846c1cc\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/gcp/gcs.tf", "file_abs_path": "/terraform/terraform/gcp/gcs.tf", "repo_file_path": "/terraform/gcp/gcs.tf", "file_line_range": [1, 15], "resource": "google_storage_bucket.terragoat_website", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleStorageBucketUniformAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-storage-gcs-policies/bc-gcp-gcs-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gcs.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_62", "bc_check_id": "BC_GCP_GCS_3", "check_name": "Bucket should log access", "check_result": {"result": "FAILED", "evaluated_keys": ["logging/[0]/log_bucket"]}, "code_block": [[1, "resource \"google_storage_bucket\" \"terragoat_website\" {\n"], [2, "  name          = \"terragot-${var.environment}\"\n"], [3, "  location      = var.location\n"], [4, "  force_destroy = true\n"], [5, "  labels = {\n"], [6, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [7, "    git_file             = \"terraform__gcp__gcs_tf\"\n"], [8, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [9, "    git_last_modified_by = \"jameswoolfenden\"\n"], [10, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [11, "    git_org              = \"bridgecrewio\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"bd00cd2e-f53f-4daf-8d4d-74c47846c1cc\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/gcp/gcs.tf", "file_abs_path": "/terraform/terraform/gcp/gcs.tf", "repo_file_path": "/terraform/gcp/gcs.tf", "file_line_range": [1, 15], "resource": "google_storage_bucket.terragoat_website", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.CloudStorageLogging", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-storage-gcs-policies/bc-gcp-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gcs.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_114", "bc_check_id": null, "check_name": "Ensure public access prevention is enforced on Cloud Storage bucket", "check_result": {"result": "FAILED", "evaluated_keys": ["public_access_prevention"]}, "code_block": [[1, "resource \"google_storage_bucket\" \"terragoat_website\" {\n"], [2, "  name          = \"terragot-${var.environment}\"\n"], [3, "  location      = var.location\n"], [4, "  force_destroy = true\n"], [5, "  labels = {\n"], [6, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [7, "    git_file             = \"terraform__gcp__gcs_tf\"\n"], [8, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [9, "    git_last_modified_by = \"jameswoolfenden\"\n"], [10, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [11, "    git_org              = \"bridgecrewio\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"bd00cd2e-f53f-4daf-8d4d-74c47846c1cc\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/gcp/gcs.tf", "file_abs_path": "/terraform/terraform/gcp/gcs.tf", "repo_file_path": "/terraform/gcp/gcs.tf", "file_line_range": [1, 15], "resource": "google_storage_bucket.terragoat_website", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleStoragePublicAccessPrevention", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gcs.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_78", "bc_check_id": "BC_GCP_GENERAL_39", "check_name": "Ensure Cloud storage has versioning enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["versioning/[0]/enabled"]}, "code_block": [[1, "resource \"google_storage_bucket\" \"terragoat_website\" {\n"], [2, "  name          = \"terragot-${var.environment}\"\n"], [3, "  location      = var.location\n"], [4, "  force_destroy = true\n"], [5, "  labels = {\n"], [6, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [7, "    git_file             = \"terraform__gcp__gcs_tf\"\n"], [8, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [9, "    git_last_modified_by = \"jameswoolfenden\"\n"], [10, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [11, "    git_org              = \"bridgecrewio\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"bd00cd2e-f53f-4daf-8d4d-74c47846c1cc\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/gcp/gcs.tf", "file_abs_path": "/terraform/terraform/gcp/gcs.tf", "repo_file_path": "/terraform/gcp/gcs.tf", "file_line_range": [1, 15], "resource": "google_storage_bucket.terragoat_website", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.CloudStorageVersioningEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-cloud-storage-has-versioning-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gcs.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_28", "bc_check_id": "BC_GCP_PUBLIC_1", "check_name": "Ensure that Cloud Storage bucket is not anonymously or publicly accessible", "check_result": {"result": "FAILED", "evaluated_keys": ["members", "member"]}, "code_block": [[17, "resource \"google_storage_bucket_iam_binding\" \"allow_public_read\" {\n"], [18, "  bucket  = google_storage_bucket.terragoat_website.id\n"], [19, "  members = [\"allUsers\"]\n"], [20, "  role    = \"roles/storage.objectViewer\"\n"], [21, "}"]], "file_path": "/terraform/gcp/gcs.tf", "file_abs_path": "/terraform/terraform/gcp/gcs.tf", "repo_file_path": "/terraform/gcp/gcs.tf", "file_line_range": [17, 21], "resource": "google_storage_bucket_iam_binding.allow_public_read", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleStorageBucketNotPublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-public-policies/bc-gcp-public-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gcs.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_GCP_24", "bc_check_id": "BC_GCP_KUBERNETES_9", "check_name": "Ensure PodSecurityPolicy controller is enabled on the Kubernetes Engine Clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["pod_security_policy_config/[0]/enabled"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEPodSecurityPolicyEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-9.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_12", "bc_check_id": "BC_GCP_KUBERNETES_7", "check_name": "Ensure Network Policy is enabled on Kubernetes Engine Clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["network_policy/[0]/enabled"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKENetworkPolicyEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-7.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_64", "bc_check_id": "BC_GCP_KUBERNETES_19", "check_name": "Ensure clusters are created with Private Nodes", "check_result": {"result": "FAILED", "evaluated_keys": ["private_cluster_config"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEPrivateNodes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-clusters-are-created-with-private-nodes.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_25", "bc_check_id": "BC_GCP_KUBERNETES_6", "check_name": "Ensure Kubernetes Cluster is created with Private cluster enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["private_cluster_config"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEPrivateClusterConfig", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_8", "bc_check_id": "BC_GCP_KUBERNETES_3", "check_name": "Ensure Stackdriver Monitoring is set to Enabled on Kubernetes Engine Clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["monitoring_service/0"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMonitoringEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-3.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_70", "bc_check_id": "BC_GCP_KUBERNETES_26", "check_name": "Ensure the GKE Release Channel is set", "check_result": {"result": "FAILED", "evaluated_keys": ["release_channel/[0]/channel"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEReleaseChannel", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-release-channel-is-set.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_66", "bc_check_id": "BC_GCP_KUBERNETES_21", "check_name": "Ensure use of Binary Authorization", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEBinaryAuthorization", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-use-of-binary-authorization.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_65", "bc_check_id": "BC_GCP_KUBERNETES_20", "check_name": "Manage Kubernetes RBAC users with Google Groups for GKE", "check_result": {"result": "FAILED", "evaluated_keys": ["authenticator_groups_config/[0]/security_group"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEKubernetesRBACGoogleGroups", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/manage-kubernetes-rbac-users-with-google-groups-for-gke.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_69", "bc_check_id": "BC_GCP_KUBERNETES_23", "check_name": "Ensure the GKE Metadata Server is Enabled", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMetadataServerIsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-metadata-server-is-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_7", "bc_check_id": "BC_GCP_KUBERNETES_2", "check_name": "Ensure Legacy Authorization is set to Disabled on Kubernetes Engine Clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_legacy_abac"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEDisableLegacyAuth", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_21", "bc_check_id": "BC_GCP_KUBERNETES_13", "check_name": "Ensure Kubernetes Clusters are configured with Labels", "check_result": {"result": "FAILED", "evaluated_keys": ["resource_labels"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEHasLabels", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-13.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_23", "bc_check_id": "BC_GCP_KUBERNETES_15", "check_name": "Ensure Kubernetes Cluster is created with Alias IP ranges enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["ip_allocation_policy"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEAliasIpEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-15.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_18", "bc_check_id": "BC_GCP_KUBERNETES_10", "check_name": "Ensure GKE Control Plane is not public", "check_result": {"result": "FAILED", "evaluated_keys": ["master_authorized_networks_config/[0]/cidr_blocks/[0]/cidr_block"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEPublicControlPlane", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-10.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_61", "bc_check_id": "BC_GCP_KUBERNETES_18", "check_name": "Enable VPC Flow Logs and Intranode Visibility", "check_result": {"result": "FAILED", "evaluated_keys": ["enable_intranode_visibility"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEEnableVPCFlowLogs", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/enable-vpc-flow-logs-and-intranode-visibility.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_1", "bc_check_id": "BC_GCP_KUBERNETES_1", "check_name": "Ensure Stackdriver Logging is set to Enabled on Kubernetes Engine Clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["logging_service"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEClusterLogging", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_13", "bc_check_id": "BC_GCP_KUBERNETES_8", "check_name": "Ensure client certificate authentication to Kubernetes Engine Clusters is disabled", "check_result": {"result": "FAILED", "evaluated_keys": ["master_auth/[0]/client_certificate_config/[0]/issue_client_certificate/[0]"]}, "code_block": [[6, "resource \"google_container_cluster\" \"workload_cluster\" {\n"], [7, "  name               = \"terragoat-${var.environment}-cluster\"\n"], [8, "  logging_service    = \"none\"\n"], [9, "  location           = var.region\n"], [10, "  initial_node_count = 1\n"], [11, "\n"], [12, "  enable_legacy_abac       = true\n"], [13, "  monitoring_service       = \"none\"\n"], [14, "  remove_default_node_pool = true\n"], [15, "  network                  = google_compute_network.vpc.name\n"], [16, "  subnetwork               = google_compute_subnetwork.public-subnetwork.name\n"], [17, "  master_authorized_networks_config {\n"], [18, "    cidr_blocks {\n"], [19, "      cidr_block = \"0.0.0.0/0\"\n"], [20, "    }\n"], [21, "  }\n"], [22, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [6, 22], "resource": "google_container_cluster.workload_cluster", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEClientCertificateDisabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}], "network": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_network.vpc", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}], "subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_68", "bc_check_id": "BC_GCP_KUBERNETES_17", "check_name": "Ensure Secure Boot for Shielded GKE Nodes is Enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["node_config/[0]/shielded_instance_config/[0]/enable_secure_boot"]}, "code_block": [[24, "resource \"google_container_node_pool\" \"custom_node_pool\" {\n"], [25, "  cluster  = google_container_cluster.workload_cluster.name\n"], [26, "  location = var.region\n"], [27, "\n"], [28, "  node_config {\n"], [29, "    image_type = \"Ubuntu\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [24, 31], "resource": "google_container_node_pool.custom_node_pool", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKESecureBootforShieldedNodes", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-secure-boot-for-shielded-gke-nodes-is-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_10", "bc_check_id": "BC_GCP_KUBERNETES_5", "check_name": "Ensure 'Automatic node upgrade' is enabled for Kubernetes Clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["management/[0]/auto_upgrade/[0]"]}, "code_block": [[24, "resource \"google_container_node_pool\" \"custom_node_pool\" {\n"], [25, "  cluster  = google_container_cluster.workload_cluster.name\n"], [26, "  location = var.region\n"], [27, "\n"], [28, "  node_config {\n"], [29, "    image_type = \"Ubuntu\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [24, 31], "resource": "google_container_node_pool.custom_node_pool", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKENodePoolAutoUpgradeEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-5.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_69", "bc_check_id": "BC_GCP_KUBERNETES_23", "check_name": "Ensure the GKE Metadata Server is Enabled", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[24, "resource \"google_container_node_pool\" \"custom_node_pool\" {\n"], [25, "  cluster  = google_container_cluster.workload_cluster.name\n"], [26, "  location = var.region\n"], [27, "\n"], [28, "  node_config {\n"], [29, "    image_type = \"Ubuntu\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [24, 31], "resource": "google_container_node_pool.custom_node_pool", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEMetadataServerIsEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/ensure-the-gke-metadata-server-is-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_22", "bc_check_id": "BC_GCP_KUBERNETES_14", "check_name": "Ensure Container-Optimized OS (cos) is used for Kubernetes Engine Clusters Node image", "check_result": {"result": "FAILED", "evaluated_keys": ["node_config"]}, "code_block": [[24, "resource \"google_container_node_pool\" \"custom_node_pool\" {\n"], [25, "  cluster  = google_container_cluster.workload_cluster.name\n"], [26, "  location = var.region\n"], [27, "\n"], [28, "  node_config {\n"], [29, "    image_type = \"Ubuntu\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [24, 31], "resource": "google_container_node_pool.custom_node_pool", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKEUseCosImage", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-14.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_9", "bc_check_id": "BC_GCP_KUBERNETES_4", "check_name": "Ensure 'Automatic node repair' is enabled for Kubernetes Clusters", "check_result": {"result": "FAILED", "evaluated_keys": ["management/[0]/auto_repair/[0]"]}, "code_block": [[24, "resource \"google_container_node_pool\" \"custom_node_pool\" {\n"], [25, "  cluster  = google_container_cluster.workload_cluster.name\n"], [26, "  location = var.region\n"], [27, "\n"], [28, "  node_config {\n"], [29, "    image_type = \"Ubuntu\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/gcp/gke.tf", "file_abs_path": "/terraform/terraform/gcp/gke.tf", "repo_file_path": "/terraform/gcp/gke.tf", "file_line_range": [24, 31], "resource": "google_container_node_pool.custom_node_pool", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GKENodePoolAutoRepairEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-kubernetes-policies/bc-gcp-kubernetes-4.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/gke.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"location": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "cluster": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_container_cluster.workload_cluster", "path": "/terraform/terraform/gcp/gke.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_39", "bc_check_id": "BC_GCP_GENERAL_3", "check_name": "Ensure Compute instances are launched with Shielded VM enabled", "check_result": {"result": "FAILED", "evaluated_keys": []}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeShieldedVM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-y.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_35", "bc_check_id": "BC_GCP_NETWORKING_11", "check_name": "Ensure 'Enable connecting to serial ports' is not enabled for VM Instance", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata/[0]/serial-port-enable"]}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeSerialPorts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-11.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_36", "bc_check_id": "BC_GCP_NETWORKING_12", "check_name": "Ensure that IP forwarding is not enabled on Instances", "check_result": {"result": "FAILED", "evaluated_keys": ["can_ip_forward"]}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeIPForward", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-12.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_38", "bc_check_id": "BC_GCP_GENERAL_2", "check_name": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "check_result": {"result": "FAILED", "evaluated_keys": ["boot_disk", "boot_disk/[0]/disk_encryption_key_raw", "boot_disk/[0]/kms_key_self_link"]}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeBootDiskEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/encrypt-boot-disks-for-instances-with-cseks.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_40", "bc_check_id": "BC_GCP_PUBLIC_2", "check_name": "Ensure that Compute instances do not have public IP addresses", "check_result": {"result": "FAILED", "evaluated_keys": ["network_interface/[0]/access_config"]}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeExternalIP", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-public-policies/bc-gcp-public-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_34", "bc_check_id": "BC_GCP_NETWORKING_10", "check_name": "Ensure that no instance in the project overrides the project setting for enabling OSLogin(OSLogin needs to be enabled in project metadata for all instances)", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata/[0]/enable-oslogin"]}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeInstanceOSLogin", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-10.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_32", "bc_check_id": "BC_GCP_NETWORKING_8", "check_name": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata/block-project-ssh-keys"]}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeBlockProjectSSH", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-8.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_30", "bc_check_id": "BC_GCP_IAM_1", "check_name": "Ensure that instances are not configured to use the default service account", "check_result": {"result": "FAILED", "evaluated_keys": ["service_account/[0]/email", "name"]}, "code_block": [[3, "resource \"google_compute_instance\" \"server\" {\n"], [4, "  machine_type = \"n1-standard-1\"\n"], [5, "  name         = \"terragoat-${var.environment}-machine\"\n"], [6, "  zone         = data.google_compute_zones.zones.names[0]\n"], [7, "  boot_disk {\n"], [8, "    initialize_params {\n"], [9, "      image = \"debian-cloud/debian-9\"\n"], [10, "    }\n"], [11, "    auto_delete = true\n"], [12, "  }\n"], [13, "  network_interface {\n"], [14, "    subnetwork = google_compute_subnetwork.public-subnetwork.name\n"], [15, "    access_config {}\n"], [16, "  }\n"], [17, "  can_ip_forward = true\n"], [18, "\n"], [19, "  metadata = {\n"], [20, "    block-project-ssh-keys = false\n"], [21, "    enable-oslogin         = false\n"], [22, "    serial-port-enable     = true\n"], [23, "  }\n"], [24, "  labels = {\n"], [25, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [26, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [27, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [28, "    git_last_modified_by = \"jameswoolfenden\"\n"], [29, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [30, "    git_org              = \"bridgecrewio\"\n"], [31, "    git_repo             = \"terragoat\"\n"], [32, "    yor_trace            = \"cd562b76-fbce-4e60-8c75-c9f43d7ffc16\"\n"], [33, "  }\n"], [34, "}\n"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [3, 34], "resource": "google_compute_instance.server", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeDefaultServiceAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-iam-policies/bc-gcp-iam-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "network_interface.subnetwork": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_37", "bc_check_id": "BC_GCP_GENERAL_1", "check_name": "Ensure VM disks for critical VMs are encrypted with Customer Supplied Encryption Keys (CSEK)", "check_result": {"result": "FAILED", "evaluated_keys": ["disk_encryption_key"]}, "code_block": [[36, "resource \"google_compute_disk\" \"unencrypted_disk\" {\n"], [37, "  name = \"terragoat-${var.environment}-disk\"\n"], [38, "  labels = {\n"], [39, "    git_commit           = \"2bdc0871a5f4505be58244029cc6485d45d7bb8e\"\n"], [40, "    git_file             = \"terraform__gcp__instances_tf\"\n"], [41, "    git_last_modified_at = \"2022-01-19-17-02-27\"\n"], [42, "    git_last_modified_by = \"jameswoolfenden\"\n"], [43, "    git_modifiers        = \"jameswoolfenden__nimrodkor\"\n"], [44, "    git_org              = \"bridgecrewio\"\n"], [45, "    git_repo             = \"terragoat\"\n"], [46, "    yor_trace            = \"bf87b7d7-a9d8-4f03-a0d4-8a4cbb647d03\"\n"], [47, "  }\n"], [48, "}"]], "file_path": "/terraform/gcp/instances.tf", "file_abs_path": "/terraform/terraform/gcp/instances.tf", "repo_file_path": "/terraform/gcp/instances.tf", "file_line_range": [36, 48], "resource": "google_compute_disk.unencrypted_disk", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeDiskEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/bc-gcp-general-x.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/instances.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_76", "bc_check_id": "BC_GCP_NETWORKING_16", "check_name": "Ensure that Private google access is enabled for IPV6", "check_result": {"result": "FAILED", "evaluated_keys": ["private_ipv6_google_access"]}, "code_block": [[7, "resource \"google_compute_subnetwork\" \"public-subnetwork\" {\n"], [8, "  name          = \"terragoat-${var.environment}-public-subnetwork\"\n"], [9, "  ip_cidr_range = \"10.0.0.0/24\"\n"], [10, "  region        = var.region\n"], [11, "  network       = google_compute_network.vpc.id\n"], [12, "\n"], [13, "  secondary_ip_range {\n"], [14, "    range_name    = \"tf-test-secondary-range-update1\"\n"], [15, "    ip_cidr_range = \"192.168.10.0/24\"\n"], [16, "  }\n"], [17, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [7, 17], "resource": "google_compute_subnetwork.public-subnetwork", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleSubnetworkIPV6PrivateGoogleEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-private-google-access-is-enabled-for-ipv6.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_26", "bc_check_id": "BC_GCP_LOGGING_1", "check_name": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network", "check_result": {"result": "FAILED", "evaluated_keys": ["log_config"]}, "code_block": [[7, "resource \"google_compute_subnetwork\" \"public-subnetwork\" {\n"], [8, "  name          = \"terragoat-${var.environment}-public-subnetwork\"\n"], [9, "  ip_cidr_range = \"10.0.0.0/24\"\n"], [10, "  region        = var.region\n"], [11, "  network       = google_compute_network.vpc.id\n"], [12, "\n"], [13, "  secondary_ip_range {\n"], [14, "    range_name    = \"tf-test-secondary-range-update1\"\n"], [15, "    ip_cidr_range = \"192.168.10.0/24\"\n"], [16, "  }\n"], [17, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [7, 17], "resource": "google_compute_subnetwork.public-subnetwork", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleSubnetworkLoggingEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/logging-policies-1/bc-gcp-logging-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_74", "bc_check_id": "BC_GCP_GENERAL_31", "check_name": "Ensure that private_ip_google_access is enabled for Subnet", "check_result": {"result": "FAILED", "evaluated_keys": ["private_ip_google_access"]}, "code_block": [[7, "resource \"google_compute_subnetwork\" \"public-subnetwork\" {\n"], [8, "  name          = \"terragoat-${var.environment}-public-subnetwork\"\n"], [9, "  ip_cidr_range = \"10.0.0.0/24\"\n"], [10, "  region        = var.region\n"], [11, "  network       = google_compute_network.vpc.id\n"], [12, "\n"], [13, "  secondary_ip_range {\n"], [14, "    range_name    = \"tf-test-secondary-range-update1\"\n"], [15, "    ip_cidr_range = \"192.168.10.0/24\"\n"], [16, "  }\n"], [17, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [7, 17], "resource": "google_compute_subnetwork.public-subnetwork", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleSubnetworkPrivateGoogleEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-general-policies/ensure-gcp-subnet-has-a-private-ip-google-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}, {"type": "resource", "name": "google_compute_subnetwork.public-subnetwork", "path": "/terraform/terraform/gcp/networks.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_106", "bc_check_id": "BC_GCP_NETWORKING_17", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted http port 80 access", "check_result": {"result": "FAILED", "evaluated_keys": ["allow/[0]/ports", "source_ranges"]}, "code_block": [[19, "resource \"google_compute_firewall\" \"allow_all\" {\n"], [20, "  name          = \"terragoat-${var.environment}-firewall\"\n"], [21, "  network       = google_compute_network.vpc.id\n"], [22, "  source_ranges = [\"0.0.0.0/0\"]\n"], [23, "  allow {\n"], [24, "    protocol = \"tcp\"\n"], [25, "    ports    = [\"0-65535\"]\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [19, 27], "resource": "google_compute_firewall.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress80", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-http-port-80-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_3", "bc_check_id": "BC_GCP_NETWORKING_2", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted rdp access", "check_result": {"result": "FAILED", "evaluated_keys": ["allow/[0]/ports", "source_ranges"]}, "code_block": [[19, "resource \"google_compute_firewall\" \"allow_all\" {\n"], [20, "  name          = \"terragoat-${var.environment}-firewall\"\n"], [21, "  network       = google_compute_network.vpc.id\n"], [22, "  source_ranges = [\"0.0.0.0/0\"]\n"], [23, "  allow {\n"], [24, "    protocol = \"tcp\"\n"], [25, "    ports    = [\"0-65535\"]\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [19, 27], "resource": "google_compute_firewall.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3389", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-2.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_2", "bc_check_id": "BC_GCP_NETWORKING_1", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted ssh access", "check_result": {"result": "FAILED", "evaluated_keys": ["allow/[0]/ports", "source_ranges"]}, "code_block": [[19, "resource \"google_compute_firewall\" \"allow_all\" {\n"], [20, "  name          = \"terragoat-${var.environment}-firewall\"\n"], [21, "  network       = google_compute_network.vpc.id\n"], [22, "  source_ranges = [\"0.0.0.0/0\"]\n"], [23, "  allow {\n"], [24, "    protocol = \"tcp\"\n"], [25, "    ports    = [\"0-65535\"]\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [19, 27], "resource": "google_compute_firewall.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress22", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/bc-gcp-networking-1.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_88", "bc_check_id": "BC_GCP_NETWORKING_15", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted mysql access", "check_result": {"result": "FAILED", "evaluated_keys": ["allow/[0]/ports", "source_ranges"]}, "code_block": [[19, "resource \"google_compute_firewall\" \"allow_all\" {\n"], [20, "  name          = \"terragoat-${var.environment}-firewall\"\n"], [21, "  network       = google_compute_network.vpc.id\n"], [22, "  source_ranges = [\"0.0.0.0/0\"]\n"], [23, "  allow {\n"], [24, "    protocol = \"tcp\"\n"], [25, "    ports    = [\"0-65535\"]\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [19, 27], "resource": "google_compute_firewall.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress3306", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-compute-firewall-ingress-does-not-allow-unrestricted-mysql-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_75", "bc_check_id": "BC_GCP_NETWORKING_19", "check_name": "Ensure Google compute firewall ingress does not allow unrestricted FTP access", "check_result": {"result": "FAILED", "evaluated_keys": ["allow/[0]/ports", "source_ranges"]}, "code_block": [[19, "resource \"google_compute_firewall\" \"allow_all\" {\n"], [20, "  name          = \"terragoat-${var.environment}-firewall\"\n"], [21, "  network       = google_compute_network.vpc.id\n"], [22, "  source_ranges = [\"0.0.0.0/0\"]\n"], [23, "  allow {\n"], [24, "    protocol = \"tcp\"\n"], [25, "    ports    = [\"0-65535\"]\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [19, 27], "resource": "google_compute_firewall.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress21", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-unrestricted-ftp-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_GCP_77", "bc_check_id": "BC_GCP_NETWORKING_18", "check_name": "Ensure Google compute firewall ingress does not allow on ftp port", "check_result": {"result": "FAILED", "evaluated_keys": ["allow/[0]/ports", "source_ranges"]}, "code_block": [[19, "resource \"google_compute_firewall\" \"allow_all\" {\n"], [20, "  name          = \"terragoat-${var.environment}-firewall\"\n"], [21, "  network       = google_compute_network.vpc.id\n"], [22, "  source_ranges = [\"0.0.0.0/0\"]\n"], [23, "  allow {\n"], [24, "    protocol = \"tcp\"\n"], [25, "    ports    = [\"0-65535\"]\n"], [26, "  }\n"], [27, "}\n"]], "file_path": "/terraform/gcp/networks.tf", "file_abs_path": "/terraform/terraform/gcp/networks.tf", "repo_file_path": "/terraform/gcp/networks.tf", "file_line_range": [19, 27], "resource": "google_compute_firewall.allow_all", "evaluations": null, "check_class": "checkov.terraform.checks.resource.gcp.GoogleComputeFirewallUnrestrictedIngress20", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/google-cloud-policies/google-cloud-networking-policies/ensure-gcp-google-compute-firewall-ingress-does-not-allow-ftp-port-20-access.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/gcp/networks.tf\", \"tf_source_modules\": null}", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_OCI_7", "bc_check_id": "BC_OCI_STORAGE_3", "check_name": "Ensure OCI Object Storage bucket can emit object events", "check_result": {"result": "FAILED", "evaluated_keys": ["object_events_enabled"]}, "code_block": [[1, "resource \"oci_objectstorage_bucket\" \"secretsquirrel\" {\n"], [2, "  # bucket can't emit object events\n"], [3, "  # Storage hasn't versioning enabled\n"], [4, "  # Storage isn't encrypted with Customer Managed Key\n"], [5, "  # Object Storage is Public\"\n"], [6, "  compartment_id        = oci_identity_compartment.tf-compartment.id\n"], [7, "  name                  = \"myreallysecretstore\"\n"], [8, "  namespace             = data.oci_objectstorage_namespace.example.namespace\n"], [9, "  object_events_enabled = false\n"], [10, "  access_type           = \"ObjectRead\"\n"], [11, "  metadata              = { \"data\" = \"Blockofdata\" }\n"], [12, "  storage_tier          = \"Standard\"\n"], [13, "  freeform_tags = {\n"], [14, "    git_commit           = \"7a7b957091945f77ecef712a92ac719c8d9a6498\"\n"], [15, "    git_file             = \"terraform/oracle/bucket.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-06 10:43:57\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"a854aa89-5141-4518-a5dc-0ffe3075f209\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/oracle/bucket.tf", "file_abs_path": "/terraform/terraform/oracle/bucket.tf", "repo_file_path": "/terraform/oracle/bucket.tf", "file_line_range": [1, 23], "resource": "oci_objectstorage_bucket.secretsquirrel", "evaluations": null, "check_class": "checkov.terraform.checks.resource.oci.ObjectStorageEmitEvents", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/oci-policies/storage/ensure-oci-object-storage-bucket-can-emit-object-events.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/oracle/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_OCI_8", "bc_check_id": "BC_OCI_STORAGE_4", "check_name": "Ensure OCI Object Storage has versioning enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["versioning"]}, "code_block": [[1, "resource \"oci_objectstorage_bucket\" \"secretsquirrel\" {\n"], [2, "  # bucket can't emit object events\n"], [3, "  # Storage hasn't versioning enabled\n"], [4, "  # Storage isn't encrypted with Customer Managed Key\n"], [5, "  # Object Storage is Public\"\n"], [6, "  compartment_id        = oci_identity_compartment.tf-compartment.id\n"], [7, "  name                  = \"myreallysecretstore\"\n"], [8, "  namespace             = data.oci_objectstorage_namespace.example.namespace\n"], [9, "  object_events_enabled = false\n"], [10, "  access_type           = \"ObjectRead\"\n"], [11, "  metadata              = { \"data\" = \"Blockofdata\" }\n"], [12, "  storage_tier          = \"Standard\"\n"], [13, "  freeform_tags = {\n"], [14, "    git_commit           = \"7a7b957091945f77ecef712a92ac719c8d9a6498\"\n"], [15, "    git_file             = \"terraform/oracle/bucket.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-06 10:43:57\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"a854aa89-5141-4518-a5dc-0ffe3075f209\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/oracle/bucket.tf", "file_abs_path": "/terraform/terraform/oracle/bucket.tf", "repo_file_path": "/terraform/oracle/bucket.tf", "file_line_range": [1, 23], "resource": "oci_objectstorage_bucket.secretsquirrel", "evaluations": null, "check_class": "checkov.terraform.checks.resource.oci.ObjectStorageVersioning", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/oci-policies/storage/ensure-oci-object-storage-has-versioning-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/oracle/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_OCI_9", "bc_check_id": "BC_OCI_STORAGE_5", "check_name": "Ensure OCI Object Storage is encrypted with Customer Managed Key", "check_result": {"result": "FAILED", "evaluated_keys": ["kms_key_id"]}, "code_block": [[1, "resource \"oci_objectstorage_bucket\" \"secretsquirrel\" {\n"], [2, "  # bucket can't emit object events\n"], [3, "  # Storage hasn't versioning enabled\n"], [4, "  # Storage isn't encrypted with Customer Managed Key\n"], [5, "  # Object Storage is Public\"\n"], [6, "  compartment_id        = oci_identity_compartment.tf-compartment.id\n"], [7, "  name                  = \"myreallysecretstore\"\n"], [8, "  namespace             = data.oci_objectstorage_namespace.example.namespace\n"], [9, "  object_events_enabled = false\n"], [10, "  access_type           = \"ObjectRead\"\n"], [11, "  metadata              = { \"data\" = \"Blockofdata\" }\n"], [12, "  storage_tier          = \"Standard\"\n"], [13, "  freeform_tags = {\n"], [14, "    git_commit           = \"7a7b957091945f77ecef712a92ac719c8d9a6498\"\n"], [15, "    git_file             = \"terraform/oracle/bucket.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-06 10:43:57\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"a854aa89-5141-4518-a5dc-0ffe3075f209\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/oracle/bucket.tf", "file_abs_path": "/terraform/terraform/oracle/bucket.tf", "repo_file_path": "/terraform/oracle/bucket.tf", "file_line_range": [1, 23], "resource": "oci_objectstorage_bucket.secretsquirrel", "evaluations": null, "check_class": "checkov.terraform.checks.resource.oci.ObjectStorageEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/oci-policies/storage/ensure-oci-object-storage-is-encrypted-with-customer-managed-key.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/oracle/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV_OCI_10", "bc_check_id": "BC_OCI_STORAGE_6", "check_name": "Ensure OCI Object Storage is not Public", "check_result": {"result": "FAILED", "evaluated_keys": ["access_type"]}, "code_block": [[1, "resource \"oci_objectstorage_bucket\" \"secretsquirrel\" {\n"], [2, "  # bucket can't emit object events\n"], [3, "  # Storage hasn't versioning enabled\n"], [4, "  # Storage isn't encrypted with Customer Managed Key\n"], [5, "  # Object Storage is Public\"\n"], [6, "  compartment_id        = oci_identity_compartment.tf-compartment.id\n"], [7, "  name                  = \"myreallysecretstore\"\n"], [8, "  namespace             = data.oci_objectstorage_namespace.example.namespace\n"], [9, "  object_events_enabled = false\n"], [10, "  access_type           = \"ObjectRead\"\n"], [11, "  metadata              = { \"data\" = \"Blockofdata\" }\n"], [12, "  storage_tier          = \"Standard\"\n"], [13, "  freeform_tags = {\n"], [14, "    git_commit           = \"7a7b957091945f77ecef712a92ac719c8d9a6498\"\n"], [15, "    git_file             = \"terraform/oracle/bucket.tf\"\n"], [16, "    git_last_modified_at = \"2022-04-06 10:43:57\"\n"], [17, "    git_last_modified_by = \"james.woolfenden@gmail.com\"\n"], [18, "    git_modifiers        = \"james.woolfenden\"\n"], [19, "    git_org              = \"bridgecrewio\"\n"], [20, "    git_repo             = \"terragoat\"\n"], [21, "    yor_trace            = \"a854aa89-5141-4518-a5dc-0ffe3075f209\"\n"], [22, "  }\n"], [23, "}\n"]], "file_path": "/terraform/oracle/bucket.tf", "file_abs_path": "/terraform/terraform/oracle/bucket.tf", "repo_file_path": "/terraform/oracle/bucket.tf", "file_line_range": [1, 23], "resource": "oci_objectstorage_bucket.secretsquirrel", "evaluations": null, "check_class": "checkov.terraform.checks.resource.oci.ObjectStoragePublic", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/oci-policies/storage/ensure-oci-object-storage-is-not-public.html", "details": [], "check_len": null, "definition_context_file_path": "{\"file_path\": \"/terraform/terraform/oracle/bucket.tf\", \"tf_source_modules\": null}"}, {"check_id": "CKV2_GCP_13", "bc_check_id": null, "check_name": "Ensure PostgreSQL database flag 'log_duration' is set to 'on'", "check_result": {"result": "FAILED", "entity": {"google_sql_database_instance": {"master_instance": {"__end_line__": 19, "__start_line__": 1, "database_version": ["POSTGRES_11"], "name": ["terragoat-dev-master"], "region": ["us-central1"], "settings": [{"backup_configuration": [{"enabled": [false]}], "ip_configuration": [{"authorized_networks": [{"name": ["WWW"], "value": ["0.0.0.0/0"]}], "ipv4_enabled": [true]}], "tier": ["db-f1-micro"]}], "__address__": "google_sql_database_instance.master_instance"}}}, "evaluated_keys": ["settings/database_flags[?(@/name == log_duration & @/value == on)]", "database_version"]}, "code_block": [[1, "resource \"google_sql_database_instance\" \"master_instance\" {\n"], [2, "  name             = \"terragoat-${var.environment}-master\"\n"], [3, "  database_version = \"POSTGRES_11\"\n"], [4, "  region           = var.region\n"], [5, "\n"], [6, "  settings {\n"], [7, "    tier = \"db-f1-micro\"\n"], [8, "    ip_configuration {\n"], [9, "      ipv4_enabled = true\n"], [10, "      authorized_networks {\n"], [11, "        name  = \"WWW\"\n"], [12, "        value = \"0.0.0.0/0\"\n"], [13, "      }\n"], [14, "    }\n"], [15, "    backup_configuration {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "  }\n"], [19, "}\n"]], "file_path": "/terraform/gcp/big_data.tf", "file_abs_path": "/terraform/terraform/gcp/big_data.tf", "repo_file_path": "/terraform/gcp/big_data.tf", "file_line_range": [1, 19], "resource": "google_sql_database_instance.master_instance", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/gcp/big_data.tf", "breadcrumbs": {"region": [{"type": "variable", "name": "region", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/gcp/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_38", "bc_check_id": null, "check_name": "Ensure soft-delete is enabled on Azure storage account", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"security_storage_account": {"__end_line__": 18, "__start_line__": 1, "account_replication_type": ["LRS"], "account_tier": ["Standard"], "enable_https_traffic_only": [true], "location": ["East US"], "name": ["securitystorageaccount-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "a1d1c1ce31a1bde6dafa188846d90eca82abe5fd", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 05:32:41", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "4b504d4d-608c-45fe-ae56-807bde6d969f"}], "__address__": "azurerm_storage_account.security_storage_account"}}}, "evaluated_keys": ["blob_properties/delete_retention_policy/days", "blob_properties/delete_retention_policy", "account_kind"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "a1d1c1ce31a1bde6dafa188846d90eca82abe5fd", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 05:32:41", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "4b504d4d-608c-45fe-ae56-807bde6d969f"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_38", "bc_check_id": null, "check_name": "Ensure soft-delete is enabled on Azure storage account", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"example": {"__end_line__": 60, "__start_line__": 23, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "location": ["East US"], "name": ["tgsadev${random_integer.rnd_int.result}"], "queue_properties": [{"hour_metrics": [{"enabled": [true], "include_apis": [true], "retention_policy_days": [10], "version": ["1.0"]}], "logging": [{"delete": [false], "read": [false], "retention_policy_days": [10], "version": ["1.0"], "write": [true]}], "minute_metrics": [{"enabled": [true], "include_apis": [true], "retention_policy_days": [10], "version": ["1.0"]}]}], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/azure/storage.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "23861ff4-c42d-495e-80ac-776c74035f43"}], "__address__": "azurerm_storage_account.example"}}}, "evaluated_keys": ["blob_properties/delete_retention_policy/days", "blob_properties/delete_retention_policy", "account_kind"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/azure/storage.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "23861ff4-c42d-495e-80ac-776c74035f43"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/storage.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_27", "bc_check_id": null, "check_name": "Ensure Azure AD authentication is enabled for Azure SQL (MSSQL)", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql1": {"__end_line__": 37, "__start_line__": 20, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["terragoat-mssql1-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "54f6cb23-b30a-4f1d-8064-6f777b9b75db"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql1"}}}, "evaluated_keys": ["azuread_administrator", "azuread_administrator/login_username"]}, "code_block": [[20, "resource \"azurerm_mssql_server\" \"mssql1\" {\n"], [21, "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"\n"], [22, "  resource_group_name          = azurerm_resource_group.example.name\n"], [23, "  location                     = azurerm_resource_group.example.location\n"], [24, "  version                      = \"12.0\"\n"], [25, "  administrator_login          = \"missadministrator\"\n"], [26, "  administrator_login_password = \"AdminPassword123!\"\n"], [27, "  tags = {\n"], [28, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [29, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [30, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [31, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [32, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"54f6cb23-b30a-4f1d-8064-6f777b9b75db\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [20, 37], "resource": "azurerm_mssql_server.mssql1", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "54f6cb23-b30a-4f1d-8064-6f777b9b75db"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_27", "bc_check_id": null, "check_name": "Ensure Azure AD authentication is enabled for Azure SQL (MSSQL)", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql2": {"__end_line__": 56, "__start_line__": 39, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql2-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "096d2cf2-6d47-41b2-9418-cdedea85e184"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql2"}}}, "evaluated_keys": ["azuread_administrator", "azuread_administrator/login_username"]}, "code_block": [[39, "resource \"azurerm_mssql_server\" \"mssql2\" {\n"], [40, "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"\n"], [41, "  resource_group_name          = azurerm_resource_group.example.name\n"], [42, "  location                     = azurerm_resource_group.example.location\n"], [43, "  version                      = \"12.0\"\n"], [44, "  administrator_login          = \"missadministrator\"\n"], [45, "  administrator_login_password = \"AdminPassword123!\"\n"], [46, "  tags = {\n"], [47, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [48, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [49, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [50, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [51, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [52, "    git_org              = \"bridgecrewio\"\n"], [53, "    git_repo             = \"terragoat\"\n"], [54, "    yor_trace            = \"096d2cf2-6d47-41b2-9418-cdedea85e184\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [39, 56], "resource": "azurerm_mssql_server.mssql2", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "096d2cf2-6d47-41b2-9418-cdedea85e184"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_27", "bc_check_id": null, "check_name": "Ensure Azure AD authentication is enabled for Azure SQL (MSSQL)", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql3": {"__end_line__": 75, "__start_line__": 58, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql3-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e71d3fb5-addc-481d-ada6-b7432a768de3"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql3"}}}, "evaluated_keys": ["azuread_administrator", "azuread_administrator/login_username"]}, "code_block": [[58, "resource \"azurerm_mssql_server\" \"mssql3\" {\n"], [59, "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"\n"], [60, "  resource_group_name          = azurerm_resource_group.example.name\n"], [61, "  location                     = azurerm_resource_group.example.location\n"], [62, "  version                      = \"12.0\"\n"], [63, "  administrator_login          = \"missadministrator\"\n"], [64, "  administrator_login_password = \"AdminPassword123!\"\n"], [65, "  tags = {\n"], [66, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [67, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [68, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [69, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [70, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [71, "    git_org              = \"bridgecrewio\"\n"], [72, "    git_repo             = \"terragoat\"\n"], [73, "    yor_trace            = \"e71d3fb5-addc-481d-ada6-b7432a768de3\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [58, 75], "resource": "azurerm_mssql_server.mssql3", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e71d3fb5-addc-481d-ada6-b7432a768de3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_27", "bc_check_id": null, "check_name": "Ensure Azure AD authentication is enabled for Azure SQL (MSSQL)", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql4": {"__end_line__": 94, "__start_line__": 77, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql4-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c3b85724-4f7e-4c63-a17d-3d04239beae8"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql4"}}}, "evaluated_keys": ["azuread_administrator", "azuread_administrator/login_username"]}, "code_block": [[77, "resource \"azurerm_mssql_server\" \"mssql4\" {\n"], [78, "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"\n"], [79, "  resource_group_name          = azurerm_resource_group.example.name\n"], [80, "  location                     = azurerm_resource_group.example.location\n"], [81, "  version                      = \"12.0\"\n"], [82, "  administrator_login          = \"missadministrator\"\n"], [83, "  administrator_login_password = \"AdminPassword123!\"\n"], [84, "  tags = {\n"], [85, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [86, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [87, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [88, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [89, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [90, "    git_org              = \"bridgecrewio\"\n"], [91, "    git_repo             = \"terragoat\"\n"], [92, "    yor_trace            = \"c3b85724-4f7e-4c63-a17d-3d04239beae8\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [77, 94], "resource": "azurerm_mssql_server.mssql4", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c3b85724-4f7e-4c63-a17d-3d04239beae8"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_27", "bc_check_id": null, "check_name": "Ensure Azure AD authentication is enabled for Azure SQL (MSSQL)", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql5": {"__end_line__": 113, "__start_line__": 96, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql5-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0240ca84-acc9-47d9-b491-9e7e359787a1"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql5"}}}, "evaluated_keys": ["azuread_administrator", "azuread_administrator/login_username"]}, "code_block": [[96, "resource \"azurerm_mssql_server\" \"mssql5\" {\n"], [97, "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"\n"], [98, "  resource_group_name          = azurerm_resource_group.example.name\n"], [99, "  location                     = azurerm_resource_group.example.location\n"], [100, "  version                      = \"12.0\"\n"], [101, "  administrator_login          = \"missadministrator\"\n"], [102, "  administrator_login_password = \"AdminPassword123!\"\n"], [103, "  tags = {\n"], [104, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [105, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [106, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [107, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [108, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [109, "    git_org              = \"bridgecrewio\"\n"], [110, "    git_repo             = \"terragoat\"\n"], [111, "    yor_trace            = \"0240ca84-acc9-47d9-b491-9e7e359787a1\"\n"], [112, "  }\n"], [113, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [96, 113], "resource": "azurerm_mssql_server.mssql5", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0240ca84-acc9-47d9-b491-9e7e359787a1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_27", "bc_check_id": null, "check_name": "Ensure Azure AD authentication is enabled for Azure SQL (MSSQL)", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql6": {"__end_line__": 132, "__start_line__": 115, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql6-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "042d15fb-edfa-484b-b65e-3d70c50cdee7"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql6"}}}, "evaluated_keys": ["azuread_administrator", "azuread_administrator/login_username"]}, "code_block": [[115, "resource \"azurerm_mssql_server\" \"mssql6\" {\n"], [116, "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"\n"], [117, "  resource_group_name          = azurerm_resource_group.example.name\n"], [118, "  location                     = azurerm_resource_group.example.location\n"], [119, "  version                      = \"12.0\"\n"], [120, "  administrator_login          = \"missadministrator\"\n"], [121, "  administrator_login_password = \"AdminPassword123!\"\n"], [122, "  tags = {\n"], [123, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [124, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [125, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [126, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [127, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [128, "    git_org              = \"bridgecrewio\"\n"], [129, "    git_repo             = \"terragoat\"\n"], [130, "    yor_trace            = \"042d15fb-edfa-484b-b65e-3d70c50cdee7\"\n"], [131, "  }\n"], [132, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [115, 132], "resource": "azurerm_mssql_server.mssql6", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "042d15fb-edfa-484b-b65e-3d70c50cdee7"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_27", "bc_check_id": null, "check_name": "Ensure Azure AD authentication is enabled for Azure SQL (MSSQL)", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql7": {"__end_line__": 151, "__start_line__": 134, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql7-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f1118e1-5067-452e-906f-5123cfc93711"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql7"}}}, "evaluated_keys": ["azuread_administrator", "azuread_administrator/login_username"]}, "code_block": [[134, "resource \"azurerm_mssql_server\" \"mssql7\" {\n"], [135, "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"\n"], [136, "  resource_group_name          = azurerm_resource_group.example.name\n"], [137, "  location                     = azurerm_resource_group.example.location\n"], [138, "  version                      = \"12.0\"\n"], [139, "  administrator_login          = \"missadministrator\"\n"], [140, "  administrator_login_password = \"AdminPassword123!\"\n"], [141, "  tags = {\n"], [142, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [143, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [144, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [145, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [146, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [147, "    git_org              = \"bridgecrewio\"\n"], [148, "    git_repo             = \"terragoat\"\n"], [149, "    yor_trace            = \"3f1118e1-5067-452e-906f-5123cfc93711\"\n"], [150, "  }\n"], [151, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [134, 151], "resource": "azurerm_mssql_server.mssql7", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f1118e1-5067-452e-906f-5123cfc93711"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_16", "bc_check_id": "BC_AZR_GENERAL_36", "check_name": "Ensure that MySQL server enables customer-managed key for encryption", "check_result": {"result": "FAILED", "entity": {"azurerm_mysql_server": {"example": {"__end_line__": 71, "__start_line__": 44, "administrator_login": ["terragoat-dev"], "administrator_login_password": ["random_string.password.result"], "auto_grow_enabled": [true], "backup_retention_days": [7], "infrastructure_encryption_enabled": [true], "location": ["East US"], "name": ["terragoat-mysql-dev${random_integer.rnd_int.result}"], "public_network_access_enabled": [true], "resource_group_name": ["terragoat-dev"], "sku_name": ["B_Gen5_2"], "ssl_enforcement_enabled": [false], "storage_mb": [5120], "tags": [{"git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "1ac18c16-09a4-41c9-9a66-6f514050178e"}], "version": ["5.7"], "__address__": "azurerm_mysql_server.example"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[44, "resource \"azurerm_mysql_server\" \"example\" {\n"], [45, "  name                = \"terragoat-mysql-${var.environment}${random_integer.rnd_int.result}\"\n"], [46, "  location            = azurerm_resource_group.example.location\n"], [47, "  resource_group_name = azurerm_resource_group.example.name\n"], [48, "\n"], [49, "  administrator_login          = \"terragoat-${var.environment}\"\n"], [50, "  administrator_login_password = random_string.password.result\n"], [51, "\n"], [52, "  sku_name   = \"B_Gen5_2\"\n"], [53, "  storage_mb = 5120\n"], [54, "  version    = \"5.7\"\n"], [55, "\n"], [56, "  auto_grow_enabled                 = true\n"], [57, "  backup_retention_days             = 7\n"], [58, "  infrastructure_encryption_enabled = true\n"], [59, "  public_network_access_enabled     = true\n"], [60, "  ssl_enforcement_enabled           = false\n"], [61, "  tags = {\n"], [62, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [63, "    git_file             = \"terraform/azure/sql.tf\"\n"], [64, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [65, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [66, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [67, "    git_org              = \"bridgecrewio\"\n"], [68, "    git_repo             = \"terragoat\"\n"], [69, "    yor_trace            = \"1ac18c16-09a4-41c9-9a66-6f514050178e\"\n"], [70, "  }\n"], [71, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [44, 71], "resource": "azurerm_mysql_server.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "1ac18c16-09a4-41c9-9a66-6f514050178e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-mysql-server-enables-customer-managed-key-for-encryption.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "administrator_login": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_7", "bc_check_id": "BC_AZR_GENERAL_74", "check_name": "Ensure that Azure Active Directory Admin is configured", "check_result": {"result": "FAILED", "entity": {"azurerm_sql_server": {"example": {"__end_line__": 29, "__start_line__": 9, "administrator_login": ["ariel"], "administrator_login_password": ["Aa12345678"], "location": ["East US"], "name": ["terragoat-sqlserver-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}], "version": ["12.0"], "__address__": "azurerm_sql_server.example"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[9, "resource \"azurerm_sql_server\" \"example\" {\n"], [10, "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n"], [11, "  resource_group_name          = azurerm_resource_group.example.name\n"], [12, "  location                     = azurerm_resource_group.example.location\n"], [13, "  version                      = \"12.0\"\n"], [14, "  administrator_login          = \"ariel\"\n"], [15, "  administrator_login_password = \"Aa12345678\"\n"], [16, "  tags = merge({\n"], [17, "    environment = var.environment\n"], [18, "    terragoat   = \"true\"\n"], [19, "    }, {\n"], [20, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [21, "    git_file             = \"terraform/azure/sql.tf\"\n"], [22, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [23, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [24, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [25, "    git_org              = \"bridgecrewio\"\n"], [26, "    git_repo             = \"terragoat\"\n"], [27, "    yor_trace            = \"e5ec3432-e61f-4244-b59e-9ecc24ddd4cb\"\n"], [28, "  })\n"], [29, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [9, 29], "resource": "azurerm_sql_server.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-that-azure-active-directory-admin-is-configured.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_32", "bc_check_id": null, "check_name": "Ensure private endpoint is configured to key vault", "check_result": {"result": "FAILED", "entity": {"azurerm_key_vault": {"example": {"__end_line__": 31, "__start_line__": 1, "access_policy": [{"key_permissions": [["create", "get"]], "object_id": ["data.azurerm_client_config.current.object_id"], "secret_permissions": [["set"]], "tenant_id": ["data.azurerm_client_config.current.tenant_id"]}], "location": ["East US"], "name": ["terragoat-key-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "sku_name": ["premium"], "tags": [{"environment": "dev", "terragoat": true, "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/key_vault.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "79afeacc-248a-4015-a4fa-76a6a57f06e2"}], "tenant_id": ["data.azurerm_client_config.current.tenant_id"], "__address__": "azurerm_key_vault.example"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[1, "resource \"azurerm_key_vault\" \"example\" {\n"], [2, "  name                = \"terragoat-key-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  location            = azurerm_resource_group.example.location\n"], [4, "  resource_group_name = azurerm_resource_group.example.name\n"], [5, "  tenant_id           = data.azurerm_client_config.current.tenant_id\n"], [6, "  sku_name            = \"premium\"\n"], [7, "  access_policy {\n"], [8, "    tenant_id = data.azurerm_client_config.current.tenant_id\n"], [9, "    object_id = data.azurerm_client_config.current.object_id\n"], [10, "    key_permissions = [\n"], [11, "      \"create\",\n"], [12, "      \"get\",\n"], [13, "    ]\n"], [14, "    secret_permissions = [\n"], [15, "      \"set\",\n"], [16, "    ]\n"], [17, "  }\n"], [18, "  tags = merge({\n"], [19, "    environment = var.environment\n"], [20, "    terragoat   = true\n"], [21, "    }, {\n"], [22, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [23, "    git_file             = \"terraform/azure/key_vault.tf\"\n"], [24, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [25, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [26, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [27, "    git_org              = \"bridgecrewio\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"79afeacc-248a-4015-a4fa-76a6a57f06e2\"\n"], [30, "  })\n"], [31, "}\n"]], "file_path": "/terraform/azure/key_vault.tf", "file_abs_path": "/terraform/terraform/azure/key_vault.tf", "repo_file_path": "/terraform/azure/key_vault.tf", "file_line_range": [1, 31], "resource": "azurerm_key_vault.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"environment": "dev", "terragoat": true, "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/key_vault.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "79afeacc-248a-4015-a4fa-76a6a57f06e2"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/key_vault.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql1": {"__end_line__": 37, "__start_line__": 20, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["terragoat-mssql1-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "54f6cb23-b30a-4f1d-8064-6f777b9b75db"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql1"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[20, "resource \"azurerm_mssql_server\" \"mssql1\" {\n"], [21, "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"\n"], [22, "  resource_group_name          = azurerm_resource_group.example.name\n"], [23, "  location                     = azurerm_resource_group.example.location\n"], [24, "  version                      = \"12.0\"\n"], [25, "  administrator_login          = \"missadministrator\"\n"], [26, "  administrator_login_password = \"AdminPassword123!\"\n"], [27, "  tags = {\n"], [28, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [29, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [30, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [31, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [32, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"54f6cb23-b30a-4f1d-8064-6f777b9b75db\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [20, 37], "resource": "azurerm_mssql_server.mssql1", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "54f6cb23-b30a-4f1d-8064-6f777b9b75db"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql2": {"__end_line__": 56, "__start_line__": 39, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql2-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "096d2cf2-6d47-41b2-9418-cdedea85e184"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql2"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[39, "resource \"azurerm_mssql_server\" \"mssql2\" {\n"], [40, "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"\n"], [41, "  resource_group_name          = azurerm_resource_group.example.name\n"], [42, "  location                     = azurerm_resource_group.example.location\n"], [43, "  version                      = \"12.0\"\n"], [44, "  administrator_login          = \"missadministrator\"\n"], [45, "  administrator_login_password = \"AdminPassword123!\"\n"], [46, "  tags = {\n"], [47, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [48, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [49, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [50, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [51, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [52, "    git_org              = \"bridgecrewio\"\n"], [53, "    git_repo             = \"terragoat\"\n"], [54, "    yor_trace            = \"096d2cf2-6d47-41b2-9418-cdedea85e184\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [39, 56], "resource": "azurerm_mssql_server.mssql2", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "096d2cf2-6d47-41b2-9418-cdedea85e184"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql3": {"__end_line__": 75, "__start_line__": 58, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql3-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e71d3fb5-addc-481d-ada6-b7432a768de3"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql3"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[58, "resource \"azurerm_mssql_server\" \"mssql3\" {\n"], [59, "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"\n"], [60, "  resource_group_name          = azurerm_resource_group.example.name\n"], [61, "  location                     = azurerm_resource_group.example.location\n"], [62, "  version                      = \"12.0\"\n"], [63, "  administrator_login          = \"missadministrator\"\n"], [64, "  administrator_login_password = \"AdminPassword123!\"\n"], [65, "  tags = {\n"], [66, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [67, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [68, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [69, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [70, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [71, "    git_org              = \"bridgecrewio\"\n"], [72, "    git_repo             = \"terragoat\"\n"], [73, "    yor_trace            = \"e71d3fb5-addc-481d-ada6-b7432a768de3\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [58, 75], "resource": "azurerm_mssql_server.mssql3", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e71d3fb5-addc-481d-ada6-b7432a768de3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql4": {"__end_line__": 94, "__start_line__": 77, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql4-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c3b85724-4f7e-4c63-a17d-3d04239beae8"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql4"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[77, "resource \"azurerm_mssql_server\" \"mssql4\" {\n"], [78, "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"\n"], [79, "  resource_group_name          = azurerm_resource_group.example.name\n"], [80, "  location                     = azurerm_resource_group.example.location\n"], [81, "  version                      = \"12.0\"\n"], [82, "  administrator_login          = \"missadministrator\"\n"], [83, "  administrator_login_password = \"AdminPassword123!\"\n"], [84, "  tags = {\n"], [85, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [86, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [87, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [88, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [89, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [90, "    git_org              = \"bridgecrewio\"\n"], [91, "    git_repo             = \"terragoat\"\n"], [92, "    yor_trace            = \"c3b85724-4f7e-4c63-a17d-3d04239beae8\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [77, 94], "resource": "azurerm_mssql_server.mssql4", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c3b85724-4f7e-4c63-a17d-3d04239beae8"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql5": {"__end_line__": 113, "__start_line__": 96, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql5-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0240ca84-acc9-47d9-b491-9e7e359787a1"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql5"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[96, "resource \"azurerm_mssql_server\" \"mssql5\" {\n"], [97, "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"\n"], [98, "  resource_group_name          = azurerm_resource_group.example.name\n"], [99, "  location                     = azurerm_resource_group.example.location\n"], [100, "  version                      = \"12.0\"\n"], [101, "  administrator_login          = \"missadministrator\"\n"], [102, "  administrator_login_password = \"AdminPassword123!\"\n"], [103, "  tags = {\n"], [104, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [105, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [106, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [107, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [108, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [109, "    git_org              = \"bridgecrewio\"\n"], [110, "    git_repo             = \"terragoat\"\n"], [111, "    yor_trace            = \"0240ca84-acc9-47d9-b491-9e7e359787a1\"\n"], [112, "  }\n"], [113, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [96, 113], "resource": "azurerm_mssql_server.mssql5", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0240ca84-acc9-47d9-b491-9e7e359787a1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql6": {"__end_line__": 132, "__start_line__": 115, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql6-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "042d15fb-edfa-484b-b65e-3d70c50cdee7"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql6"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[115, "resource \"azurerm_mssql_server\" \"mssql6\" {\n"], [116, "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"\n"], [117, "  resource_group_name          = azurerm_resource_group.example.name\n"], [118, "  location                     = azurerm_resource_group.example.location\n"], [119, "  version                      = \"12.0\"\n"], [120, "  administrator_login          = \"missadministrator\"\n"], [121, "  administrator_login_password = \"AdminPassword123!\"\n"], [122, "  tags = {\n"], [123, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [124, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [125, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [126, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [127, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [128, "    git_org              = \"bridgecrewio\"\n"], [129, "    git_repo             = \"terragoat\"\n"], [130, "    yor_trace            = \"042d15fb-edfa-484b-b65e-3d70c50cdee7\"\n"], [131, "  }\n"], [132, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [115, 132], "resource": "azurerm_mssql_server.mssql6", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "042d15fb-edfa-484b-b65e-3d70c50cdee7"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql7": {"__end_line__": 151, "__start_line__": 134, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql7-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f1118e1-5067-452e-906f-5123cfc93711"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql7"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[134, "resource \"azurerm_mssql_server\" \"mssql7\" {\n"], [135, "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"\n"], [136, "  resource_group_name          = azurerm_resource_group.example.name\n"], [137, "  location                     = azurerm_resource_group.example.location\n"], [138, "  version                      = \"12.0\"\n"], [139, "  administrator_login          = \"missadministrator\"\n"], [140, "  administrator_login_password = \"AdminPassword123!\"\n"], [141, "  tags = {\n"], [142, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [143, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [144, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [145, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [146, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [147, "    git_org              = \"bridgecrewio\"\n"], [148, "    git_repo             = \"terragoat\"\n"], [149, "    yor_trace            = \"3f1118e1-5067-452e-906f-5123cfc93711\"\n"], [150, "  }\n"], [151, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [134, 151], "resource": "azurerm_mssql_server.mssql7", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f1118e1-5067-452e-906f-5123cfc93711"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_23", "bc_check_id": "BC_AZR_LOGGING_2", "check_name": "Ensure that 'Auditing' is set to 'On' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_sql_server": {"example": {"__end_line__": 29, "__start_line__": 9, "administrator_login": ["ariel"], "administrator_login_password": ["Aa12345678"], "location": ["East US"], "name": ["terragoat-sqlserver-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}], "version": ["12.0"], "__address__": "azurerm_sql_server.example"}}}, "evaluated_keys": ["server_id", "extended_auditing_policy", "resource_type"]}, "code_block": [[9, "resource \"azurerm_sql_server\" \"example\" {\n"], [10, "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n"], [11, "  resource_group_name          = azurerm_resource_group.example.name\n"], [12, "  location                     = azurerm_resource_group.example.location\n"], [13, "  version                      = \"12.0\"\n"], [14, "  administrator_login          = \"ariel\"\n"], [15, "  administrator_login_password = \"Aa12345678\"\n"], [16, "  tags = merge({\n"], [17, "    environment = var.environment\n"], [18, "    terragoat   = \"true\"\n"], [19, "    }, {\n"], [20, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [21, "    git_file             = \"terraform/azure/sql.tf\"\n"], [22, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [23, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [24, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [25, "    git_org              = \"bridgecrewio\"\n"], [26, "    git_repo             = \"terragoat\"\n"], [27, "    yor_trace            = \"e5ec3432-e61f-4244-b59e-9ecc24ddd4cb\"\n"], [28, "  })\n"], [29, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [9, 29], "resource": "azurerm_sql_server.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-2.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_29", "bc_check_id": null, "check_name": "Ensure AKS cluster has Azure CNI networking enabled", "check_result": {"result": "FAILED", "entity": {"azurerm_kubernetes_cluster": {"k8s_cluster": {"__end_line__": 35, "__start_line__": 1, "addon_profile": [{"kube_dashboard": [{"enabled": [true]}], "oms_agent": [{"enabled": [false]}]}], "default_node_pool": [{"name": ["default"], "node_count": [2], "vm_size": ["Standard_D2_v2"]}], "dns_prefix": ["terragoat-dev"], "identity": [{"type": ["SystemAssigned"]}], "location": ["East US"], "name": ["terragoat-aks-dev"], "resource_group_name": ["terragoat-dev"], "role_based_access_control": [{"enabled": [false]}], "tags": [{"git_commit": "898d5beaec7ffdef6df0d7abecff407362e2a74e", "git_file": "terraform/azure/aks.tf", "git_last_modified_at": "2020-06-17 12:59:55", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "6103d111-864e-42e5-899c-1864de281fd1"}], "__address__": "azurerm_kubernetes_cluster.k8s_cluster"}}}, "evaluated_keys": ["network_profile/network_plugin"]}, "code_block": [[1, "resource azurerm_kubernetes_cluster \"k8s_cluster\" {\n"], [2, "  dns_prefix          = \"terragoat-${var.environment}\"\n"], [3, "  location            = var.location\n"], [4, "  name                = \"terragoat-aks-${var.environment}\"\n"], [5, "  resource_group_name = azurerm_resource_group.example.name\n"], [6, "  identity {\n"], [7, "    type = \"SystemAssigned\"\n"], [8, "  }\n"], [9, "  default_node_pool {\n"], [10, "    name       = \"default\"\n"], [11, "    vm_size    = \"Standard_D2_v2\"\n"], [12, "    node_count = 2\n"], [13, "  }\n"], [14, "  addon_profile {\n"], [15, "    oms_agent {\n"], [16, "      enabled = false\n"], [17, "    }\n"], [18, "    kube_dashboard {\n"], [19, "      enabled = true\n"], [20, "    }\n"], [21, "  }\n"], [22, "  role_based_access_control {\n"], [23, "    enabled = false\n"], [24, "  }\n"], [25, "  tags = {\n"], [26, "    git_commit           = \"898d5beaec7ffdef6df0d7abecff407362e2a74e\"\n"], [27, "    git_file             = \"terraform/azure/aks.tf\"\n"], [28, "    git_last_modified_at = \"2020-06-17 12:59:55\"\n"], [29, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [30, "    git_modifiers        = \"nimrodkor\"\n"], [31, "    git_org              = \"bridgecrewio\"\n"], [32, "    git_repo             = \"terragoat\"\n"], [33, "    yor_trace            = \"6103d111-864e-42e5-899c-1864de281fd1\"\n"], [34, "  }\n"], [35, "}"]], "file_path": "/terraform/azure/aks.tf", "file_abs_path": "/terraform/terraform/azure/aks.tf", "repo_file_path": "/terraform/azure/aks.tf", "file_line_range": [1, 35], "resource": "azurerm_kubernetes_cluster.k8s_cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "898d5beaec7ffdef6df0d7abecff407362e2a74e", "git_file": "terraform/azure/aks.tf", "git_last_modified_at": "2020-06-17 12:59:55", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "6103d111-864e-42e5-899c-1864de281fd1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/aks.tf", "breadcrumbs": {"location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "dns_prefix": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": null, "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": null, "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": null, "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": null, "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": null, "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_62", "bc_check_id": null, "check_name": "Ensure S3 buckets should have event notifications enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_64", "bc_check_id": null, "check_name": "Ensure KMS key Policy is defined", "check_result": {"result": "FAILED", "entity": {"aws_kms_key": {"logs_key": {"__end_line__": 16, "__start_line__": 1, "deletion_window_in_days": [7], "description": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs bucket key"], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/kms.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "cd8fa2a7-4868-4cd1-993d-da4644808ce5"}], "__address__": "aws_kms_key.logs_key"}}}, "evaluated_keys": ["policy", "resource_type"]}, "code_block": [[1, "resource \"aws_kms_key\" \"logs_key\" {\n"], [2, "  # key does not have rotation enabled\n"], [3, "  description = \"${local.resource_prefix.value}-logs bucket key\"\n"], [4, "\n"], [5, "  deletion_window_in_days = 7\n"], [6, "  tags = {\n"], [7, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [8, "    git_file             = \"terraform/aws/kms.tf\"\n"], [9, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [10, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [11, "    git_modifiers        = \"nimrodkor\"\n"], [12, "    git_org              = \"bridgecrewio\"\n"], [13, "    git_repo             = \"terragoat\"\n"], [14, "    yor_trace            = \"cd8fa2a7-4868-4cd1-993d-da4644808ce5\"\n"], [15, "  }\n"], [16, "}\n"]], "file_path": "/terraform/aws/kms.tf", "file_abs_path": "/terraform/terraform/aws/kms.tf", "repo_file_path": "/terraform/aws/kms.tf", "file_line_range": [1, 16], "resource": "aws_kms_key.logs_key", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/kms.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "cd8fa2a7-4868-4cd1-993d-da4644808ce5"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/kms.tf", "breadcrumbs": {"description": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_2", "bc_check_id": "BC_AWS_GENERAL_60", "check_name": "Ensure that only encrypted EBS volumes are attached to EC2 instances", "check_result": {"result": "FAILED", "entity": {"aws_ebs_volume": {"web_host_storage": {"__end_line__": 51, "__start_line__": 34, "availability_zone": ["us-west-2a"], "size": [1], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-ebs", "git_commit": "d3439f0f2af62f6fa3521e14d6c27819ef8f12e1", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2021-05-02 11:17:26", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c5509daf-10f0-46af-9e03-41989212521d"}], "__address__": "aws_ebs_volume.web_host_storage"}}}, "evaluated_keys": ["encrypted", "resource_type"]}, "code_block": [[34, "resource \"aws_ebs_volume\" \"web_host_storage\" {\n"], [35, "  # unencrypted volume\n"], [36, "  availability_zone = \"${var.region}a\"\n"], [37, "  #encrypted         = false  # Setting this causes the volume to be recreated on apply \n"], [38, "  size = 1\n"], [39, "  tags = merge({\n"], [40, "    Name = \"${local.resource_prefix.value}-ebs\"\n"], [41, "    }, {\n"], [42, "    git_commit           = \"d3439f0f2af62f6fa3521e14d6c27819ef8f12e1\"\n"], [43, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [44, "    git_last_modified_at = \"2021-05-02 11:17:26\"\n"], [45, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [46, "    git_modifiers        = \"nimrodkor\"\n"], [47, "    git_org              = \"bridgecrewio\"\n"], [48, "    git_repo             = \"terragoat\"\n"], [49, "    yor_trace            = \"c5509daf-10f0-46af-9e03-41989212521d\"\n"], [50, "  })\n"], [51, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [34, 51], "resource": "aws_ebs_volume.web_host_storage", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ebs", "git_commit": "d3439f0f2af62f6fa3521e14d6c27819ef8f12e1", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2021-05-02 11:17:26", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c5509daf-10f0-46af-9e03-41989212521d"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-only-encrypted-ebs-volumes-are-attached-to-ec2-instances.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"availability_zone": [{"type": "variable", "name": "region", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_60", "bc_check_id": null, "check_name": "Ensure RDS instance with copy tags to snapshots is enabled", "check_result": {"result": "FAILED", "entity": {"aws_db_instance": {"default": {"__end_line__": 42, "__start_line__": 1, "allocated_storage": ["20"], "apply_immediately": [true], "backup_retention_period": [0], "db_subnet_group_name": ["sg-${data.aws_caller_identity.current.account_id}-acme-dev"], "engine": ["mysql"], "engine_version": ["8.0"], "identifier": ["rds-${data.aws_caller_identity.current.account_id}-acme-dev"], "instance_class": ["db.t3.micro"], "lifecycle": [{"ignore_changes": [["password"]]}], "monitoring_interval": [0], "multi_az": [false], "name": ["db1"], "option_group_name": ["og-${data.aws_caller_identity.current.account_id}-acme-dev"], "parameter_group_name": ["pg-${data.aws_caller_identity.current.account_id}-acme-dev"], "password": ["Aa1234321Bb"], "publicly_accessible": [true], "skip_final_snapshot": [true], "storage_encrypted": [false], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}], "username": ["admin"], "vpc_security_group_ids": [["aws_security_group.default.id"]], "__address__": "aws_db_instance.default"}}}, "evaluated_keys": ["engine", "copy_tags_to_snapshot"]}, "code_block": [[1, "resource \"aws_db_instance\" \"default\" {\n"], [2, "\n"], [3, "  name                   = var.dbname\n"], [4, "  engine                 = \"mysql\"\n"], [5, "  option_group_name      = aws_db_option_group.default.name\n"], [6, "  parameter_group_name   = aws_db_parameter_group.default.name\n"], [7, "  db_subnet_group_name   = aws_db_subnet_group.default.name\n"], [8, "  vpc_security_group_ids = [\"${aws_security_group.default.id}\"]\n"], [9, "\n"], [10, "  identifier              = \"rds-${local.resource_prefix.value}\"\n"], [11, "  engine_version          = \"8.0\" # Latest major version \n"], [12, "  instance_class          = \"db.t3.micro\"\n"], [13, "  allocated_storage       = \"20\"\n"], [14, "  username                = \"admin\"\n"], [15, "  password                = var.password\n"], [16, "  apply_immediately       = true\n"], [17, "  multi_az                = false\n"], [18, "  backup_retention_period = 0\n"], [19, "  storage_encrypted       = false\n"], [20, "  skip_final_snapshot     = true\n"], [21, "  monitoring_interval     = 0\n"], [22, "  publicly_accessible     = true\n"], [23, "\n"], [24, "  tags = merge({\n"], [25, "    Name        = \"${local.resource_prefix.value}-rds\"\n"], [26, "    Environment = local.resource_prefix.value\n"], [27, "    }, {\n"], [28, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [29, "    git_file             = \"terraform/aws/db-app.tf\"\n"], [30, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [31, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [32, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"47c13290-c2ce-48a7-b666-1b0085effb92\"\n"], [36, "  })\n"], [37, "\n"], [38, "  # Ignore password changes from tf plan diff\n"], [39, "  lifecycle {\n"], [40, "    ignore_changes = [\"password\"]\n"], [41, "  }\n"], [42, "}\n"]], "file_path": "/terraform/aws/db-app.tf", "file_abs_path": "/terraform/terraform/aws/db-app.tf", "repo_file_path": "/terraform/aws/db-app.tf", "file_line_range": [1, 42], "resource": "aws_db_instance.default", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-rds", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/db-app.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "47c13290-c2ce-48a7-b666-1b0085effb92"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/db-app.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "password": [{"type": "variable", "name": "password", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "identifier": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "parameter_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_parameter_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "option_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_option_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}], "db_subnet_group_name": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_db_subnet_group.default", "path": "/terraform/terraform/aws/db-app.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"eks_vpc": {"__end_line__": 60, "__start_line__": 44, "cidr_block": ["10.10.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "1600ca6c-72f6-45c0-a71d-88e117e51d6b"}], "__address__": "aws_vpc.eks_vpc"}}}, "evaluated_keys": ["networking", "resource_type"]}, "code_block": [[44, "resource aws_vpc \"eks_vpc\" {\n"], [45, "  cidr_block           = \"10.10.0.0/16\"\n"], [46, "  enable_dns_hostnames = true\n"], [47, "  enable_dns_support   = true\n"], [48, "  tags = merge({\n"], [49, "    Name = \"${local.resource_prefix.value}-eks-vpc\"\n"], [50, "    }, {\n"], [51, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [52, "    git_file             = \"terraform/aws/eks.tf\"\n"], [53, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [54, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [55, "    git_modifiers        = \"nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"1600ca6c-72f6-45c0-a71d-88e117e51d6b\"\n"], [59, "  })\n"], [60, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [44, 60], "resource": "aws_vpc.eks_vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "1600ca6c-72f6-45c0-a71d-88e117e51d6b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/eks.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_58", "bc_check_id": null, "check_name": "Ensure AWS Neptune cluster deletion protection is enabled", "check_result": {"result": "FAILED", "entity": {"aws_neptune_cluster": {"default": {"__end_line__": 20, "__start_line__": 1, "apply_immediately": [true], "backup_retention_period": [5], "cluster_identifier": ["neptunedb1"], "engine": ["neptune"], "iam_database_authentication_enabled": [false], "preferred_backup_window": ["07:00-09:00"], "skip_final_snapshot": [true], "storage_encrypted": [false], "tags": [{"git_commit": "aa8fd16fd94cccf6af206e2f0922b5558f8ac514", "git_file": "terraform/aws/neptune.tf", "git_last_modified_at": "2020-08-21 19:14:35", "git_last_modified_by": "matt@bridgecrew.io", "git_modifiers": "matt", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0d4cbb85-73ed-4ca0-b1da-296e4185f34e"}], "__address__": "aws_neptune_cluster.default"}}}, "evaluated_keys": ["deletion_protection"]}, "code_block": [[1, "resource \"aws_neptune_cluster\" \"default\" {\n"], [2, "  cluster_identifier                  = var.neptune-dbname\n"], [3, "  engine                              = \"neptune\"\n"], [4, "  backup_retention_period             = 5\n"], [5, "  preferred_backup_window             = \"07:00-09:00\"\n"], [6, "  skip_final_snapshot                 = true\n"], [7, "  iam_database_authentication_enabled = false\n"], [8, "  apply_immediately                   = true\n"], [9, "  storage_encrypted                   = false\n"], [10, "  tags = {\n"], [11, "    git_commit           = \"aa8fd16fd94cccf6af206e2f0922b5558f8ac514\"\n"], [12, "    git_file             = \"terraform/aws/neptune.tf\"\n"], [13, "    git_last_modified_at = \"2020-08-21 19:14:35\"\n"], [14, "    git_last_modified_by = \"matt@bridgecrew.io\"\n"], [15, "    git_modifiers        = \"matt\"\n"], [16, "    git_org              = \"bridgecrewio\"\n"], [17, "    git_repo             = \"terragoat\"\n"], [18, "    yor_trace            = \"0d4cbb85-73ed-4ca0-b1da-296e4185f34e\"\n"], [19, "  }\n"], [20, "}\n"]], "file_path": "/terraform/aws/neptune.tf", "file_abs_path": "/terraform/terraform/aws/neptune.tf", "repo_file_path": "/terraform/aws/neptune.tf", "file_line_range": [1, 20], "resource": "aws_neptune_cluster.default", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "aa8fd16fd94cccf6af206e2f0922b5558f8ac514", "git_file": "terraform/aws/neptune.tf", "git_last_modified_at": "2020-08-21 19:14:35", "git_last_modified_by": "matt@bridgecrew.io", "git_modifiers": "matt", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0d4cbb85-73ed-4ca0-b1da-296e4185f34e"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/neptune.tf", "breadcrumbs": {"cluster_identifier": [{"type": "variable", "name": "neptune-dbname", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": null, "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": null, "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": null, "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": null, "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": null, "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_61", "bc_check_id": null, "check_name": "Ensure that an S3 bucket has a lifecycle configuration", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["lifecycle_rule", "resource_type"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_120", "bc_check_id": "BC_AZR_NETWORKING_37", "check_name": "Ensure that Application Gateway enables WAF", "check_result": {"result": "FAILED", "entity": {"azurerm_application_gateway": {"network": {"__end_line__": 66, "__start_line__": 1, "backend_address_pool": [{"name": ["local.backend_address_pool_name"]}], "backend_http_settings": [{"cookie_based_affinity": ["Disabled"], "name": ["local.http_setting_name"], "path": ["/path1/"], "port": [80], "protocol": ["Http"], "request_timeout": [60]}], "frontend_ip_configuration": [{"name": ["name"], "public_ip_address_id": ["Ip-address"]}], "frontend_port": [{"name": ["name"], "port": ["port-no"]}], "gateway_ip_configuration": [{"name": ["my-gateway-ip-configuration"], "subnet_id": ["your subnet id"]}], "http_listener": [{"frontend_ip_configuration_name": ["local.frontend_ip_configuration_name"], "frontend_port_name": ["local.frontend_port_name"], "name": ["local.listener_name"], "protocol": ["Http"]}], "location": ["example --West-US"], "name": ["example-appgateway"], "request_routing_rule": [{"backend_address_pool_name": ["local.backend_address_pool_name"], "backend_http_settings_name": ["local.http_setting_name"], "http_listener_name": ["local.listener_name"], "name": ["local.request_routing_rule_name"], "rule_type": ["Basic"]}], "resource_group_name": ["example-resourceGroup"], "sku": [{"capacity": [2], "name": ["Standard_Small"], "tier": ["Standard"]}], "tags": [{"git_commit": "b07a42ebd74b8f0ba647e20b872474b1c29b4814", "git_file": "terraform/azure/application_gateway.tf", "git_last_modified_at": "2021-05-02 10:08:55", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "harkiratbhardwaj/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f62753b-3d20-4fa7-b402-b780234a14d8"}], "__address__": "azurerm_application_gateway.network"}}}, "evaluated_keys": ["waf_configuration/enabled", "policy_settings/enabled", "resource_type"]}, "code_block": [[1, "resource \"azurerm_application_gateway\" \"network\" {\n"], [2, "  name                = \"example-appgateway\"\n"], [3, "  resource_group_name = \"example-resourceGroup\"\n"], [4, "  location            = \"example --West-US\"\n"], [5, "\n"], [6, "  sku {\n"], [7, "    name     = \"Standard_Small\"\n"], [8, "    tier     = \"Standard\"\n"], [9, "    capacity = 2\n"], [10, "  }\n"], [11, "\n"], [12, "  gateway_ip_configuration {\n"], [13, "    name      = \"my-gateway-ip-configuration\"\n"], [14, "    subnet_id = \"your subnet id\"\n"], [15, "  }\n"], [16, "\n"], [17, "  frontend_port {\n"], [18, "    name = \"name\"\n"], [19, "    port = \"port-no\"\n"], [20, "  }\n"], [21, "  ####Missing WAF block: As per azure best practices, it is important to have a web application firewall enabled at application gateway.\n"], [22, "\n"], [23, "\n"], [24, "  frontend_ip_configuration {\n"], [25, "    name                 = \"name\"\n"], [26, "    public_ip_address_id = \"Ip-address\"\n"], [27, "  }\n"], [28, "\n"], [29, "  backend_address_pool {\n"], [30, "    name = local.backend_address_pool_name\n"], [31, "  }\n"], [32, "\n"], [33, "  backend_http_settings {\n"], [34, "    name                  = local.http_setting_name\n"], [35, "    cookie_based_affinity = \"Disabled\"\n"], [36, "    path                  = \"/path1/\"\n"], [37, "    port                  = 80\n"], [38, "    protocol              = \"Http\"\n"], [39, "    request_timeout       = 60\n"], [40, "  }\n"], [41, "\n"], [42, "  http_listener {\n"], [43, "    name                           = local.listener_name\n"], [44, "    frontend_ip_configuration_name = local.frontend_ip_configuration_name\n"], [45, "    frontend_port_name             = local.frontend_port_name\n"], [46, "    protocol                       = \"Http\"\n"], [47, "  }\n"], [48, "\n"], [49, "  request_routing_rule {\n"], [50, "    name                       = local.request_routing_rule_name\n"], [51, "    rule_type                  = \"Basic\"\n"], [52, "    http_listener_name         = local.listener_name\n"], [53, "    backend_address_pool_name  = local.backend_address_pool_name\n"], [54, "    backend_http_settings_name = local.http_setting_name\n"], [55, "  }\n"], [56, "  tags = {\n"], [57, "    git_commit           = \"b07a42ebd74b8f0ba647e20b872474b1c29b4814\"\n"], [58, "    git_file             = \"terraform/azure/application_gateway.tf\"\n"], [59, "    git_last_modified_at = \"2021-05-02 10:08:55\"\n"], [60, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [61, "    git_modifiers        = \"harkiratbhardwaj/nimrodkor\"\n"], [62, "    git_org              = \"bridgecrewio\"\n"], [63, "    git_repo             = \"terragoat\"\n"], [64, "    yor_trace            = \"3f62753b-3d20-4fa7-b402-b780234a14d8\"\n"], [65, "  }\n"], [66, "}\n"]], "file_path": "/terraform/azure/application_gateway.tf", "file_abs_path": "/terraform/terraform/azure/application_gateway.tf", "repo_file_path": "/terraform/azure/application_gateway.tf", "file_line_range": [1, 66], "resource": "azurerm_application_gateway.network", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "b07a42ebd74b8f0ba647e20b872474b1c29b4814", "git_file": "terraform/azure/application_gateway.tf", "git_last_modified_at": "2021-05-02 10:08:55", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "harkiratbhardwaj/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f62753b-3d20-4fa7-b402-b780234a14d8"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-networking-policies/ensure-that-application-gateway-enables-waf.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/application_gateway.tf"}, {"check_id": "CKV2_AWS_52", "bc_check_id": null, "check_name": "Ensure AWS ElasticSearch/OpenSearch Fine-grained access control is enabled", "check_result": {"result": "FAILED", "entity": {"aws_elasticsearch_domain": {"monitoring-framework": {"__end_line__": 28, "__start_line__": 1, "cluster_config": [{"dedicated_master_count": [1], "dedicated_master_enabled": [false], "dedicated_master_type": ["m4.large.elasticsearch"], "instance_count": [1], "instance_type": ["t2.small.elasticsearch"]}], "domain_name": ["tg-dev-es"], "ebs_options": [{"ebs_enabled": [true], "volume_size": [30]}], "elasticsearch_version": ["2.3"], "tags": [{"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}], "__address__": "aws_elasticsearch_domain.monitoring-framework"}}}, "evaluated_keys": ["advanced_security_options/internal_user_database_enabled", "advanced_security_options/enabled"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/es.tf", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_6", "bc_check_id": "BC_AWS_NETWORKING_52", "check_name": "Ensure that S3 bucket has a Public Access block", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["block_public_policy", "block_public_acls", "resource_type"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"web_vpc": {"__end_line__": 133, "__start_line__": 117, "cidr_block": ["172.16.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9bf2359b-952e-4570-9595-52eba4c20473"}], "__address__": "aws_vpc.web_vpc"}}}, "evaluated_keys": ["ingress/from_port", "ingress/self", "egress/protocol", "ingress/protocol", "resource_type", "ingress/to_port", "egress/to_port", "egress/from_port", "egress/cidr_blocks"]}, "code_block": [[117, "resource \"aws_vpc\" \"web_vpc\" {\n"], [118, "  cidr_block           = \"172.16.0.0/16\"\n"], [119, "  enable_dns_hostnames = true\n"], [120, "  enable_dns_support   = true\n"], [121, "  tags = merge({\n"], [122, "    Name = \"${local.resource_prefix.value}-vpc\"\n"], [123, "    }, {\n"], [124, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [125, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [126, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [127, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [128, "    git_modifiers        = \"nimrodkor\"\n"], [129, "    git_org              = \"bridgecrewio\"\n"], [130, "    git_repo             = \"terragoat\"\n"], [131, "    yor_trace            = \"9bf2359b-952e-4570-9595-52eba4c20473\"\n"], [132, "  })\n"], [133, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [117, 133], "resource": "aws_vpc.web_vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9bf2359b-952e-4570-9595-52eba4c20473"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-4.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_12", "bc_check_id": "BC_AWS_NETWORKING_4", "check_name": "Ensure the default security group of every VPC restricts all traffic", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"eks_vpc": {"__end_line__": 60, "__start_line__": 44, "cidr_block": ["10.10.0.0/16"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "1600ca6c-72f6-45c0-a71d-88e117e51d6b"}], "__address__": "aws_vpc.eks_vpc"}}}, "evaluated_keys": ["ingress/from_port", "ingress/self", "egress/protocol", "ingress/protocol", "resource_type", "ingress/to_port", "egress/to_port", "egress/from_port", "egress/cidr_blocks"]}, "code_block": [[44, "resource aws_vpc \"eks_vpc\" {\n"], [45, "  cidr_block           = \"10.10.0.0/16\"\n"], [46, "  enable_dns_hostnames = true\n"], [47, "  enable_dns_support   = true\n"], [48, "  tags = merge({\n"], [49, "    Name = \"${local.resource_prefix.value}-eks-vpc\"\n"], [50, "    }, {\n"], [51, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [52, "    git_file             = \"terraform/aws/eks.tf\"\n"], [53, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [54, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [55, "    git_modifiers        = \"nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"1600ca6c-72f6-45c0-a71d-88e117e51d6b\"\n"], [59, "  })\n"], [60, "}\n"]], "file_path": "/terraform/aws/eks.tf", "file_abs_path": "/terraform/terraform/aws/eks.tf", "repo_file_path": "/terraform/aws/eks.tf", "file_line_range": [44, 60], "resource": "aws_vpc.eks_vpc", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-eks-vpc", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/eks.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "1600ca6c-72f6-45c0-a71d-88e117e51d6b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-networking-policies/networking-4.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/eks.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-13-enable-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-13-enable-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-13-enable-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-13-enable-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["logging", "resource_type"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-13-enable-logging.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app1-rds-cluster": {"__end_line__": 15, "__start_line__": 1, "allocated_storage": [10], "backup_retention_period": [0], "cluster_identifier": ["app1-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}], "__address__": "aws_rds_cluster.app1-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[1, "resource \"aws_rds_cluster\" \"app1-rds-cluster\" {\n"], [2, "  cluster_identifier      = \"app1-rds-cluster\"\n"], [3, "  allocated_storage       = 10\n"], [4, "  backup_retention_period = 0\n"], [5, "  tags = {\n"], [6, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [7, "    git_file             = \"terraform/aws/rds.tf\"\n"], [8, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [9, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [10, "    git_modifiers        = \"tron47\"\n"], [11, "    git_org              = \"matansha\"\n"], [12, "    git_repo             = \"terragoat\"\n"], [13, "    yor_trace            = \"b6f2c2ec-0715-46a0-83d4-502e588826d1\"\n"], [14, "  }\n"], [15, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [1, 15], "resource": "aws_rds_cluster.app1-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "b6f2c2ec-0715-46a0-83d4-502e588826d1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app2-rds-cluster": {"__end_line__": 31, "__start_line__": 17, "allocated_storage": [10], "backup_retention_period": [1], "cluster_identifier": ["app2-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}], "__address__": "aws_rds_cluster.app2-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[17, "resource \"aws_rds_cluster\" \"app2-rds-cluster\" {\n"], [18, "  cluster_identifier      = \"app2-rds-cluster\"\n"], [19, "  allocated_storage       = 10\n"], [20, "  backup_retention_period = 1\n"], [21, "  tags = {\n"], [22, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [23, "    git_file             = \"terraform/aws/rds.tf\"\n"], [24, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [25, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [26, "    git_modifiers        = \"tron47\"\n"], [27, "    git_org              = \"matansha\"\n"], [28, "    git_repo             = \"terragoat\"\n"], [29, "    yor_trace            = \"d33c9292-952b-4c1f-9973-b6dbad519461\"\n"], [30, "  }\n"], [31, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [17, 31], "resource": "aws_rds_cluster.app2-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "d33c9292-952b-4c1f-9973-b6dbad519461"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app3-rds-cluster": {"__end_line__": 47, "__start_line__": 33, "allocated_storage": [10], "backup_retention_period": [15], "cluster_identifier": ["app3-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}], "__address__": "aws_rds_cluster.app3-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[33, "resource \"aws_rds_cluster\" \"app3-rds-cluster\" {\n"], [34, "  cluster_identifier      = \"app3-rds-cluster\"\n"], [35, "  allocated_storage       = 10\n"], [36, "  backup_retention_period = 15\n"], [37, "  tags = {\n"], [38, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [39, "    git_file             = \"terraform/aws/rds.tf\"\n"], [40, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [41, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [42, "    git_modifiers        = \"tron47\"\n"], [43, "    git_org              = \"matansha\"\n"], [44, "    git_repo             = \"terragoat\"\n"], [45, "    yor_trace            = \"2a8584b1-7e9d-4739-8e37-366620c92027\"\n"], [46, "  }\n"], [47, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [33, 47], "resource": "aws_rds_cluster.app3-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "2a8584b1-7e9d-4739-8e37-366620c92027"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app4-rds-cluster": {"__end_line__": 63, "__start_line__": 49, "allocated_storage": [10], "backup_retention_period": [15], "cluster_identifier": ["app4-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}], "__address__": "aws_rds_cluster.app4-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[49, "resource \"aws_rds_cluster\" \"app4-rds-cluster\" {\n"], [50, "  cluster_identifier      = \"app4-rds-cluster\"\n"], [51, "  allocated_storage       = 10\n"], [52, "  backup_retention_period = 15\n"], [53, "  tags = {\n"], [54, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [55, "    git_file             = \"terraform/aws/rds.tf\"\n"], [56, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [57, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [58, "    git_modifiers        = \"tron47\"\n"], [59, "    git_org              = \"matansha\"\n"], [60, "    git_repo             = \"terragoat\"\n"], [61, "    yor_trace            = \"284aaeed-fd3f-4b7a-b5f8-61a8457f4d83\"\n"], [62, "  }\n"], [63, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [49, 63], "resource": "aws_rds_cluster.app4-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "284aaeed-fd3f-4b7a-b5f8-61a8457f4d83"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app5-rds-cluster": {"__end_line__": 79, "__start_line__": 65, "allocated_storage": [10], "backup_retention_period": [15], "cluster_identifier": ["app5-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}], "__address__": "aws_rds_cluster.app5-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[65, "resource \"aws_rds_cluster\" \"app5-rds-cluster\" {\n"], [66, "  cluster_identifier      = \"app5-rds-cluster\"\n"], [67, "  allocated_storage       = 10\n"], [68, "  backup_retention_period = 15\n"], [69, "  tags = {\n"], [70, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [71, "    git_file             = \"terraform/aws/rds.tf\"\n"], [72, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [73, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [74, "    git_modifiers        = \"tron47\"\n"], [75, "    git_org              = \"matansha\"\n"], [76, "    git_repo             = \"terragoat\"\n"], [77, "    yor_trace            = \"0b2bea23-5ca5-4bd1-956e-b9ed978daadf\"\n"], [78, "  }\n"], [79, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [65, 79], "resource": "aws_rds_cluster.app5-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "0b2bea23-5ca5-4bd1-956e-b9ed978daadf"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app6-rds-cluster": {"__end_line__": 95, "__start_line__": 81, "allocated_storage": [10], "backup_retention_period": [15], "cluster_identifier": ["app6-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}], "__address__": "aws_rds_cluster.app6-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[81, "resource \"aws_rds_cluster\" \"app6-rds-cluster\" {\n"], [82, "  cluster_identifier      = \"app6-rds-cluster\"\n"], [83, "  allocated_storage       = 10\n"], [84, "  backup_retention_period = 15\n"], [85, "  tags = {\n"], [86, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [87, "    git_file             = \"terraform/aws/rds.tf\"\n"], [88, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [89, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [90, "    git_modifiers        = \"tron47\"\n"], [91, "    git_org              = \"matansha\"\n"], [92, "    git_repo             = \"terragoat\"\n"], [93, "    yor_trace            = \"fcffb961-d859-4be5-997f-d51b50665ada\"\n"], [94, "  }\n"], [95, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [81, 95], "resource": "aws_rds_cluster.app6-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "fcffb961-d859-4be5-997f-d51b50665ada"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app7-rds-cluster": {"__end_line__": 111, "__start_line__": 97, "allocated_storage": [10], "backup_retention_period": [25], "cluster_identifier": ["app7-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}], "__address__": "aws_rds_cluster.app7-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[97, "resource \"aws_rds_cluster\" \"app7-rds-cluster\" {\n"], [98, "  cluster_identifier      = \"app7-rds-cluster\"\n"], [99, "  allocated_storage       = 10\n"], [100, "  backup_retention_period = 25\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [103, "    git_file             = \"terraform/aws/rds.tf\"\n"], [104, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [105, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [106, "    git_modifiers        = \"tron47\"\n"], [107, "    git_org              = \"matansha\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"ebc2ac20-23a3-4518-a7ef-3a102b003ab6\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [97, 111], "resource": "aws_rds_cluster.app7-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "ebc2ac20-23a3-4518-a7ef-3a102b003ab6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app8-rds-cluster": {"__end_line__": 128, "__start_line__": 113, "allocated_storage": [10], "backup_retention_period": [25], "cluster_identifier": ["app8-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}], "__address__": "aws_rds_cluster.app8-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[113, "resource \"aws_rds_cluster\" \"app8-rds-cluster\" {\n"], [114, "  cluster_identifier      = \"app8-rds-cluster\"\n"], [115, "  allocated_storage       = 10\n"], [116, "  backup_retention_period = 25\n"], [117, "  tags = {\n"], [118, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [119, "    git_file             = \"terraform/aws/rds.tf\"\n"], [120, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [121, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [122, "    git_modifiers        = \"tron47\"\n"], [123, "    git_org              = \"matansha\"\n"], [124, "    git_repo             = \"terragoat\"\n"], [125, "    yor_trace            = \"af643747-0967-4251-8645-3b54882c2507\"\n"], [126, "\n"], [127, "  }\n"], [128, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [113, 128], "resource": "aws_rds_cluster.app8-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "af643747-0967-4251-8645-3b54882c2507"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV2_AWS_8", "bc_check_id": "BC_AWS_GENERAL_49", "check_name": "Ensure that RDS clusters has backup plan of AWS Backup", "check_result": {"result": "FAILED", "entity": {"aws_rds_cluster": {"app9-rds-cluster": {"__end_line__": 144, "__start_line__": 130, "allocated_storage": [10], "backup_retention_period": [25], "cluster_identifier": ["app9-rds-cluster"], "tags": [{"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}], "__address__": "aws_rds_cluster.app9-rds-cluster"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[130, "resource \"aws_rds_cluster\" \"app9-rds-cluster\" {\n"], [131, "  cluster_identifier      = \"app9-rds-cluster\"\n"], [132, "  allocated_storage       = 10\n"], [133, "  backup_retention_period = 25\n"], [134, "  tags = {\n"], [135, "    git_commit           = \"079fe74f6b96d887c245664fbd8cf676c92f20e5\"\n"], [136, "    git_file             = \"terraform/aws/rds.tf\"\n"], [137, "    git_last_modified_at = \"2021-12-08 23:26:32\"\n"], [138, "    git_last_modified_by = \"tron47@gmail.com\"\n"], [139, "    git_modifiers        = \"tron47\"\n"], [140, "    git_org              = \"matansha\"\n"], [141, "    git_repo             = \"terragoat\"\n"], [142, "    yor_trace            = \"a0c98536-c751-4743-92f1-a106ce750249\"\n"], [143, "  }\n"], [144, "}\n"]], "file_path": "/terraform/aws/rds.tf", "file_abs_path": "/terraform/terraform/aws/rds.tf", "repo_file_path": "/terraform/aws/rds.tf", "file_line_range": [130, 144], "resource": "aws_rds_cluster.app9-rds-cluster", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "079fe74f6b96d887c245664fbd8cf676c92f20e5", "git_file": "terraform/aws/rds.tf", "git_last_modified_at": "2021-12-08 23:26:32", "git_last_modified_by": "tron47@gmail.com", "git_modifiers": "tron47", "git_org": "matansha", "git_repo": "terragoat", "yor_trace": "a0c98536-c751-4743-92f1-a106ce750249"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-rds-clusters-has-backup-plan-of-aws-backup.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/rds.tf"}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-16-enable-versioning.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-16-enable-versioning.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_21", "bc_check_id": "BC_AWS_S3_16", "check_name": "Ensure all data stored in the S3 bucket have versioning enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["versioning_configuration/status", "versioning/enabled", "resource_type"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/s3-policies/s3-16-enable-versioning.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_145", "bc_check_id": "BC_AWS_GENERAL_56", "check_name": "Ensure that S3 buckets are encrypted with KMS by default", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["rule/apply_server_side_encryption_by_default/sse_algorithm", "server_side_encryption_configuration/rule/apply_server_side_encryption_by_default/sse_algorithm", "resource_type"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"flowbucket": {"__end_line__": 288, "__start_line__": 271, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-flowlogs"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}], "__address__": "aws_s3_bucket.flowbucket"}}}, "evaluated_keys": ["rule/*/status", "resource_type", "replication_configuration/rules/*/status"]}, "code_block": [[271, "resource \"aws_s3_bucket\" \"flowbucket\" {\n"], [272, "  bucket        = \"${local.resource_prefix.value}-flowlogs\"\n"], [273, "  force_destroy = true\n"], [274, "\n"], [275, "  tags = merge({\n"], [276, "    Name        = \"${local.resource_prefix.value}-flowlogs\"\n"], [277, "    Environment = local.resource_prefix.value\n"], [278, "    }, {\n"], [279, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [280, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [281, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [282, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [283, "    git_modifiers        = \"nimrodkor\"\n"], [284, "    git_org              = \"bridgecrewio\"\n"], [285, "    git_repo             = \"terragoat\"\n"], [286, "    yor_trace            = \"f058838a-b1e0-4383-b965-7e06e987ffb1\"\n"], [287, "  })\n"], [288, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [271, 288], "resource": "aws_s3_bucket.flowbucket", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-flowlogs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "f058838a-b1e0-4383-b965-7e06e987ffb1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data": {"__end_line__": 21, "__start_line__": 1, "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}], "__address__": "aws_s3_bucket.data"}}}, "evaluated_keys": ["rule/*/status", "resource_type", "replication_configuration/rules/*/status"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"data\" {\n"], [2, "  # bucket is public\n"], [3, "  # bucket is not encrypted\n"], [4, "  # bucket does not have access logs\n"], [5, "  # bucket does not have versioning\n"], [6, "  bucket        = \"${local.resource_prefix.value}-data\"\n"], [7, "  force_destroy = true\n"], [8, "  tags = merge({\n"], [9, "    Name        = \"${local.resource_prefix.value}-data\"\n"], [10, "    Environment = local.resource_prefix.value\n"], [11, "    }, {\n"], [12, "    git_commit           = \"4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5\"\n"], [13, "    git_file             = \"terraform/aws/s3.tf\"\n"], [14, "    git_last_modified_at = \"2022-05-18 07:08:06\"\n"], [15, "    git_last_modified_by = \"nimrod@bridgecrew.io\"\n"], [16, "    git_modifiers        = \"34870196+LironElbaz/nimrod/nimrodkor\"\n"], [17, "    git_org              = \"bridgecrewio\"\n"], [18, "    git_repo             = \"terragoat\"\n"], [19, "    yor_trace            = \"0874007d-903a-4b4c-945f-c9c233e13243\"\n"], [20, "  })\n"], [21, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [1, 21], "resource": "aws_s3_bucket.data", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-data", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "4d57f83ca4d3a78a44fb36d1dcf0d23983fa44f5", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2022-05-18 07:08:06", "git_last_modified_by": "nimrod@bridgecrew.io", "git_modifiers": "34870196+LironElbaz/nimrod/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0874007d-903a-4b4c-945f-c9c233e13243"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"financials": {"__end_line__": 63, "__start_line__": 42, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-financials"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}], "__address__": "aws_s3_bucket.financials"}}}, "evaluated_keys": ["rule/*/status", "resource_type", "replication_configuration/rules/*/status"]}, "code_block": [[42, "resource \"aws_s3_bucket\" \"financials\" {\n"], [43, "  # bucket is not encrypted\n"], [44, "  # bucket does not have access logs\n"], [45, "  # bucket does not have versioning\n"], [46, "  bucket        = \"${local.resource_prefix.value}-financials\"\n"], [47, "  acl           = \"private\"\n"], [48, "  force_destroy = true\n"], [49, "  tags = merge({\n"], [50, "    Name        = \"${local.resource_prefix.value}-financials\"\n"], [51, "    Environment = local.resource_prefix.value\n"], [52, "    }, {\n"], [53, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [54, "    git_file             = \"terraform/aws/s3.tf\"\n"], [55, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [56, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [57, "    git_modifiers        = \"nimrodkor\"\n"], [58, "    git_org              = \"bridgecrewio\"\n"], [59, "    git_repo             = \"terragoat\"\n"], [60, "    yor_trace            = \"0e012640-b597-4e5d-9378-d4b584aea913\"\n"], [61, "  })\n"], [62, "\n"], [63, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [42, 63], "resource": "aws_s3_bucket.financials", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-financials", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0e012640-b597-4e5d-9378-d4b584aea913"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"operations": {"__end_line__": 87, "__start_line__": 65, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-operations"], "force_destroy": [true], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.operations"}}}, "evaluated_keys": ["rule/*/status", "resource_type", "replication_configuration/rules/*/status"]}, "code_block": [[65, "resource \"aws_s3_bucket\" \"operations\" {\n"], [66, "  # bucket is not encrypted\n"], [67, "  # bucket does not have access logs\n"], [68, "  bucket = \"${local.resource_prefix.value}-operations\"\n"], [69, "  acl    = \"private\"\n"], [70, "  versioning {\n"], [71, "    enabled = true\n"], [72, "  }\n"], [73, "  force_destroy = true\n"], [74, "  tags = merge({\n"], [75, "    Name        = \"${local.resource_prefix.value}-operations\"\n"], [76, "    Environment = local.resource_prefix.value\n"], [77, "    }, {\n"], [78, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [79, "    git_file             = \"terraform/aws/s3.tf\"\n"], [80, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [81, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [82, "    git_modifiers        = \"nimrodkor\"\n"], [83, "    git_org              = \"bridgecrewio\"\n"], [84, "    git_repo             = \"terragoat\"\n"], [85, "    yor_trace            = \"29efcf7b-22a8-4bd6-8e14-1f55b3a2d743\"\n"], [86, "  })\n"], [87, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [65, 87], "resource": "aws_s3_bucket.operations", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-operations", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "29efcf7b-22a8-4bd6-8e14-1f55b3a2d743"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"data_science": {"__end_line__": 111, "__start_line__": 89, "acl": ["private"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-data-science"], "force_destroy": [true], "logging": [{"target_bucket": ["aws_s3_bucket.logs.id"], "target_prefix": ["log/"]}], "tags": [{"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.data_science"}}}, "evaluated_keys": ["rule/*/status", "resource_type", "replication_configuration/rules/*/status"]}, "code_block": [[89, "resource \"aws_s3_bucket\" \"data_science\" {\n"], [90, "  # bucket is not encrypted\n"], [91, "  bucket = \"${local.resource_prefix.value}-data-science\"\n"], [92, "  acl    = \"private\"\n"], [93, "  versioning {\n"], [94, "    enabled = true\n"], [95, "  }\n"], [96, "  logging {\n"], [97, "    target_bucket = \"${aws_s3_bucket.logs.id}\"\n"], [98, "    target_prefix = \"log/\"\n"], [99, "  }\n"], [100, "  force_destroy = true\n"], [101, "  tags = {\n"], [102, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [103, "    git_file             = \"terraform/aws/s3.tf\"\n"], [104, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [105, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [106, "    git_modifiers        = \"nimrodkor\"\n"], [107, "    git_org              = \"bridgecrewio\"\n"], [108, "    git_repo             = \"terragoat\"\n"], [109, "    yor_trace            = \"9a7c8788-5655-4708-bbc3-64ead9847f64\"\n"], [110, "  }\n"], [111, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [89, 111], "resource": "aws_s3_bucket.data_science", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "9a7c8788-5655-4708-bbc3-64ead9847f64"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV_AWS_144", "bc_check_id": "BC_AWS_GENERAL_72", "check_name": "Ensure that S3 bucket has cross-region replication enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"logs": {"__end_line__": 141, "__start_line__": 113, "acl": ["log-delivery-write"], "bucket": ["${data.aws_caller_identity.current.account_id}-acme-dev-logs"], "force_destroy": [true], "server_side_encryption_configuration": [{"rule": [{"apply_server_side_encryption_by_default": [{"kms_master_key_id": ["aws_kms_key.logs_key.arn"], "sse_algorithm": ["aws:kms"]}]}]}], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}], "versioning": [{"enabled": [true]}], "__address__": "aws_s3_bucket.logs"}}}, "evaluated_keys": ["rule/*/status", "resource_type", "replication_configuration/rules/*/status"]}, "code_block": [[113, "resource \"aws_s3_bucket\" \"logs\" {\n"], [114, "  bucket = \"${local.resource_prefix.value}-logs\"\n"], [115, "  acl    = \"log-delivery-write\"\n"], [116, "  versioning {\n"], [117, "    enabled = true\n"], [118, "  }\n"], [119, "  server_side_encryption_configuration {\n"], [120, "    rule {\n"], [121, "      apply_server_side_encryption_by_default {\n"], [122, "        sse_algorithm     = \"aws:kms\"\n"], [123, "        kms_master_key_id = \"${aws_kms_key.logs_key.arn}\"\n"], [124, "      }\n"], [125, "    }\n"], [126, "  }\n"], [127, "  force_destroy = true\n"], [128, "  tags = merge({\n"], [129, "    Name        = \"${local.resource_prefix.value}-logs\"\n"], [130, "    Environment = local.resource_prefix.value\n"], [131, "    }, {\n"], [132, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [133, "    git_file             = \"terraform/aws/s3.tf\"\n"], [134, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [135, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [136, "    git_modifiers        = \"nimrodkor\"\n"], [137, "    git_org              = \"bridgecrewio\"\n"], [138, "    git_repo             = \"terragoat\"\n"], [139, "    yor_trace            = \"01946fe9-aae2-4c99-a975-e9b0d3a4696c\"\n"], [140, "  })\n"], [141, "}\n"]], "file_path": "/terraform/aws/s3.tf", "file_abs_path": "/terraform/terraform/aws/s3.tf", "repo_file_path": "/terraform/aws/s3.tf", "file_line_range": [113, 141], "resource": "aws_s3_bucket.logs", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-logs", "Environment": "data.aws_caller_identity.current.account_id-acme-dev", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/s3.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "01946fe9-aae2-4c99-a975-e9b0d3a4696c"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/s3.tf", "breadcrumbs": {"tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "bucket": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_41", "bc_check_id": "BC_AWS_IAM_69", "check_name": "Ensure an IAM role is attached to EC2 instance", "check_result": {"result": "FAILED", "entity": {"aws_instance": {"web_host": {"__end_line__": 32, "__start_line__": 1, "ami": ["ami-09a5b0b7edf08843d"], "instance_type": ["t2.nano"], "subnet_id": ["aws_subnet.web_subnet.id"], "tags": [{"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}], "user_data": ["#! /bin/bashsudo apt-get updatesudo apt-get install -y apache2sudo systemctl start apache2sudo systemctl enable apache2export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAAexport AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEYexport AWS_DEFAULT_REGION=us-west-2echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html"], "vpc_security_group_ids": [["aws_security_group.web-node.id"]], "__address__": "aws_instance.web_host", "CKV_AWS_46_secret": "#! /bin/bashsudo apt-get updatesudo apt-get install -y apache2sudo systemctl start apache2sudo systemctl enable apache2export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAAexport AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMAAAKEYexport AWS_DEFAULT_REGION=us-west-2echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html"}}}, "evaluated_keys": ["iam_instance_profile"]}, "code_block": [[1, "resource \"aws_instance\" \"web_host\" {\n"], [2, "  # ec2 have plain text secrets in user data\n"], [3, "  ami           = \"${var.ami}\"\n"], [4, "  instance_type = \"t2.nano\"\n"], [5, "\n"], [6, "  vpc_security_group_ids = [\n"], [7, "  \"${aws_security_group.web-node.id}\"]\n"], [8, "  subnet_id = \"${aws_subnet.web_subnet.id}\"\n"], [9, "  user_data = <<EOF\n"], [10, "#! /bin/bash\n"], [11, "sudo apt-get update\n"], [12, "sudo apt-get install -y apache2\n"], [13, "sudo systemctl start apache2\n"], [14, "sudo systemctl enable apache2\n"], [15, "export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMAAA\n"], [16, "export AWS_SECRET_ACCESS_KEY=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\n"], [17, "export AWS_DEFAULT_REGION=us-west-2\n"], [18, "echo \"<h1>Deployed via Terraform</h1>\" | sudo tee /var/www/html/index.html\n"], [19, "EOF\n"], [20, "  tags = merge({\n"], [21, "    Name = \"${local.resource_prefix.value}-ec2\"\n"], [22, "    }, {\n"], [23, "    git_commit           = \"d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0\"\n"], [24, "    git_file             = \"terraform/aws/ec2.tf\"\n"], [25, "    git_last_modified_at = \"2020-06-16 14:46:24\"\n"], [26, "    git_last_modified_by = \"nimrodkor@gmail.com\"\n"], [27, "    git_modifiers        = \"nimrodkor\"\n"], [28, "    git_org              = \"bridgecrewio\"\n"], [29, "    git_repo             = \"terragoat\"\n"], [30, "    yor_trace            = \"347af3cd-4f70-4632-aca3-4d5e30ffc0b6\"\n"], [31, "  })\n"], [32, "}\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [1, 32], "resource": "aws_instance.web_host", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Name": "data.aws_caller_identity.current.account_id-acme-dev-ec2", "git_commit": "d68d2897add9bc2203a5ed0632a5cdd8ff8cefb0", "git_file": "terraform/aws/ec2.tf", "git_last_modified_at": "2020-06-16 14:46:24", "git_last_modified_by": "nimrodkor@gmail.com", "git_modifiers": "nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "347af3cd-4f70-4632-aca3-4d5e30ffc0b6"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/ec2.tf", "breadcrumbs": {"ami": [{"type": "variable", "name": "ami", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}], "tags": [{"type": "locals", "name": "resource_prefix", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}]}}, {"check_id": "CKV2_AWS_59", "bc_check_id": null, "check_name": "Ensure ElasticSearch/OpenSearch has dedicated master node enabled", "check_result": {"result": "FAILED", "entity": {"aws_elasticsearch_domain": {"monitoring-framework": {"__end_line__": 28, "__start_line__": 1, "cluster_config": [{"dedicated_master_count": [1], "dedicated_master_enabled": [false], "dedicated_master_type": ["m4.large.elasticsearch"], "instance_count": [1], "instance_type": ["t2.small.elasticsearch"]}], "domain_name": ["tg-dev-es"], "ebs_options": [{"ebs_enabled": [true], "volume_size": [30]}], "elasticsearch_version": ["2.3"], "tags": [{"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}], "__address__": "aws_elasticsearch_domain.monitoring-framework"}}}, "evaluated_keys": ["cluster_config/dedicated_master_enabled"]}, "code_block": [[1, "resource \"aws_elasticsearch_domain\" \"monitoring-framework\" {\n"], [2, "  domain_name           = \"tg-${var.environment}-es\"\n"], [3, "  elasticsearch_version = \"2.3\"\n"], [4, "\n"], [5, "  cluster_config {\n"], [6, "    instance_type            = \"t2.small.elasticsearch\"\n"], [7, "    instance_count           = 1\n"], [8, "    dedicated_master_enabled = false\n"], [9, "    dedicated_master_type    = \"m4.large.elasticsearch\"\n"], [10, "    dedicated_master_count   = 1\n"], [11, "  }\n"], [12, "\n"], [13, "\n"], [14, "  ebs_options {\n"], [15, "    ebs_enabled = true\n"], [16, "    volume_size = 30\n"], [17, "  }\n"], [18, "  tags = {\n"], [19, "    git_commit           = \"e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7\"\n"], [20, "    git_file             = \"terraform/aws/es.tf\"\n"], [21, "    git_last_modified_at = \"2023-04-27 12:47:51\"\n"], [22, "    git_last_modified_by = \"nadler@paloaltonetworks.com\"\n"], [23, "    git_modifiers        = \"nadler/nimrodkor\"\n"], [24, "    git_org              = \"bridgecrewio\"\n"], [25, "    git_repo             = \"terragoat\"\n"], [26, "    yor_trace            = \"95131dec-d7c9-49bb-9aff-eb0e2736603b\"\n"], [27, "  }\n"], [28, "}\n"]], "file_path": "/terraform/aws/es.tf", "file_abs_path": "/terraform/terraform/aws/es.tf", "repo_file_path": "/terraform/aws/es.tf", "file_line_range": [1, 28], "resource": "aws_elasticsearch_domain.monitoring-framework", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "e6d83b21346fe85d4fe28b16c0b2f1e0662eb1d7", "git_file": "terraform/aws/es.tf", "git_last_modified_at": "2023-04-27 12:47:51", "git_last_modified_by": "nadler@paloaltonetworks.com", "git_modifiers": "nadler/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "95131dec-d7c9-49bb-9aff-eb0e2736603b"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/aws/es.tf", "breadcrumbs": {"domain_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/aws/consts.tf", "module_connection": false}, {"type": "resource", "name": "aws_elasticsearch_domain.monitoring-framework", "path": "/terraform/terraform/aws/es.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_33", "bc_check_id": null, "check_name": "Ensure storage account is configured with private endpoint", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"security_storage_account": {"__end_line__": 18, "__start_line__": 1, "account_replication_type": ["LRS"], "account_tier": ["Standard"], "enable_https_traffic_only": [true], "location": ["East US"], "name": ["securitystorageaccount-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "a1d1c1ce31a1bde6dafa188846d90eca82abe5fd", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 05:32:41", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "4b504d4d-608c-45fe-ae56-807bde6d969f"}], "__address__": "azurerm_storage_account.security_storage_account"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "a1d1c1ce31a1bde6dafa188846d90eca82abe5fd", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 05:32:41", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "4b504d4d-608c-45fe-ae56-807bde6d969f"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_33", "bc_check_id": null, "check_name": "Ensure storage account is configured with private endpoint", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"example": {"__end_line__": 60, "__start_line__": 23, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "location": ["East US"], "name": ["tgsadev${random_integer.rnd_int.result}"], "queue_properties": [{"hour_metrics": [{"enabled": [true], "include_apis": [true], "retention_policy_days": [10], "version": ["1.0"]}], "logging": [{"delete": [false], "read": [false], "retention_policy_days": [10], "version": ["1.0"], "write": [true]}], "minute_metrics": [{"enabled": [true], "include_apis": [true], "retention_policy_days": [10], "version": ["1.0"]}]}], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/azure/storage.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "23861ff4-c42d-495e-80ac-776c74035f43"}], "__address__": "azurerm_storage_account.example"}}}, "evaluated_keys": ["resource_type"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/azure/storage.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "23861ff4-c42d-495e-80ac-776c74035f43"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/storage.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_1", "bc_check_id": "BC_AZR_GENERAL_32", "check_name": "Ensure storage for critical data are encrypted with Customer Managed Key", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"security_storage_account": {"__end_line__": 18, "__start_line__": 1, "account_replication_type": ["LRS"], "account_tier": ["Standard"], "enable_https_traffic_only": [true], "location": ["East US"], "name": ["securitystorageaccount-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "a1d1c1ce31a1bde6dafa188846d90eca82abe5fd", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 05:32:41", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "4b504d4d-608c-45fe-ae56-807bde6d969f"}], "__address__": "azurerm_storage_account.security_storage_account"}}}, "evaluated_keys": ["customer_managed_key/key_vault_key_id", "resource_type"]}, "code_block": [[1, "resource \"azurerm_storage_account\" \"security_storage_account\" {\n"], [2, "  name                      = \"securitystorageaccount-${var.environment}${random_integer.rnd_int.result}\"\n"], [3, "  resource_group_name       = azurerm_resource_group.example.name\n"], [4, "  location                  = azurerm_resource_group.example.location\n"], [5, "  account_tier              = \"Standard\"\n"], [6, "  account_replication_type  = \"LRS\"\n"], [7, "  enable_https_traffic_only = true\n"], [8, "  tags = {\n"], [9, "    git_commit           = \"a1d1c1ce31a1bde6dafa188846d90eca82abe5fd\"\n"], [10, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [11, "    git_last_modified_at = \"2022-01-20 05:32:41\"\n"], [12, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [13, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [14, "    git_org              = \"bridgecrewio\"\n"], [15, "    git_repo             = \"terragoat\"\n"], [16, "    yor_trace            = \"4b504d4d-608c-45fe-ae56-807bde6d969f\"\n"], [17, "  }\n"], [18, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [1, 18], "resource": "azurerm_storage_account.security_storage_account", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "a1d1c1ce31a1bde6dafa188846d90eca82abe5fd", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 05:32:41", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "4b504d4d-608c-45fe-ae56-807bde6d969f"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_1", "bc_check_id": "BC_AZR_GENERAL_32", "check_name": "Ensure storage for critical data are encrypted with Customer Managed Key", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"example": {"__end_line__": 60, "__start_line__": 23, "account_replication_type": ["GRS"], "account_tier": ["Standard"], "location": ["East US"], "name": ["tgsadev${random_integer.rnd_int.result}"], "queue_properties": [{"hour_metrics": [{"enabled": [true], "include_apis": [true], "retention_policy_days": [10], "version": ["1.0"]}], "logging": [{"delete": [false], "read": [false], "retention_policy_days": [10], "version": ["1.0"], "write": [true]}], "minute_metrics": [{"enabled": [true], "include_apis": [true], "retention_policy_days": [10], "version": ["1.0"]}]}], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/azure/storage.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "23861ff4-c42d-495e-80ac-776c74035f43"}], "__address__": "azurerm_storage_account.example"}}}, "evaluated_keys": ["customer_managed_key/key_vault_key_id", "resource_type"]}, "code_block": [[23, "resource \"azurerm_storage_account\" \"example\" {\n"], [24, "  name                     = \"tgsa${var.environment}${random_integer.rnd_int.result}\"\n"], [25, "  resource_group_name      = azurerm_resource_group.example.name\n"], [26, "  location                 = azurerm_resource_group.example.location\n"], [27, "  account_tier             = \"Standard\"\n"], [28, "  account_replication_type = \"GRS\"\n"], [29, "  queue_properties {\n"], [30, "    logging {\n"], [31, "      delete                = false\n"], [32, "      read                  = false\n"], [33, "      write                 = true\n"], [34, "      version               = \"1.0\"\n"], [35, "      retention_policy_days = 10\n"], [36, "    }\n"], [37, "    hour_metrics {\n"], [38, "      enabled               = true\n"], [39, "      include_apis          = true\n"], [40, "      version               = \"1.0\"\n"], [41, "      retention_policy_days = 10\n"], [42, "    }\n"], [43, "    minute_metrics {\n"], [44, "      enabled               = true\n"], [45, "      include_apis          = true\n"], [46, "      version               = \"1.0\"\n"], [47, "      retention_policy_days = 10\n"], [48, "    }\n"], [49, "  }\n"], [50, "  tags = {\n"], [51, "    git_commit           = \"5c6b5d60a8aa63a5d37e60f15185d13a967f0542\"\n"], [52, "    git_file             = \"terraform/azure/storage.tf\"\n"], [53, "    git_last_modified_at = \"2021-05-02 10:06:10\"\n"], [54, "    git_last_modified_by = \"nimrodkor@users.noreply.github.com\"\n"], [55, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [56, "    git_org              = \"bridgecrewio\"\n"], [57, "    git_repo             = \"terragoat\"\n"], [58, "    yor_trace            = \"23861ff4-c42d-495e-80ac-776c74035f43\"\n"], [59, "  }\n"], [60, "}\n"]], "file_path": "/terraform/azure/storage.tf", "file_abs_path": "/terraform/terraform/azure/storage.tf", "repo_file_path": "/terraform/azure/storage.tf", "file_line_range": [23, 60], "resource": "azurerm_storage_account.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "5c6b5d60a8aa63a5d37e60f15185d13a967f0542", "git_file": "terraform/azure/storage.tf", "git_last_modified_at": "2021-05-02 10:06:10", "git_last_modified_by": "nimrodkor@users.noreply.github.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "23861ff4-c42d-495e-80ac-776c74035f43"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/storage.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_storage_account.example", "path": "/terraform/terraform/azure/storage.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": null, "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"example": {"__end_line__": 23, "__start_line__": 18, "address_prefixes": [["10.0.0.0/24"]], "name": ["terragoat-dev"], "resource_group_name": ["terragoat-dev"], "virtual_network_name": ["terragoat-vn-dev"], "__address__": "azurerm_subnet.example"}}}, "evaluated_keys": ["delegation/service_delegation/name", "name", "resource_type"]}, "code_block": [[18, "resource \"azurerm_subnet\" \"example\" {\n"], [19, "  name                 = \"terragoat-${var.environment}\"\n"], [20, "  resource_group_name  = azurerm_resource_group.example.name\n"], [21, "  virtual_network_name = azurerm_virtual_network.example.name\n"], [22, "  address_prefixes     = [\"10.0.0.0/24\"]\n"], [23, "}\n"]], "file_path": "/terraform/azure/networking.tf", "file_abs_path": "/terraform/terraform/azure/networking.tf", "repo_file_path": "/terraform/azure/networking.tf", "file_line_range": [18, 23], "resource": "azurerm_subnet.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": {}, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/networking.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "virtual_network_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_virtual_network.example", "path": "/terraform/terraform/azure/networking.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql1": {"__end_line__": 37, "__start_line__": 20, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["terragoat-mssql1-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "54f6cb23-b30a-4f1d-8064-6f777b9b75db"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql1"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[20, "resource \"azurerm_mssql_server\" \"mssql1\" {\n"], [21, "  name                         = \"terragoat-mssql1-${var.environment}${random_integer.rnd_int.result}\"\n"], [22, "  resource_group_name          = azurerm_resource_group.example.name\n"], [23, "  location                     = azurerm_resource_group.example.location\n"], [24, "  version                      = \"12.0\"\n"], [25, "  administrator_login          = \"missadministrator\"\n"], [26, "  administrator_login_password = \"AdminPassword123!\"\n"], [27, "  tags = {\n"], [28, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [29, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [30, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [31, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [32, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [33, "    git_org              = \"bridgecrewio\"\n"], [34, "    git_repo             = \"terragoat\"\n"], [35, "    yor_trace            = \"54f6cb23-b30a-4f1d-8064-6f777b9b75db\"\n"], [36, "  }\n"], [37, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [20, 37], "resource": "azurerm_mssql_server.mssql1", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "54f6cb23-b30a-4f1d-8064-6f777b9b75db"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql1", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql2": {"__end_line__": 56, "__start_line__": 39, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql2-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "096d2cf2-6d47-41b2-9418-cdedea85e184"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql2"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[39, "resource \"azurerm_mssql_server\" \"mssql2\" {\n"], [40, "  name                         = \"mssql2-${var.environment}${random_integer.rnd_int.result}\"\n"], [41, "  resource_group_name          = azurerm_resource_group.example.name\n"], [42, "  location                     = azurerm_resource_group.example.location\n"], [43, "  version                      = \"12.0\"\n"], [44, "  administrator_login          = \"missadministrator\"\n"], [45, "  administrator_login_password = \"AdminPassword123!\"\n"], [46, "  tags = {\n"], [47, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [48, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [49, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [50, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [51, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [52, "    git_org              = \"bridgecrewio\"\n"], [53, "    git_repo             = \"terragoat\"\n"], [54, "    yor_trace            = \"096d2cf2-6d47-41b2-9418-cdedea85e184\"\n"], [55, "  }\n"], [56, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [39, 56], "resource": "azurerm_mssql_server.mssql2", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "096d2cf2-6d47-41b2-9418-cdedea85e184"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql2", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql3": {"__end_line__": 75, "__start_line__": 58, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql3-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e71d3fb5-addc-481d-ada6-b7432a768de3"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql3"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[58, "resource \"azurerm_mssql_server\" \"mssql3\" {\n"], [59, "  name                         = \"mssql3-${var.environment}${random_integer.rnd_int.result}\"\n"], [60, "  resource_group_name          = azurerm_resource_group.example.name\n"], [61, "  location                     = azurerm_resource_group.example.location\n"], [62, "  version                      = \"12.0\"\n"], [63, "  administrator_login          = \"missadministrator\"\n"], [64, "  administrator_login_password = \"AdminPassword123!\"\n"], [65, "  tags = {\n"], [66, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [67, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [68, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [69, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [70, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [71, "    git_org              = \"bridgecrewio\"\n"], [72, "    git_repo             = \"terragoat\"\n"], [73, "    yor_trace            = \"e71d3fb5-addc-481d-ada6-b7432a768de3\"\n"], [74, "  }\n"], [75, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [58, 75], "resource": "azurerm_mssql_server.mssql3", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e71d3fb5-addc-481d-ada6-b7432a768de3"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql3", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql4": {"__end_line__": 94, "__start_line__": 77, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql4-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c3b85724-4f7e-4c63-a17d-3d04239beae8"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql4"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[77, "resource \"azurerm_mssql_server\" \"mssql4\" {\n"], [78, "  name                         = \"mssql4-${var.environment}${random_integer.rnd_int.result}\"\n"], [79, "  resource_group_name          = azurerm_resource_group.example.name\n"], [80, "  location                     = azurerm_resource_group.example.location\n"], [81, "  version                      = \"12.0\"\n"], [82, "  administrator_login          = \"missadministrator\"\n"], [83, "  administrator_login_password = \"AdminPassword123!\"\n"], [84, "  tags = {\n"], [85, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [86, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [87, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [88, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [89, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [90, "    git_org              = \"bridgecrewio\"\n"], [91, "    git_repo             = \"terragoat\"\n"], [92, "    yor_trace            = \"c3b85724-4f7e-4c63-a17d-3d04239beae8\"\n"], [93, "  }\n"], [94, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [77, 94], "resource": "azurerm_mssql_server.mssql4", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "c3b85724-4f7e-4c63-a17d-3d04239beae8"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql4", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql5": {"__end_line__": 113, "__start_line__": 96, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql5-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0240ca84-acc9-47d9-b491-9e7e359787a1"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql5"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[96, "resource \"azurerm_mssql_server\" \"mssql5\" {\n"], [97, "  name                         = \"mssql5-${var.environment}${random_integer.rnd_int.result}\"\n"], [98, "  resource_group_name          = azurerm_resource_group.example.name\n"], [99, "  location                     = azurerm_resource_group.example.location\n"], [100, "  version                      = \"12.0\"\n"], [101, "  administrator_login          = \"missadministrator\"\n"], [102, "  administrator_login_password = \"AdminPassword123!\"\n"], [103, "  tags = {\n"], [104, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [105, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [106, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [107, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [108, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [109, "    git_org              = \"bridgecrewio\"\n"], [110, "    git_repo             = \"terragoat\"\n"], [111, "    yor_trace            = \"0240ca84-acc9-47d9-b491-9e7e359787a1\"\n"], [112, "  }\n"], [113, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [96, 113], "resource": "azurerm_mssql_server.mssql5", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "0240ca84-acc9-47d9-b491-9e7e359787a1"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql5", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql6": {"__end_line__": 132, "__start_line__": 115, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql6-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "042d15fb-edfa-484b-b65e-3d70c50cdee7"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql6"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[115, "resource \"azurerm_mssql_server\" \"mssql6\" {\n"], [116, "  name                         = \"mssql6-${var.environment}${random_integer.rnd_int.result}\"\n"], [117, "  resource_group_name          = azurerm_resource_group.example.name\n"], [118, "  location                     = azurerm_resource_group.example.location\n"], [119, "  version                      = \"12.0\"\n"], [120, "  administrator_login          = \"missadministrator\"\n"], [121, "  administrator_login_password = \"AdminPassword123!\"\n"], [122, "  tags = {\n"], [123, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [124, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [125, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [126, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [127, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [128, "    git_org              = \"bridgecrewio\"\n"], [129, "    git_repo             = \"terragoat\"\n"], [130, "    yor_trace            = \"042d15fb-edfa-484b-b65e-3d70c50cdee7\"\n"], [131, "  }\n"], [132, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [115, 132], "resource": "azurerm_mssql_server.mssql6", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "042d15fb-edfa-484b-b65e-3d70c50cdee7"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql6", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_mssql_server": {"mssql7": {"__end_line__": 151, "__start_line__": 134, "administrator_login": ["missadministrator"], "administrator_login_password": ["AdminPassword123!"], "location": ["East US"], "name": ["mssql7-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f1118e1-5067-452e-906f-5123cfc93711"}], "version": ["12.0"], "__address__": "azurerm_mssql_server.mssql7"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[134, "resource \"azurerm_mssql_server\" \"mssql7\" {\n"], [135, "  name                         = \"mssql7-${var.environment}${random_integer.rnd_int.result}\"\n"], [136, "  resource_group_name          = azurerm_resource_group.example.name\n"], [137, "  location                     = azurerm_resource_group.example.location\n"], [138, "  version                      = \"12.0\"\n"], [139, "  administrator_login          = \"missadministrator\"\n"], [140, "  administrator_login_password = \"AdminPassword123!\"\n"], [141, "  tags = {\n"], [142, "    git_commit           = \"c6f8caa51942284d02465518822685897ad90141\"\n"], [143, "    git_file             = \"terraform/azure/mssql.tf\"\n"], [144, "    git_last_modified_at = \"2022-01-20 18:41:19\"\n"], [145, "    git_last_modified_by = \"28880387+tsmithv11@users.noreply.github.com\"\n"], [146, "    git_modifiers        = \"28880387+tsmithv11\"\n"], [147, "    git_org              = \"bridgecrewio\"\n"], [148, "    git_repo             = \"terragoat\"\n"], [149, "    yor_trace            = \"3f1118e1-5067-452e-906f-5123cfc93711\"\n"], [150, "  }\n"], [151, "}\n"]], "file_path": "/terraform/azure/mssql.tf", "file_abs_path": "/terraform/terraform/azure/mssql.tf", "repo_file_path": "/terraform/azure/mssql.tf", "file_line_range": [134, 151], "resource": "azurerm_mssql_server.mssql7", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"git_commit": "c6f8caa51942284d02465518822685897ad90141", "git_file": "terraform/azure/mssql.tf", "git_last_modified_at": "2022-01-20 18:41:19", "git_last_modified_by": "28880387+tsmithv11@users.noreply.github.com", "git_modifiers": "28880387+tsmithv11", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "3f1118e1-5067-452e-906f-5123cfc93711"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/mssql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_mssql_server.mssql7", "path": "/terraform/terraform/azure/mssql.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_24", "bc_check_id": "BC_AZR_LOGGING_3", "check_name": "Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers", "check_result": {"result": "FAILED", "entity": {"azurerm_sql_server": {"example": {"__end_line__": 29, "__start_line__": 9, "administrator_login": ["ariel"], "administrator_login_password": ["Aa12345678"], "location": ["East US"], "name": ["terragoat-sqlserver-dev${random_integer.rnd_int.result}"], "resource_group_name": ["terragoat-dev"], "tags": [{"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}], "version": ["12.0"], "__address__": "azurerm_sql_server.example"}}}, "evaluated_keys": ["retention_in_days", "extended_auditing_policy/*/retention_in_days", "resource_type"]}, "code_block": [[9, "resource \"azurerm_sql_server\" \"example\" {\n"], [10, "  name                         = \"terragoat-sqlserver-${var.environment}${random_integer.rnd_int.result}\"\n"], [11, "  resource_group_name          = azurerm_resource_group.example.name\n"], [12, "  location                     = azurerm_resource_group.example.location\n"], [13, "  version                      = \"12.0\"\n"], [14, "  administrator_login          = \"ariel\"\n"], [15, "  administrator_login_password = \"Aa12345678\"\n"], [16, "  tags = merge({\n"], [17, "    environment = var.environment\n"], [18, "    terragoat   = \"true\"\n"], [19, "    }, {\n"], [20, "    git_commit           = \"81738b80d571fa3034633690d13ffb460e1e7dea\"\n"], [21, "    git_file             = \"terraform/azure/sql.tf\"\n"], [22, "    git_last_modified_at = \"2020-06-19 21:14:50\"\n"], [23, "    git_last_modified_by = \"Adin.Ermie@outlook.com\"\n"], [24, "    git_modifiers        = \"Adin.Ermie/nimrodkor\"\n"], [25, "    git_org              = \"bridgecrewio\"\n"], [26, "    git_repo             = \"terragoat\"\n"], [27, "    yor_trace            = \"e5ec3432-e61f-4244-b59e-9ecc24ddd4cb\"\n"], [28, "  })\n"], [29, "}\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [9, 29], "resource": "azurerm_sql_server.example", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"environment": "dev", "terragoat": "true", "git_commit": "81738b80d571fa3034633690d13ffb460e1e7dea", "git_file": "terraform/azure/sql.tf", "git_last_modified_at": "2020-06-19 21:14:50", "git_last_modified_by": "Adin.Ermie@outlook.com", "git_modifiers": "Adin.Ermie/nimrodkor", "git_org": "bridgecrewio", "git_repo": "terragoat", "yor_trace": "e5ec3432-e61f-4244-b59e-9ecc24ddd4cb"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/azure-policies/azure-logging-policies/bc-azr-logging-3.html", "details": [], "check_len": null, "definition_context_file_path": "/terraform/terraform/azure/sql.tf", "breadcrumbs": {"name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_sql_server.example", "path": "/terraform/terraform/azure/sql.tf", "module_connection": false}], "tags": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}], "resource_group_name": [{"type": "variable", "name": "environment", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}], "location": [{"type": "variable", "name": "location", "path": "/terraform/terraform/azure/variables.tf", "module_connection": false}, {"type": "resource", "name": "azurerm_resource_group.example", "path": "/terraform/terraform/azure/resource_group.tf", "module_connection": false}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 180, "failed": 446, "skipped": 0, "parsing_errors": 0, "resource_count": 133, "checkov_version": "2.3.321"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}, {"check_type": "dockerfile", "results": {"passed_checks": [{"check_id": "CKV_DOCKER_7", "bc_check_id": "BC_DKR_7", "check_name": "Ensure the base image uses a non latest version tag", "check_result": {"result": "PASSED", "results_configuration": [{"instruction": "FROM", "startline": 0, "endline": 0, "content": "FROM python:3.7-slim\n", "value": "python:3.7-slim"}]}, "code_block": [[1, "FROM python:3.7-slim\n"]], "file_path": "/terraform/aws/resources/Dockerfile", "file_abs_path": "/terraform/terraform/aws/resources/Dockerfile", "repo_file_path": "/terraform/aws/resources/Dockerfile", "file_line_range": [1, 1], "resource": "/terraform/aws/resources/Dockerfile.FROM", "evaluations": null, "check_class": "checkov.dockerfile.checks.ReferenceLatestTag", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-the-base-image-uses-a-non-latest-version-tag.html", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_11", "bc_check_id": "BC_DKR_GENERAL_9", "check_name": "Ensure From Alias are unique for multistage builds.", "check_result": {"result": "PASSED", "results_configuration": null}, "code_block": [[1, "FROM python:3.7-slim\n"]], "file_path": "/terraform/aws/resources/Dockerfile", "file_abs_path": "/terraform/terraform/aws/resources/Dockerfile", "repo_file_path": "/terraform/aws/resources/Dockerfile", "file_line_range": [1, 1], "resource": "/terraform/aws/resources/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.AliasIsUnique", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-docker-from-alias-is-unique-for-multistage-builds.html", "details": [], "check_len": null, "definition_context_file_path": null}], "failed_checks": [{"check_id": "CKV_DOCKER_3", "bc_check_id": "BC_DKR_3", "check_name": "Ensure that a user for the container has been created", "check_result": {"result": "FAILED", "results_configuration": null}, "code_block": [[1, "FROM python:3.7-slim\n"]], "file_path": "/terraform/aws/resources/Dockerfile", "file_abs_path": "/terraform/terraform/aws/resources/Dockerfile", "repo_file_path": "/terraform/aws/resources/Dockerfile", "file_line_range": [1, 1], "resource": "/terraform/aws/resources/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.UserExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-that-a-user-for-the-container-has-been-created.html", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_DOCKER_2", "bc_check_id": "BC_DKR_2", "check_name": "Ensure that HEALTHCHECK instructions have been added to container images", "check_result": {"result": "FAILED", "results_configuration": null}, "code_block": [[1, "FROM python:3.7-slim\n"]], "file_path": "/terraform/aws/resources/Dockerfile", "file_abs_path": "/terraform/terraform/aws/resources/Dockerfile", "repo_file_path": "/terraform/aws/resources/Dockerfile", "file_line_range": [1, 1], "resource": "/terraform/aws/resources/Dockerfile.", "evaluations": null, "check_class": "checkov.dockerfile.checks.HealthcheckExists", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/docker-policies/docker-policy-index/ensure-that-healthcheck-instructions-have-been-added-to-container-images.html", "details": [], "check_len": null, "definition_context_file_path": null}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 2, "failed": 2, "skipped": 0, "parsing_errors": 0, "resource_count": 1, "checkov_version": "2.3.321"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}, {"check_type": "secrets", "results": {"passed_checks": [], "failed_checks": [{"check_id": "CKV_SECRET_2", "bc_check_id": "BC_GIT_2", "check_name": "AWS Access Key", "check_result": {"result": "FAILED"}, "code_block": [[15, "export AWS_ACCESS_KEY_ID=AKIAI***************\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [15, 16], "resource": "fc3f784491eba6121c3bfcc1652a2c57d27b16cb", "evaluations": null, "check_class": "", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-2.html", "details": [], "check_len": null, "definition_context_file_path": null, "validation_status": "Unavailable", "added_commit_hash": "", "removed_commit_hash": "", "added_by": "", "removed_date": "", "added_date": ""}, {"check_id": "CKV_SECRET_6", "bc_check_id": "BC_GIT_6", "check_name": "Base64 High Entropy String", "check_result": {"result": "FAILED"}, "code_block": [[16, "export AWS_SECRET_ACCESS_KEY=wJalrX**********************************\n"]], "file_path": "/terraform/aws/ec2.tf", "file_abs_path": "/terraform/terraform/aws/ec2.tf", "repo_file_path": "/terraform/aws/ec2.tf", "file_line_range": [16, 17], "resource": "c00f1a6e4b20aa64691d50781b810756d6254b8e", "evaluations": null, "check_class": "", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-6.html", "details": [], "check_len": null, "definition_context_file_path": null, "validation_status": "Unavailable", "added_commit_hash": "", "removed_commit_hash": "", "added_by": "", "removed_date": "", "added_date": ""}, {"check_id": "CKV_SECRET_2", "bc_check_id": "BC_GIT_2", "check_name": "AWS Access Key", "check_result": {"result": "FAILED"}, "code_block": [[45, "      access_key = \"AKIAI***************\"\n"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [45, 46], "resource": "25910f981e85ca04baf359199dd0bd4a3ae738b6", "evaluations": null, "check_class": "", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-2.html", "details": [], "check_len": null, "definition_context_file_path": null, "validation_status": "Unavailable", "added_commit_hash": "", "removed_commit_hash": "", "added_by": "", "removed_date": "", "added_date": ""}, {"check_id": "CKV_SECRET_6", "bc_check_id": "BC_GIT_6", "check_name": "Base64 High Entropy String", "check_result": {"result": "FAILED"}, "code_block": [[46, "      secret_key = \"wJalrX**********************************\"\n"]], "file_path": "/terraform/aws/lambda.tf", "file_abs_path": "/terraform/terraform/aws/lambda.tf", "repo_file_path": "/terraform/aws/lambda.tf", "file_line_range": [46, 47], "resource": "d70eab08607a4d05faa2d0d6647206599e9abc65", "evaluations": null, "check_class": "", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-6.html", "details": [], "check_len": null, "definition_context_file_path": null, "validation_status": "Unavailable", "added_commit_hash": "", "removed_commit_hash": "", "added_by": "", "removed_date": "", "added_date": ""}, {"check_id": "CKV_SECRET_2", "bc_check_id": "BC_GIT_2", "check_name": "AWS Access Key", "check_result": {"result": "FAILED"}, "code_block": [[10, "  access_key = \"AKIAI***************\"\n"]], "file_path": "/terraform/aws/providers.tf", "file_abs_path": "/terraform/terraform/aws/providers.tf", "repo_file_path": "/terraform/aws/providers.tf", "file_line_range": [10, 11], "resource": "25910f981e85ca04baf359199dd0bd4a3ae738b6", "evaluations": null, "check_class": "", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-2.html", "details": [], "check_len": null, "definition_context_file_path": null, "validation_status": "Unavailable", "added_commit_hash": "", "removed_commit_hash": "", "added_by": "", "removed_date": "", "added_date": ""}, {"check_id": "CKV_SECRET_6", "bc_check_id": "BC_GIT_6", "check_name": "Base64 High Entropy String", "check_result": {"result": "FAILED"}, "code_block": [[11, "  secret_key = \"wJalrX**********************************\"\n"]], "file_path": "/terraform/aws/providers.tf", "file_abs_path": "/terraform/terraform/aws/providers.tf", "repo_file_path": "/terraform/aws/providers.tf", "file_line_range": [11, 12], "resource": "d70eab08607a4d05faa2d0d6647206599e9abc65", "evaluations": null, "check_class": "", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-6.html", "details": [], "check_len": null, "definition_context_file_path": null, "validation_status": "Unavailable", "added_commit_hash": "", "removed_commit_hash": "", "added_by": "", "removed_date": "", "added_date": ""}, {"check_id": "CKV_SECRET_6", "bc_check_id": "BC_GIT_6", "check_name": "Base64 High Entropy String", "check_result": {"result": "FAILED"}, "code_block": [[15, "  administrator_login_password = \"Aa********\"\n"]], "file_path": "/terraform/azure/sql.tf", "file_abs_path": "/terraform/terraform/azure/sql.tf", "repo_file_path": "/terraform/azure/sql.tf", "file_line_range": [15, 16], "resource": "a57ae0fe47084bc8a05f69f3f8083896f8b437b0", "evaluations": null, "check_class": "", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/secrets-policies/secrets-policy-index/git-secrets-6.html", "details": [], "check_len": null, "definition_context_file_path": null, "validation_status": "Unavailable", "added_commit_hash": "", "removed_commit_hash": "", "added_by": "", "removed_date": "", "added_date": ""}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 0, "failed": 7, "skipped": 0, "parsing_errors": 0, "resource_count": 7, "checkov_version": "2.3.321"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}, {"check_type": "github_actions", "results": {"passed_checks": [{"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": "ubuntu-latest", "name": "checkov-action", "steps": [{"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}, {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}], "__startline__": 6, "__endline__": 17}}, "code_block": [[6, "    runs-on: ubuntu-latest\n"], [7, "    name: checkov-action\n"], [8, "    steps:\n"], [9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [6, 18], "resource": "jobs(checkov-job)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_6", "bc_check_id": "BC_REPO_GITHUB_ACTION_6", "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"checkov-job": {"runs-on": "ubuntu-latest", "name": "checkov-action", "steps": [{"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}, {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}], "__startline__": 6, "__endline__": 17}, "__startline__": 5, "__endline__": 17}}, "code_block": [[5, "  checkov-job:\n"], [6, "    runs-on: ubuntu-latest\n"], [7, "    name: checkov-action\n"], [8, "    steps:\n"], [9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [5, 18], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/found-artifact-build-without-evidence-of-cosign-sbom-attestation-in-pipeline.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": "ubuntu-latest", "name": "checkov-action", "steps": [{"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}, {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}], "__startline__": 6, "__endline__": 17}}, "code_block": [[6, "    runs-on: ubuntu-latest\n"], [7, "    name: checkov-action\n"], [8, "    steps:\n"], [9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [6, 18], "resource": "jobs(checkov-job)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": "ubuntu-latest", "name": "checkov-action", "steps": [{"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}, {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}], "__startline__": 6, "__endline__": 17}}, "code_block": [[6, "    runs-on: ubuntu-latest\n"], [7, "    name: checkov-action\n"], [8, "    steps:\n"], [9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [6, 18], "resource": "jobs(checkov-job)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_5", "bc_check_id": "BC_REPO_GITHUB_ACTION_5", "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"checkov-job": {"runs-on": "ubuntu-latest", "name": "checkov-action", "steps": [{"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}, {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}], "__startline__": 6, "__endline__": 17}, "__startline__": 5, "__endline__": 17}}, "code_block": [[5, "  checkov-job:\n"], [6, "    runs-on: ubuntu-latest\n"], [7, "    name: checkov-action\n"], [8, "    steps:\n"], [9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [5, 18], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/no-evidence-of-signing.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": "ubuntu-latest", "name": "checkov-action", "steps": [{"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}, {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}], "__startline__": 6, "__endline__": 17}}, "code_block": [[6, "    runs-on: ubuntu-latest\n"], [7, "    name: checkov-action\n"], [8, "    steps:\n"], [9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [6, 18], "resource": "jobs(checkov-job)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}}, "code_block": [[9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [9, 13], "resource": "jobs(checkov-job).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}}, "code_block": [[12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [12, 18], "resource": "jobs(checkov-job).steps[2](Run Checkov action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}}, "code_block": [[9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [9, 13], "resource": "jobs(checkov-job).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}}, "code_block": [[12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [12, 18], "resource": "jobs(checkov-job).steps[2](Run Checkov action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}}, "code_block": [[9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [9, 13], "resource": "jobs(checkov-job).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}}, "code_block": [[12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [12, 18], "resource": "jobs(checkov-job).steps[2](Run Checkov action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Checkout repo", "uses": "actions/checkout@v2", "__startline__": 9, "__endline__": 12}}, "code_block": [[9, "      - name: Checkout repo\n"], [10, "        uses: actions/checkout@v2\n"], [11, "\n"], [12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [9, 13], "resource": "jobs(checkov-job).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run Checkov action", "id": "checkov", "uses": "bridgecrewio/checkov-action@master", "with": {"directory": "terraform/", "__startline__": 16, "__endline__": 17}, "__startline__": 12, "__endline__": 17}}, "code_block": [[12, "      - name: Run Checkov action\n"], [13, "        id: checkov\n"], [14, "        uses: bridgecrewio/checkov-action@master\n"], [15, "        with:\n"], [16, "          directory: terraform/\n"]], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [12, 18], "resource": "jobs(checkov-job).steps[2](Run Checkov action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": ["checkov-job"], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": ["self-hosted", "public", "linux", "x64"], "steps": [{"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}, {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}, {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}], "__startline__": 8, "__endline__": 38}}, "code_block": [[8, "    runs-on: [self-hosted, public, linux, x64]\n"], [9, "    steps:\n"], [10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [8, 39], "resource": "jobs(build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_6", "bc_check_id": "BC_REPO_GITHUB_ACTION_6", "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"build": {"runs-on": ["self-hosted", "public", "linux", "x64"], "steps": [{"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}, {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}, {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}], "__startline__": 8, "__endline__": 38}, "__startline__": 7, "__endline__": 38}}, "code_block": [[7, "  build:\n"], [8, "    runs-on: [self-hosted, public, linux, x64]\n"], [9, "    steps:\n"], [10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [7, 39], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/found-artifact-build-without-evidence-of-cosign-sbom-attestation-in-pipeline.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": ["self-hosted", "public", "linux", "x64"], "steps": [{"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}, {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}, {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}], "__startline__": 8, "__endline__": 38}}, "code_block": [[8, "    runs-on: [self-hosted, public, linux, x64]\n"], [9, "    steps:\n"], [10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [8, 39], "resource": "jobs(build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": ["self-hosted", "public", "linux", "x64"], "steps": [{"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}, {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}, {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}], "__startline__": 8, "__endline__": 38}}, "code_block": [[8, "    runs-on: [self-hosted, public, linux, x64]\n"], [9, "    steps:\n"], [10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [8, 39], "resource": "jobs(build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_5", "bc_check_id": "BC_REPO_GITHUB_ACTION_5", "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"build": {"runs-on": ["self-hosted", "public", "linux", "x64"], "steps": [{"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}, {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}, {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}], "__startline__": 8, "__endline__": 38}, "__startline__": 7, "__endline__": 38}}, "code_block": [[7, "  build:\n"], [8, "    runs-on: [self-hosted, public, linux, x64]\n"], [9, "    steps:\n"], [10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [7, 39], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/no-evidence-of-signing.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"runs-on": ["self-hosted", "public", "linux", "x64"], "steps": [{"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}, {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}, {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}, {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}], "__startline__": 8, "__endline__": 38}}, "code_block": [[8, "    runs-on: [self-hosted, public, linux, x64]\n"], [9, "    steps:\n"], [10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [8, 39], "resource": "jobs(build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_7", "bc_check_id": "BC_REPO_GITHUB_ACTION_7", "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "PASSED", "results_configuration": {"push": {"branches": ["master"], "__startline__": 4, "__endline__": 6}, "__startline__": 3, "__endline__": 6}}, "code_block": [[3, "  push:\n"], [4, "    branches:\n"], [5, "      - master\n"], [6, "jobs:\n"], [7, "  build:\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [3, 7], "resource": "on(build)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/github-actions-contain-workflow-dispatch-input-parameters", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": [""], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}}, "code_block": [[10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [10, 15], "resource": "jobs(build).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}}, "code_block": [[14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [14, 17], "resource": "jobs(build).steps[2](Run yor action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}}, "code_block": [[16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [16, 21], "resource": "jobs(build).steps[3](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}}, "code_block": [[20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [20, 39], "resource": "jobs(build).steps[4](Update documentation)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}}, "code_block": [[10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [10, 15], "resource": "jobs(build).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}}, "code_block": [[14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [14, 17], "resource": "jobs(build).steps[2](Run yor action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}}, "code_block": [[16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [16, 21], "resource": "jobs(build).steps[3](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}}, "code_block": [[20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [20, 39], "resource": "jobs(build).steps[4](Update documentation)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}}, "code_block": [[10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [10, 15], "resource": "jobs(build).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}}, "code_block": [[14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [14, 17], "resource": "jobs(build).steps[2](Run yor action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}}, "code_block": [[16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [16, 21], "resource": "jobs(build).steps[3](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}}, "code_block": [[20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [20, 39], "resource": "jobs(build).steps[4](Update documentation)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "name": "Checkout repo", "with": {"fetch-depth": 0, "__startline__": 13, "__endline__": 14}, "__startline__": 10, "__endline__": 14}}, "code_block": [[10, "      - uses: actions/checkout@v2\n"], [11, "        name: Checkout repo\n"], [12, "        with:\n"], [13, "          fetch-depth: 0\n"], [14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [10, 15], "resource": "jobs(build).steps[1](Checkout repo)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Run yor action", "uses": "bridgecrewio/yor-action@main", "__startline__": 14, "__endline__": 16}}, "code_block": [[14, "      - name: Run yor action\n"], [15, "        uses: bridgecrewio/yor-action@main\n"], [16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [14, 17], "resource": "jobs(build).steps[2](Run yor action)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Set up Python ${{ matrix.python-version }}", "uses": "actions/setup-python@v1", "with": {"python-version": 3.7, "__startline__": 19, "__endline__": 20}, "__startline__": 16, "__endline__": 20}}, "code_block": [[16, "      - name: Set up Python ${{ matrix.python-version }}\n"], [17, "        uses: actions/setup-python@v1\n"], [18, "        with:\n"], [19, "          python-version: 3.7\n"], [20, "      - name: Update documentation\n"], [21, "        run: |\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [16, 21], "resource": "jobs(build).steps[3](Set up Python ${{ matrix.python-version }})", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Update documentation", "run": "git config --local user.email \"action@github.com\"\ngit config --local user.name \"GitHub Action\"\ngit fetch --tags\ngit pull\nlatest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\necho \"latest tag: $latest_tag\"\nnew_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\necho \"new tag: $new_tag\"\n\npip install -U checkov\ncat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\ngit add README.md  || echo \"No changes to commit\"\ngit commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\ngit push origin\ngit tag $new_tag\ngit push origin $new_tag\n", "__startline__": 20, "__endline__": 38}}, "code_block": [[20, "      - name: Update documentation\n"], [21, "        run: |\n"], [22, "          git config --local user.email \"action@github.com\"\n"], [23, "          git config --local user.name \"GitHub Action\"\n"], [24, "          git fetch --tags\n"], [25, "          git pull\n"], [26, "          latest_tag=$(git describe --tags `git rev-list --tags --max-count=1`)\n"], [27, "          echo \"latest tag: $latest_tag\"\n"], [28, "          new_tag=$(echo $latest_tag | awk -F. -v a=\"$1\" -v b=\"$2\" -v c=\"$3\" '{printf(\"%d.%d.%d\", $1+a, $2+b , $3+1)}')\n"], [29, "          echo \"new tag: $new_tag\"\n"], [30, "\n"], [31, "          pip install -U checkov\n"], [32, "          cat .github/template.md > README.md && checkov -d terraform -o github_failed_only -s >> README.md\n"], [33, "          git add README.md  || echo \"No changes to commit\"\n"], [34, "          git commit -m \"update resource scan result doc\" README.md || echo \"No changes to commit\"\n"], [35, "          git push origin\n"], [36, "          git tag $new_tag\n"], [37, "          git push origin $new_tag\n"]], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [20, 39], "resource": "jobs(build).steps[4](Update documentation)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": ["build"], "workflow_name": "build"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan", "runs-on": "ubuntu-latest", "steps": [{"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}, {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}], "__startline__": 10, "__endline__": 17}}, "code_block": [[10, "    name: Scan\n"], [11, "    runs-on: ubuntu-latest\n"], [12, "    steps:\n"], [13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [10, 18], "resource": "jobs(semgrep)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_6", "bc_check_id": "BC_REPO_GITHUB_ACTION_6", "check_name": "Found artifact build without evidence of cosign sbom attestation in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"semgrep": {"name": "Scan", "runs-on": "ubuntu-latest", "steps": [{"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}, {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}], "__startline__": 10, "__endline__": 17}, "__startline__": 9, "__endline__": 17}}, "code_block": [[9, "  semgrep:\n"], [10, "    name: Scan\n"], [11, "    runs-on: ubuntu-latest\n"], [12, "    steps:\n"], [13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [9, 18], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignSBOM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/found-artifact-build-without-evidence-of-cosign-sbom-attestation-in-pipeline.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan", "runs-on": "ubuntu-latest", "steps": [{"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}, {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}], "__startline__": 10, "__endline__": 17}}, "code_block": [[10, "    name: Scan\n"], [11, "    runs-on: ubuntu-latest\n"], [12, "    steps:\n"], [13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [10, 18], "resource": "jobs(semgrep)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan", "runs-on": "ubuntu-latest", "steps": [{"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}, {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}], "__startline__": 10, "__endline__": 17}}, "code_block": [[10, "    name: Scan\n"], [11, "    runs-on: ubuntu-latest\n"], [12, "    steps:\n"], [13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [10, 18], "resource": "jobs(semgrep)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_5", "bc_check_id": "BC_REPO_GITHUB_ACTION_5", "check_name": "Found artifact build without evidence of cosign sign execution in pipeline", "check_result": {"result": "PASSED", "results_configuration": {"semgrep": {"name": "Scan", "runs-on": "ubuntu-latest", "steps": [{"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}, {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}], "__startline__": 10, "__endline__": 17}, "__startline__": 9, "__endline__": 17}}, "code_block": [[9, "  semgrep:\n"], [10, "    name: Scan\n"], [11, "    runs-on: ubuntu-latest\n"], [12, "    steps:\n"], [13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [9, 18], "resource": "jobs", "evaluations": null, "check_class": "checkov.github_actions.checks.job.CosignArtifacts", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/no-evidence-of-signing.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"name": "Scan", "runs-on": "ubuntu-latest", "steps": [{"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}, {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}], "__startline__": 10, "__endline__": 17}}, "code_block": [[10, "    name: Scan\n"], [11, "    runs-on: ubuntu-latest\n"], [12, "    steps:\n"], [13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [10, 18], "resource": "jobs(semgrep)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_7", "bc_check_id": "BC_REPO_GITHUB_ACTION_7", "check_name": "The build output cannot be affected by user parameters other than the build entry point and the top-level source location. GitHub Actions workflow_dispatch inputs MUST be empty. ", "check_result": {"result": "PASSED", "results_configuration": {"pull_request": {"__startline__": 2, "__endline__": 2}, "push": {"branches": ["main", "master"], "__startline__": 4, "__endline__": 7}, "__startline__": 2, "__endline__": 7}}, "code_block": [[2, "  pull_request: {}\n"], [3, "  push:\n"], [4, "    branches:\n"], [5, "    - main\n"], [6, "    - master\n"], [7, "name: Semgrep\n"], [8, "jobs:\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [2, 8], "resource": "on(Semgrep)", "evaluations": null, "check_class": "checkov.github_actions.checks.job.EmptyWorkflowDispatch", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/github-actions-contain-workflow-dispatch-input-parameters", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": [""], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}}, "code_block": [[13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [13, 15], "resource": "jobs(semgrep).steps[1]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_1", "bc_check_id": "BC_REPO_GITHUB_ACTION_1", "check_name": "Ensure ACTIONS_ALLOW_UNSECURE_COMMANDS isn't true on environment variables", "check_result": {"result": "PASSED", "results_configuration": {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}}, "code_block": [[14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [14, 18], "resource": "jobs(semgrep).steps[2]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.AllowUnsecureCommandsOnJob", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-actions-allow-unsecure-commands-isnt-true-on-environment-variables", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}}, "code_block": [[13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [13, 15], "resource": "jobs(semgrep).steps[1]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_4", "bc_check_id": "BC_REPO_GITHUB_ACTION_4", "check_name": "Suspicious use of netcat with IP address", "check_result": {"result": "PASSED", "results_configuration": {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}}, "code_block": [[14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [14, 18], "resource": "jobs(semgrep).steps[2]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ReverseShellNetcat", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-netcat-with-ip-address.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}}, "code_block": [[13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [13, 15], "resource": "jobs(semgrep).steps[1]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_3", "bc_check_id": "BC_REPO_GITHUB_ACTION_3", "check_name": "Suspicious use of curl with secrets", "check_result": {"result": "PASSED", "results_configuration": {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}}, "code_block": [[14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [14, 18], "resource": "jobs(semgrep).steps[2]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.SuspectCurlInScript", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/suspicious-use-of-curl-with-secrets.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"uses": "actions/checkout@v2", "__startline__": 13, "__endline__": 14}}, "code_block": [[13, "    - uses: actions/checkout@v2\n"], [14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [13, 15], "resource": "jobs(semgrep).steps[1]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}, {"check_id": "CKV_GHA_2", "bc_check_id": "BC_REPO_GITHUB_ACTION_2", "check_name": "Ensure run commands are not vulnerable to shell injection", "check_result": {"result": "PASSED", "results_configuration": {"uses": "returntocorp/semgrep-action@v1", "with": {"publishToken": "${{ secrets.SEMGREP_APP_TOKEN }}", "__startline__": 16, "__endline__": 17}, "__startline__": 14, "__endline__": 17}}, "code_block": [[14, "    - uses: returntocorp/semgrep-action@v1\n"], [15, "      with:\n"], [16, "        publishToken: ${{ secrets.SEMGREP_APP_TOKEN }}\n"]], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [14, 18], "resource": "jobs(semgrep).steps[2]", "evaluations": null, "check_class": "checkov.github_actions.checks.job.ShellInjection", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.paloaltonetworks.com/content/techdocs/en_US/prisma/prisma-cloud/prisma-cloud-code-security-policy-reference/build-integrity-policies/github-actions-policies/ensure-run-commands-are-not-vulnerable-to-shell-injection.html", "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": ["semgrep"], "workflow_name": "Semgrep"}], "failed_checks": [{"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "FAILED", "evaluated_keys": ["permissions"]}, "code_block": [], "file_path": "/.github/workflows/pull_request.yaml", "file_abs_path": "/terraform/.github/workflows/pull_request.yaml", "repo_file_path": "/.github/workflows/pull_request.yaml", "file_line_range": [0, 1], "resource": "on(build)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request"]], "job": [""], "workflow_name": "build"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "FAILED", "evaluated_keys": ["permissions"]}, "code_block": [], "file_path": "/.github/workflows/build.yaml", "file_abs_path": "/terraform/.github/workflows/build.yaml", "repo_file_path": "/.github/workflows/build.yaml", "file_line_range": [0, 1], "resource": "on(build)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["push"]], "job": [""], "workflow_name": "build"}, {"check_id": "CKV2_GHA_1", "bc_check_id": null, "check_name": "Ensure top-level permissions are not set to write-all", "check_result": {"result": "FAILED", "evaluated_keys": ["permissions"]}, "code_block": [], "file_path": "/.github/workflows/semgrep.yml", "file_abs_path": "/terraform/.github/workflows/semgrep.yml", "repo_file_path": "/.github/workflows/semgrep.yml", "file_line_range": [0, 1], "resource": "on(Semgrep)", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null, "triggers": [["pull_request", "push"]], "job": [""], "workflow_name": "Semgrep"}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 52, "failed": 3, "skipped": 0, "parsing_errors": 0, "resource_count": 0, "checkov_version": "2.3.321"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}, {"check_type": "azure_pipelines", "results": {"passed_checks": [{"check_id": "CKV_AZUREPIPELINES_5", "bc_check_id": "BC_REPO_AZR_PIPELINES_5", "check_name": "Detecting image usages in azure pipelines workflows", "check_result": {"result": "PASSED", "results_configuration": {"template": "templates/checkov.yml", "parameters": {"name": "scan_terraform_checkov", "continueOnError": true, "__startline__": 16, "__endline__": 19}, "__startline__": 14, "__endline__": 19}}, "code_block": [[14, "- template: templates/checkov.yml\n"], [15, "  parameters:\n"], [16, "    name: scan_terraform_checkov\n"], [17, "    continueOnError: true\n"], [18, "\n"], [19, "- template: templates/tfsec.yml\n"], [20, "  parameters:\n"]], "file_path": "/azure-pipelines.yml", "file_abs_path": "/terraform/azure-pipelines.yml", "repo_file_path": "/azure-pipelines.yml", "file_line_range": [14, 20], "resource": "jobs[0]", "evaluations": null, "check_class": "checkov.azure_pipelines.checks.job.DetectImagesUsage", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/image-with-no-violations", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AZUREPIPELINES_5", "bc_check_id": "BC_REPO_AZR_PIPELINES_5", "check_name": "Detecting image usages in azure pipelines workflows", "check_result": {"result": "PASSED", "results_configuration": {"template": "templates/tfsec.yml", "parameters": {"name": "scan_terraform_tfsec", "continueOnError": true, "__startline__": 21, "__endline__": 24}, "__startline__": 19, "__endline__": 24}}, "code_block": [[19, "- template: templates/tfsec.yml\n"], [20, "  parameters:\n"], [21, "    name: scan_terraform_tfsec\n"], [22, "    continueOnError: true\n"], [23, "\n"], [24, "- template: templates/terrascan.yml\n"], [25, "  parameters:\n"]], "file_path": "/azure-pipelines.yml", "file_abs_path": "/terraform/azure-pipelines.yml", "repo_file_path": "/azure-pipelines.yml", "file_line_range": [19, 25], "resource": "jobs[1]", "evaluations": null, "check_class": "checkov.azure_pipelines.checks.job.DetectImagesUsage", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/image-with-no-violations", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AZUREPIPELINES_5", "bc_check_id": "BC_REPO_AZR_PIPELINES_5", "check_name": "Detecting image usages in azure pipelines workflows", "check_result": {"result": "PASSED", "results_configuration": {"template": "templates/terrascan.yml", "parameters": {"name": "scan_terraform_terrascan", "continueOnError": true, "__startline__": 26, "__endline__": 29}, "__startline__": 24, "__endline__": 29}}, "code_block": [[24, "- template: templates/terrascan.yml\n"], [25, "  parameters:\n"], [26, "    name: scan_terraform_terrascan\n"], [27, "    continueOnError: true\n"], [28, "\n"], [29, "- template: templates/semgrep.yml\n"], [30, "  parameters:\n"]], "file_path": "/azure-pipelines.yml", "file_abs_path": "/terraform/azure-pipelines.yml", "repo_file_path": "/azure-pipelines.yml", "file_line_range": [24, 30], "resource": "jobs[2]", "evaluations": null, "check_class": "checkov.azure_pipelines.checks.job.DetectImagesUsage", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/image-with-no-violations", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AZUREPIPELINES_5", "bc_check_id": "BC_REPO_AZR_PIPELINES_5", "check_name": "Detecting image usages in azure pipelines workflows", "check_result": {"result": "PASSED", "results_configuration": {"template": "templates/semgrep.yml", "parameters": {"name": "scan_terraform_semgrep", "continueOnError": true, "__startline__": 31, "__endline__": 32}, "__startline__": 29, "__endline__": 32}}, "code_block": [[29, "- template: templates/semgrep.yml\n"], [30, "  parameters:\n"], [31, "    name: scan_terraform_semgrep\n"], [32, "    continueOnError: true"]], "file_path": "/azure-pipelines.yml", "file_abs_path": "/terraform/azure-pipelines.yml", "repo_file_path": "/azure-pipelines.yml", "file_line_range": [29, 33], "resource": "jobs[3]", "evaluations": null, "check_class": "checkov.azure_pipelines.checks.job.DetectImagesUsage", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/image-with-no-violations", "details": [], "check_len": null, "definition_context_file_path": null}], "failed_checks": [], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 4, "failed": 0, "skipped": 0, "parsing_errors": 0, "resource_count": 0, "checkov_version": "2.3.321"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}]